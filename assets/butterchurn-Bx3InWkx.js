import{g as pt}from"./index-PdD9855N.js";function _t(W,f){for(var u=0;u<f.length;u++){const o=f[u];if(typeof o!="string"&&!Array.isArray(o)){for(const a in o)if(a!=="default"&&!(a in W)){const c=Object.getOwnPropertyDescriptor(o,a);c&&Object.defineProperty(W,a,c.get?c:{enumerable:!0,get:()=>o[a]})}}}return Object.freeze(Object.defineProperty(W,Symbol.toStringTag,{value:"Module"}))}var Et={exports:{}},ft=Et.exports=function(){return function(W){var f={};function u(o){if(f[o])return f[o].exports;var a=f[o]={i:o,l:!1,exports:{}};return W[o].call(a.exports,a,a.exports,u),a.l=!0,a.exports}return u.m=W,u.c=f,u.d=function(o,a,c){u.o(o,a)||Object.defineProperty(o,a,{enumerable:!0,get:c})},u.r=function(o){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(o,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(o,"__esModule",{value:!0})},u.t=function(o,a){if(1&a&&(o=u(o)),8&a||4&a&&typeof o=="object"&&o&&o.__esModule)return o;var c=Object.create(null);if(u.r(c),Object.defineProperty(c,"default",{enumerable:!0,value:o}),2&a&&typeof o!="string")for(var t in o)u.d(c,t,(function(e){return o[e]}).bind(null,t));return c},u.n=function(o){var a=o&&o.__esModule?function(){return o.default}:function(){return o};return u.d(a,"a",a),a},u.o=function(o,a){return Object.prototype.hasOwnProperty.call(o,a)},u.p="",u(u.s="./src/index.js")}({"./node_modules/@assemblyscript/loader/index.js":function(W,f,u){u.r(f),u.d(f,"instantiate",function(){return p}),u.d(f,"instantiateSync",function(){return I}),u.d(f,"instantiateStreaming",function(){return y}),u.d(f,"demangle",function(){return w});const o=-8,a=-4,c=0,t=1,e=1,i=2,s=4,l=6,h=2048,A=4096,r=16384,n=0,d=4,g=8,_=12,m=12,x=16,E=typeof BigUint64Array<"u",P=Symbol(),M=32,X=new TextDecoder("utf-16le");function U(S,R){const D=new Uint32Array(S)[R+a>>>2]>>>1,C=new Uint16Array(S,R,D);return D<=M?String.fromCharCode.apply(String,C):X.decode(C)}function L(S){const R={};function D(O,F){return O?U(O.buffer,F):"<yet unknown>"}const C=S.env=S.env||{};return C.abort=C.abort||function(O,F,G,B){const V=R.memory||C.memory;throw Error(`abort: ${D(V,O)} at ${D(V,F)}:${G}:${B}`)},C.trace=C.trace||function(O,F,...G){const B=R.memory||C.memory;console.log(`trace: ${D(B,O)}${F?" ":""}${G.slice(0,F).join(", ")}`)},C.seed=C.seed||Date.now,S.Math=S.Math||Math,S.Date=S.Date||Date,R}function T(S,R){const D=R.exports,C=D.memory,O=D.table,F=D.__new,G=D.__retain,B=D.__rtti_base||-1;function V(Y){const j=function(K){const H=new Uint32Array(C.buffer);if((K>>>=0)>=H[B>>>2])throw Error(`invalid id: ${K}`);return H[(B+4>>>2)+2*K]}(Y);if(!(j&(e|i|s)))throw Error(`not an array: ${Y}, flags=${j}`);return j}function Q(Y){const j=new Uint32Array(C.buffer);if((Y>>>=0)>=j[B>>>2])throw Error(`invalid id: ${Y}`);return j[(B+4>>>2)+2*Y+1]}function q(Y){return 31-Math.clz32(Y>>>l&31)}function k(Y,j,K){const H=C.buffer;if(K)switch(Y){case 2:return new Float32Array(H);case 3:return new Float64Array(H)}else switch(Y){case 0:return new(j?Int8Array:Uint8Array)(H);case 1:return new(j?Int16Array:Uint16Array)(H);case 2:return new(j?Int32Array:Uint32Array)(H);case 3:return new(j?BigInt64Array:BigUint64Array)(H)}throw Error(`unsupported align: ${Y}`)}function N(Y){const j=new Uint32Array(C.buffer),K=V(j[Y+o>>>2]),H=q(K);let Z=K&s?Y:j[Y+d>>>2];const tt=K&i?j[Y+m>>>2]:j[Z+a>>>2]>>>H;return k(H,K&h,K&A).subarray(Z>>>=H,Z+tt)}function z(Y,j,K){return new Y(J(Y,j,K))}function J(Y,j,K){const H=C.buffer,Z=new Uint32Array(H),tt=Z[K+d>>>2];return new Y(H,tt,Z[tt+a>>>2]>>>j)}function et(Y,j,K){S[`__get${j}`]=z.bind(null,Y,K),S[`__get${j}View`]=J.bind(null,Y,K)}return S.__newString=function(Y){if(Y==null)return 0;const j=Y.length,K=F(j<<1,t),H=new Uint16Array(C.buffer);for(var Z=0,tt=K>>>1;Z<j;++Z)H[tt+Z]=Y.charCodeAt(Z);return K},S.__getString=function(Y){if(!Y)return null;const j=C.buffer;if(new Uint32Array(j)[Y+o>>>2]!==t)throw Error(`not a string: ${Y}`);return U(j,Y)},S.__newArray=function(Y,j){const K=V(Y),H=q(K),Z=j.length,tt=F(Z<<H,K&s?Y:c);let it;if(K&s)it=tt;else{const $=F(K&i?x:_,Y),ht=new Uint32Array(C.buffer);ht[$+n>>>2]=G(tt),ht[$+d>>>2]=tt,ht[$+g>>>2]=Z<<H,K&i&&(ht[$+m>>>2]=Z),it=$}const ot=k(H,K&h,K&A);if(K&r)for(let $=0;$<Z;++$)ot[(tt>>>H)+$]=G(j[$]);else ot.set(j,tt>>>H);return it},S.__getArrayView=N,S.__getArray=function(Y){const j=N(Y),K=j.length,H=new Array(K);for(let Z=0;Z<K;Z++)H[Z]=j[Z];return H},S.__getArrayBuffer=function(Y){const j=C.buffer,K=new Uint32Array(j)[Y+a>>>2];return j.slice(Y,Y+K)},[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array].forEach(Y=>{et(Y,Y.name,31-Math.clz32(Y.BYTES_PER_ELEMENT))}),E&&[BigUint64Array,BigInt64Array].forEach(Y=>{et(Y,Y.name.slice(3),3)}),S.__instanceof=function(Y,j){const K=new Uint32Array(C.buffer);let H=K[Y+o>>>2];if(H<=K[B>>>2])do{if(H==j)return!0;H=Q(H)}while(H);return!1},S.memory=S.memory||C,S.table=S.table||O,w(D,S)}function b(S){return typeof Response<"u"&&S instanceof Response}function v(S){return S instanceof WebAssembly.Module}async function p(S,R={}){if(b(S=await S))return y(S,R);const D=v(S)?S:await WebAssembly.compile(S),C=L(R),O=await WebAssembly.instantiate(D,R);return{module:D,instance:O,exports:T(C,O)}}function I(S,R={}){const D=v(S)?S:new WebAssembly.Module(S),C=L(R),O=new WebAssembly.Instance(D,R);return{module:D,instance:O,exports:T(C,O)}}async function y(S,R={}){if(!WebAssembly.instantiateStreaming)return p(b(S=await S)?S.arrayBuffer():S,R);const D=L(R),C=await WebAssembly.instantiateStreaming(S,R),O=T(D,C.instance);return{...C,exports:O}}function w(S,R={}){const D=S.__argumentsLength?C=>{S.__argumentsLength.value=C}:S.__setArgumentsLength||S.__setargc||(()=>{});for(let C in S){if(!Object.prototype.hasOwnProperty.call(S,C))continue;const O=S[C];let F=C.split("."),G=R;for(;F.length>1;){let Q=F.shift();Object.prototype.hasOwnProperty.call(G,Q)||(G[Q]={}),G=G[Q]}let B=F[0],V=B.indexOf("#");if(V>=0){const Q=B.substring(0,V),q=G[Q];if(q===void 0||!q.prototype){const k=function(...N){return k.wrap(k.prototype.constructor(0,...N))};k.prototype={valueOf(){return this[P]}},k.wrap=function(N){return Object.create(k.prototype,{[P]:{value:N,writable:!1}})},q&&Object.getOwnPropertyNames(q).forEach(N=>Object.defineProperty(k,N,Object.getOwnPropertyDescriptor(q,N))),G[Q]=k}if(B=B.substring(V+1),G=G[Q].prototype,/^(get|set):/.test(B)){if(!Object.prototype.hasOwnProperty.call(G,B=B.substring(4))){let k=S[C.replace("set:","get:")],N=S[C.replace("get:","set:")];Object.defineProperty(G,B,{get(){return k(this[P])},set(z){N(this[P],z)},enumerable:!0})}}else B==="constructor"?(G[B]=(...k)=>(D(k.length),O(...k))).original=O:(G[B]=function(...k){return D(k.length),O(this[P],...k)}).original=O}else/^(get|set):/.test(B)?Object.prototype.hasOwnProperty.call(G,B=B.substring(4))||Object.defineProperty(G,B,{get:S[C.replace("set:","get:")],set:S[C.replace("get:","set:")],enumerable:!0}):typeof O=="function"&&O!==D?(G[B]=(...Q)=>(D(Q.length),O(...Q))).original=O:G[B]=O}return R}f.default={instantiate:p,instantiateSync:I,instantiateStreaming:y,demangle:w}},"./node_modules/@babel/runtime/helpers/defineProperty.js":function(W,f){W.exports=function(u,o,a){return o in u?Object.defineProperty(u,o,{value:a,enumerable:!0,configurable:!0,writable:!0}):u[o]=a,u}},"./node_modules/ecma-proposal-math-extensions/reference-implementation/index.js":function(W,f,u){{const o=(c,t)=>{var e=typeof t=="function",i=typeof t=="function",s=typeof t=="function";Object.defineProperty(Math,c,{configurable:e,enumerable:s,writable:i,value:t})};o("DEG_PER_RAD",Math.PI/180),o("RAD_PER_DEG",180/Math.PI);const a=new Float32Array(1);o("scale",function(c,t,e,i,s){return arguments.length===0||Number.isNaN(c)||Number.isNaN(t)||Number.isNaN(e)||Number.isNaN(i)||Number.isNaN(s)?NaN:c===1/0||c===-1/0?c:(c-t)*(s-i)/(e-t)+i}),o("fscale",function(c,t,e,i,s){return a[0]=Math.scale(c,t,e,i,s),a[0]}),o("clamp",function(c,t,e){return Math.min(e,Math.max(t,c))}),o("radians",function(c){return c*Math.DEG_PER_RAD}),o("degrees",function(c){return c*Math.RAD_PER_DEG})}},"./node_modules/eel-wasm/dist/build/parser.js":function(W,f,u){(function(o,a){var c=function(){var t=function(B,V,Q,q){for(Q=Q||{},q=B.length;q--;Q[B[q]]=V);return Q},e=[1,18],i=[1,7],s=[1,19],l=[1,20],h=[1,14],A=[1,15],r=[1,16],n=[1,33],d=[1,31],g=[1,23],_=[1,22],m=[1,24],x=[1,25],E=[1,26],P=[1,27],M=[1,28],X=[1,29],U=[1,30],L=[5,8,15,18,20,28,29,32,33,34,35,36,37,38],T=[5,15,18],b=[5,12,15,17,18,24,25,28,29,30],v=[1,57],p=[5,8,12,15,17,18,24,25,28,29,30],I=[15,18],y=[5,8,15,18,28,29,38],w=[5,8,15,18,28,29,32,33,38],S=[5,8,15,18,28,29,32,33,34,37,38],R=[5,8,15,18,28,29,32,33,34,35,36,37,38],D=[5,8,15,18],C=[5,8,15,18,20,22,28,29,32,33,34,35,36,37,38],O={trace:function(){},yy:{},symbols_:{error:2,SCRIPT:3,expression:4,EOF:5,expressionsOptionalTrailingSemi:6,separator:7,";":8,expressions:9,EXPRESSION_BLOCK:10,IDENTIFIER:11,IDENTIFIER_TOKEN:12,argument:13,arguments:14,",":15,FUNCTION_CALL:16,"(":17,")":18,LOGICAL_EXPRESSION:19,LOGICAL_OPERATOR_TOKEN:20,ASSIGNMENT:21,ASSIGNMENT_OPERATOR_TOKEN:22,number:23,DIGITS_TOKEN:24,".":25,NUMBER_LITERAL:26,UNARY_EXPRESSION:27,"-":28,"+":29,"!":30,BINARY_EXPRESSION:31,"*":32,"/":33,"%":34,"&":35,"|":36,"^":37,COMPARISON_TOKEN:38,$accept:0,$end:1},terminals_:{2:"error",5:"EOF",8:";",12:"IDENTIFIER_TOKEN",15:",",17:"(",18:")",20:"LOGICAL_OPERATOR_TOKEN",22:"ASSIGNMENT_OPERATOR_TOKEN",24:"DIGITS_TOKEN",25:".",28:"-",29:"+",30:"!",32:"*",33:"/",34:"%",35:"&",36:"|",37:"^",38:"COMPARISON_TOKEN"},productions_:[0,[3,2],[3,2],[3,1],[7,1],[7,2],[9,2],[9,3],[6,1],[6,2],[10,1],[11,1],[13,1],[13,1],[14,1],[14,3],[16,3],[16,4],[19,3],[21,3],[21,3],[23,1],[23,2],[23,3],[23,2],[23,1],[26,1],[27,2],[27,2],[27,2],[31,3],[31,3],[31,3],[31,3],[31,3],[31,3],[31,3],[31,3],[31,3],[4,1],[4,1],[4,3],[4,1],[4,1],[4,1],[4,1],[4,1],[4,3]],performAction:function(B,V,Q,q,k,N,z){var J=N.length-1;switch(k){case 1:return{type:"SCRIPT",body:[N[J-1]],loc:this._$};case 2:return{type:"SCRIPT",body:N[J-1],loc:this._$};case 3:return{type:"SCRIPT",body:[],loc:this._$};case 6:this.$=[N[J-1]];break;case 7:this.$=N[J-2].concat([N[J-1]]);break;case 8:this.$=N[J];break;case 9:this.$=N[J-1].concat([N[J]]);break;case 10:this.$={type:"EXPRESSION_BLOCK",body:N[J],loc:this._$};break;case 11:this.$={type:"IDENTIFIER",value:N[J].toLowerCase(),loc:this._$};break;case 14:this.$=[N[J]];break;case 15:this.$=N[J-2].concat([N[J]]);break;case 16:this.$={type:"CALL_EXPRESSION",callee:N[J-2],arguments:[],loc:this._$};break;case 17:this.$={type:"CALL_EXPRESSION",callee:N[J-3],arguments:N[J-1],loc:this._$};break;case 18:this.$={type:"LOGICAL_EXPRESSION",left:N[J-2],right:N[J],operator:N[J-1],loc:this._$};break;case 19:case 20:this.$={type:"ASSIGNMENT_EXPRESSION",left:N[J-2],operator:N[J-1],right:N[J],loc:this._$};break;case 21:this.$=Number(N[J]);break;case 22:this.$=Number(N[J-1]);break;case 23:this.$=Number(N[J-2]+N[J-1]+N[J]);break;case 24:this.$=+("0"+N[J-1]+N[J]);break;case 25:this.$=0;break;case 26:this.$={type:"NUMBER_LITERAL",value:N[J],loc:this._$};break;case 27:case 28:case 29:this.$={type:"UNARY_EXPRESSION",value:N[J],operator:N[J-1],loc:this._$};break;case 30:case 31:case 32:case 33:case 34:case 35:case 36:case 37:case 38:this.$={type:"BINARY_EXPRESSION",left:N[J-2],right:N[J],operator:N[J-1],loc:this._$};break;case 41:case 47:this.$=N[J-1]}},table:[{3:1,4:2,5:[1,4],6:3,9:13,11:11,12:e,16:10,17:i,19:12,21:9,23:17,24:s,25:l,26:8,27:6,28:h,29:A,30:r,31:5},{1:[3]},{5:[1,21],7:32,8:n,20:d,28:g,29:_,32:m,33:x,34:E,35:P,36:M,37:X,38:U},{5:[1,34]},{1:[2,3]},t(L,[2,39]),t(L,[2,40]),{4:35,6:37,9:13,10:36,11:11,12:e,16:10,17:i,19:12,21:9,23:17,24:s,25:l,26:8,27:6,28:h,29:A,30:r,31:5},t(L,[2,42]),t(L,[2,43]),t(L,[2,44],{22:[1,38]}),t(L,[2,45],{17:[1,40],22:[1,39]}),t(L,[2,46]),t(T,[2,8],{31:5,27:6,26:8,21:9,16:10,11:11,19:12,23:17,4:41,12:e,17:i,24:s,25:l,28:h,29:A,30:r}),{4:42,11:11,12:e,16:10,17:i,19:12,21:9,23:17,24:s,25:l,26:8,27:6,28:h,29:A,30:r,31:5},{4:43,11:11,12:e,16:10,17:i,19:12,21:9,23:17,24:s,25:l,26:8,27:6,28:h,29:A,30:r,31:5},{4:44,11:11,12:e,16:10,17:i,19:12,21:9,23:17,24:s,25:l,26:8,27:6,28:h,29:A,30:r,31:5},t(L,[2,26]),t([5,8,15,17,18,20,22,28,29,32,33,34,35,36,37,38],[2,11]),t(L,[2,21],{25:[1,45]}),t(L,[2,25],{24:[1,46]}),{1:[2,1]},{4:47,11:11,12:e,16:10,17:i,19:12,21:9,23:17,24:s,25:l,26:8,27:6,28:h,29:A,30:r,31:5},{4:48,11:11,12:e,16:10,17:i,19:12,21:9,23:17,24:s,25:l,26:8,27:6,28:h,29:A,30:r,31:5},{4:49,11:11,12:e,16:10,17:i,19:12,21:9,23:17,24:s,25:l,26:8,27:6,28:h,29:A,30:r,31:5},{4:50,11:11,12:e,16:10,17:i,19:12,21:9,23:17,24:s,25:l,26:8,27:6,28:h,29:A,30:r,31:5},{4:51,11:11,12:e,16:10,17:i,19:12,21:9,23:17,24:s,25:l,26:8,27:6,28:h,29:A,30:r,31:5},{4:52,11:11,12:e,16:10,17:i,19:12,21:9,23:17,24:s,25:l,26:8,27:6,28:h,29:A,30:r,31:5},{4:53,11:11,12:e,16:10,17:i,19:12,21:9,23:17,24:s,25:l,26:8,27:6,28:h,29:A,30:r,31:5},{4:54,11:11,12:e,16:10,17:i,19:12,21:9,23:17,24:s,25:l,26:8,27:6,28:h,29:A,30:r,31:5},{4:55,11:11,12:e,16:10,17:i,19:12,21:9,23:17,24:s,25:l,26:8,27:6,28:h,29:A,30:r,31:5},{4:56,11:11,12:e,16:10,17:i,19:12,21:9,23:17,24:s,25:l,26:8,27:6,28:h,29:A,30:r,31:5},t(b,[2,6],{8:v}),t(p,[2,4]),{1:[2,2]},{7:32,8:n,18:[1,58],20:d,28:g,29:_,32:m,33:x,34:E,35:P,36:M,37:X,38:U},{18:[1,59]},t(I,[2,10]),{4:60,11:11,12:e,16:10,17:i,19:12,21:9,23:17,24:s,25:l,26:8,27:6,28:h,29:A,30:r,31:5},{4:61,11:11,12:e,16:10,17:i,19:12,21:9,23:17,24:s,25:l,26:8,27:6,28:h,29:A,30:r,31:5},{4:65,6:37,9:13,10:66,11:11,12:e,13:64,14:63,16:10,17:i,18:[1,62],19:12,21:9,23:17,24:s,25:l,26:8,27:6,28:h,29:A,30:r,31:5},t(T,[2,9],{7:67,8:n,20:d,28:g,29:_,32:m,33:x,34:E,35:P,36:M,37:X,38:U}),t(y,[2,27],{20:d,32:m,33:x,34:E,35:P,36:M,37:X}),t(y,[2,28],{20:d,32:m,33:x,34:E,35:P,36:M,37:X}),t(y,[2,29],{20:d,32:m,33:x,34:E,35:P,36:M,37:X}),t(L,[2,22],{24:[1,68]}),t(L,[2,24]),t(y,[2,30],{20:d,32:m,33:x,34:E,35:P,36:M,37:X}),t(y,[2,31],{20:d,32:m,33:x,34:E,35:P,36:M,37:X}),t(w,[2,32],{20:d,34:E,35:P,36:M,37:X}),t(w,[2,33],{20:d,34:E,35:P,36:M,37:X}),t(S,[2,34],{20:d,35:P,36:M}),t(R,[2,35],{20:d}),t(R,[2,36],{20:d}),t(S,[2,37],{20:d,35:P,36:M}),t(D,[2,38],{20:d,28:g,29:_,32:m,33:x,34:E,35:P,36:M,37:X,38:U}),t(L,[2,18]),t(p,[2,5]),t(L,[2,41]),t(L,[2,47]),t(D,[2,20],{20:d,28:g,29:_,32:m,33:x,34:E,35:P,36:M,37:X,38:U}),t(D,[2,19],{20:d,28:g,29:_,32:m,33:x,34:E,35:P,36:M,37:X,38:U}),t(C,[2,16]),{15:[1,70],18:[1,69]},t(I,[2,14]),t(I,[2,12],{7:32,8:n,20:d,28:g,29:_,32:m,33:x,34:E,35:P,36:M,37:X,38:U}),t(I,[2,13]),t(b,[2,7],{8:v}),t(L,[2,23]),t(C,[2,17]),{4:65,6:37,9:13,10:66,11:11,12:e,13:71,16:10,17:i,19:12,21:9,23:17,24:s,25:l,26:8,27:6,28:h,29:A,30:r,31:5},t(I,[2,15])],defaultActions:{4:[2,3],21:[2,1],34:[2,2]},parseError:function(B,V){if(!V.recoverable){var Q=new Error(B);throw Q.hash=V,Q}this.trace(B)},parse:function(B){var V=this,Q=[0],q=[null],k=[],N=this.table,z="",J=0,et=0,Y=k.slice.call(arguments,1),j=Object.create(this.lexer),K={yy:{}};for(var H in this.yy)Object.prototype.hasOwnProperty.call(this.yy,H)&&(K.yy[H]=this.yy[H]);j.setInput(B,K.yy),K.yy.lexer=j,K.yy.parser=this,j.yylloc===void 0&&(j.yylloc={});var Z=j.yylloc;k.push(Z);var tt=j.options&&j.options.ranges;typeof K.yy.parseError=="function"?this.parseError=K.yy.parseError:this.parseError=Object.getPrototypeOf(this).parseError;for(var it,ot,$,ht,nt,st,ct,lt,rt,at={};;){if(ot=Q[Q.length-1],this.defaultActions[ot]?$=this.defaultActions[ot]:(it==null&&(rt=void 0,typeof(rt=j.lex()||1)!="number"&&(rt=V.symbols_[rt]||rt),it=rt),$=N[ot]&&N[ot][it]),$===void 0||!$.length||!$[0]){var gt="";for(nt in lt=[],N[ot])this.terminals_[nt]&&nt>2&&lt.push("'"+this.terminals_[nt]+"'");gt=j.showPosition?"Parse error on line "+(J+1)+`:
`+j.showPosition()+`
Expecting `+lt.join(", ")+", got '"+(this.terminals_[it]||it)+"'":"Parse error on line "+(J+1)+": Unexpected "+(it==1?"end of input":"'"+(this.terminals_[it]||it)+"'"),this.parseError(gt,{text:j.match,token:this.terminals_[it]||it,line:j.yylineno,loc:Z,expected:lt})}if($[0]instanceof Array&&$.length>1)throw new Error("Parse Error: multiple actions possible at state: "+ot+", token: "+it);switch($[0]){case 1:Q.push(it),q.push(j.yytext),k.push(j.yylloc),Q.push($[1]),it=null,et=j.yyleng,z=j.yytext,J=j.yylineno,Z=j.yylloc;break;case 2:if(st=this.productions_[$[1]][1],at.$=q[q.length-st],at._$={first_line:k[k.length-(st||1)].first_line,last_line:k[k.length-1].last_line,first_column:k[k.length-(st||1)].first_column,last_column:k[k.length-1].last_column},tt&&(at._$.range=[k[k.length-(st||1)].range[0],k[k.length-1].range[1]]),(ht=this.performAction.apply(at,[z,et,J,K.yy,$[1],q,k].concat(Y)))!==void 0)return ht;st&&(Q=Q.slice(0,-1*st*2),q=q.slice(0,-1*st),k=k.slice(0,-1*st)),Q.push(this.productions_[$[1]][0]),q.push(at.$),k.push(at._$),ct=N[Q[Q.length-2]][Q[Q.length-1]],Q.push(ct);break;case 3:return!0}}return!0}},F=function(){return{EOF:1,parseError:function(B,V){if(!this.yy.parser)throw new Error(B);this.yy.parser.parseError(B,V)},setInput:function(B,V){return this.yy=V||this.yy||{},this._input=B,this._more=this._backtrack=this.done=!1,this.yylineno=this.yyleng=0,this.yytext=this.matched=this.match="",this.conditionStack=["INITIAL"],this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0},this.options.ranges&&(this.yylloc.range=[0,0]),this.offset=0,this},input:function(){var B=this._input[0];return this.yytext+=B,this.yyleng++,this.offset++,this.match+=B,this.matched+=B,B.match(/(?:\r\n?|\n).*/g)?(this.yylineno++,this.yylloc.last_line++):this.yylloc.last_column++,this.options.ranges&&this.yylloc.range[1]++,this._input=this._input.slice(1),B},unput:function(B){var V=B.length,Q=B.split(/(?:\r\n?|\n)/g);this._input=B+this._input,this.yytext=this.yytext.substr(0,this.yytext.length-V),this.offset-=V;var q=this.match.split(/(?:\r\n?|\n)/g);this.match=this.match.substr(0,this.match.length-1),this.matched=this.matched.substr(0,this.matched.length-1),Q.length-1&&(this.yylineno-=Q.length-1);var k=this.yylloc.range;return this.yylloc={first_line:this.yylloc.first_line,last_line:this.yylineno+1,first_column:this.yylloc.first_column,last_column:Q?(Q.length===q.length?this.yylloc.first_column:0)+q[q.length-Q.length].length-Q[0].length:this.yylloc.first_column-V},this.options.ranges&&(this.yylloc.range=[k[0],k[0]+this.yyleng-V]),this.yyleng=this.yytext.length,this},more:function(){return this._more=!0,this},reject:function(){return this.options.backtrack_lexer?(this._backtrack=!0,this):this.parseError("Lexical error on line "+(this.yylineno+1)+`. You can only invoke reject() in the lexer when the lexer is of the backtracking persuasion (options.backtrack_lexer = true).
`+this.showPosition(),{text:"",token:null,line:this.yylineno})},less:function(B){this.unput(this.match.slice(B))},pastInput:function(){var B=this.matched.substr(0,this.matched.length-this.match.length);return(B.length>20?"...":"")+B.substr(-20).replace(/\n/g,"")},upcomingInput:function(){var B=this.match;return B.length<20&&(B+=this._input.substr(0,20-B.length)),(B.substr(0,20)+(B.length>20?"...":"")).replace(/\n/g,"")},showPosition:function(){var B=this.pastInput(),V=new Array(B.length+1).join("-");return B+this.upcomingInput()+`
`+V+"^"},test_match:function(B,V){var Q,q,k;if(this.options.backtrack_lexer&&(k={yylineno:this.yylineno,yylloc:{first_line:this.yylloc.first_line,last_line:this.last_line,first_column:this.yylloc.first_column,last_column:this.yylloc.last_column},yytext:this.yytext,match:this.match,matches:this.matches,matched:this.matched,yyleng:this.yyleng,offset:this.offset,_more:this._more,_input:this._input,yy:this.yy,conditionStack:this.conditionStack.slice(0),done:this.done},this.options.ranges&&(k.yylloc.range=this.yylloc.range.slice(0))),(q=B[0].match(/(?:\r\n?|\n).*/g))&&(this.yylineno+=q.length),this.yylloc={first_line:this.yylloc.last_line,last_line:this.yylineno+1,first_column:this.yylloc.last_column,last_column:q?q[q.length-1].length-q[q.length-1].match(/\r?\n?/)[0].length:this.yylloc.last_column+B[0].length},this.yytext+=B[0],this.match+=B[0],this.matches=B,this.yyleng=this.yytext.length,this.options.ranges&&(this.yylloc.range=[this.offset,this.offset+=this.yyleng]),this._more=!1,this._backtrack=!1,this._input=this._input.slice(B[0].length),this.matched+=B[0],Q=this.performAction.call(this,this.yy,this,V,this.conditionStack[this.conditionStack.length-1]),this.done&&this._input&&(this.done=!1),Q)return Q;if(this._backtrack){for(var N in k)this[N]=k[N];return!1}return!1},next:function(){if(this.done)return this.EOF;var B,V,Q,q;this._input||(this.done=!0),this._more||(this.yytext="",this.match="");for(var k=this._currentRules(),N=0;N<k.length;N++)if((Q=this._input.match(this.rules[k[N]]))&&(!V||Q[0].length>V[0].length)){if(V=Q,q=N,this.options.backtrack_lexer){if((B=this.test_match(Q,k[N]))!==!1)return B;if(this._backtrack){V=!1;continue}return!1}if(!this.options.flex)break}return V?(B=this.test_match(V,k[q]))!==!1&&B:this._input===""?this.EOF:this.parseError("Lexical error on line "+(this.yylineno+1)+`. Unrecognized text.
`+this.showPosition(),{text:"",token:null,line:this.yylineno})},lex:function(){var B=this.next();return B||this.lex()},begin:function(B){this.conditionStack.push(B)},popState:function(){return this.conditionStack.length-1>0?this.conditionStack.pop():this.conditionStack[0]},_currentRules:function(){return this.conditionStack.length&&this.conditionStack[this.conditionStack.length-1]?this.conditions[this.conditionStack[this.conditionStack.length-1]].rules:this.conditions.INITIAL.rules},topState:function(B){return(B=this.conditionStack.length-1-Math.abs(B||0))>=0?this.conditionStack[B]:"INITIAL"},pushState:function(B){this.begin(B)},stateStackSize:function(){return this.conditionStack.length},options:{},performAction:function(B,V,Q,q){switch(Q){case 0:break;case 1:return 24;case 2:return 38;case 3:return 22;case 4:return 20;case 5:return 12;case 6:return 5;case 7:return V.yytext[0]}},rules:[/^(?:\s+)/,/^(?:[0-9]+)/,/^(?:(==|!=|<=|>=|<|>))/,/^(?:[+\-*/%]?=)/,/^(?:(\&\&)|\|\|)/,/^(?:[a-zA-Z_][a-zA-Z0-9._]*)/,/^(?:$)/,/^(?:.)/],conditions:{INITIAL:{rules:[0,1,2,3,4,5,6,7],inclusive:!0}}}}();function G(){this.yy={}}return O.lexer=F,G.prototype=O,O.Parser=G,new G}();f.parser=c,f.Parser=c.Parser,f.parse=function(){return c.parse.apply(c,arguments)},f.main=()=>{},u.c[u.s]===o&&f.main(a.argv.slice(1))}).call(this,u("./node_modules/webpack/buildin/module.js")(W),u("./node_modules/process/browser.js"))},"./node_modules/eel-wasm/dist/src/astUtils.js":function(W,f,u){Object.defineProperty(f,"__esModule",{value:!0});const o={ASSIGNMENT_EXPRESSION:[{type:"NODE",key:"right"}],SCRIPT:[{type:"ARRAY",key:"body"}],EXPRESSION_BLOCK:[{type:"ARRAY",key:"body"}],UNARY_EXPRESSION:[{type:"NODE",key:"value"}],NUMBER_LITERAL:[],IDENTIFIER:[],CALL_EXPRESSION:[{type:"ARRAY",key:"arguments"},{type:"NODE",key:"callee"}],BINARY_EXPRESSION:[{type:"NODE",key:"left"},{type:"NODE",key:"right"}],LOGICAL_EXPRESSION:[{type:"NODE",key:"left"},{type:"NODE",key:"right"}]};f.mapAst=function a(c,t){const e=o[c.type];let i=c;if(e==null)throw new Error(`Unknown children definition for ${c.type}`);return e.forEach(s=>{if(s.type==="NODE"){const l=c[s.key],h=a(l,t);h!==l&&(i=Object.assign(Object.assign({},i),{[s.key]:h}))}else if(s.type==="ARRAY"){const l=c[s.key],h=l.map(A=>a(A,t));l.some((A,r)=>A!==h[r])&&(i=Object.assign(Object.assign({},i),{[s.key]:h}))}}),t(i)}},"./node_modules/eel-wasm/dist/src/compiler.js":function(W,f,u){var o=this&&this.__importDefault||function(A){return A&&A.__esModule?A:{default:A}},a=this&&this.__importStar||function(A){if(A&&A.__esModule)return A;var r={};if(A!=null)for(var n in A)Object.hasOwnProperty.call(A,n)&&(r[n]=A[n]);return r.default=A,r};Object.defineProperty(f,"__esModule",{value:!0});const c=u("./node_modules/eel-wasm/dist/src/parser.js"),t=u("./node_modules/eel-wasm/dist/src/emitter.js"),e=u("./node_modules/eel-wasm/dist/src/encoding.js"),i=o(u("./node_modules/eel-wasm/dist/src/shims.js")),s=a(u("./node_modules/eel-wasm/dist/src/utils.js")),l=u("./node_modules/eel-wasm/dist/src/wasmFunctions.js"),h=u("./node_modules/eel-wasm/dist/src/constants.js");f.compileModule=function({pools:A,functions:r,eelVersion:n=2,preParsed:d=!1}){if(Object.keys(A).includes("shims"))throw new Error('You may not name a pool "shims". "shims" is reserved for injected JavaScript functions.');const g=[];Object.entries(A).forEach(([S,R])=>{R.forEach(D=>{g.push([S,D])})});const _=new s.ScopedIdMap;g.forEach(([S,R])=>{_.get(S,R)});const m=Object.entries(i.default).map(([S,R])=>({args:new Array(R.length).fill(null).map(D=>e.VAL_TYPE.f64),returns:[e.VAL_TYPE.f64],name:S})),x=[],E=[];Object.entries(r).forEach(([S,{pool:R,code:D}])=>{if(A[R]==null){const B=Object.keys(A);throw B.length===0?new Error(`The function "${S}" was declared as using a variable pool named "${R}" but no pools were defined.`):new Error(`The function "${S}" was declared as using a variable pool named "${R}" which is not among the variable pools defined. The defined variable pools are: ${s.formatList(B)}.`)}const C=d?D:c.parse(D);if(typeof C=="string")throw new Error("Got passed unparsed code without setting the preParsed flag");if(C.type!=="SCRIPT")throw new Error("Invalid AST");if(C.body.length===0)return;const O=[],F={resolveVar:B=>/^reg\d\d$/.test(B)?_.get(null,B):_.get(R,B),resolveLocal:B=>(O.push(B),O.length-1),resolveFunc:B=>{const V=m.findIndex(q=>q.name===B);if(V!==-1){const q=e.op.call(V);return B==="rand"&&n===1?[...q,e.op.f64_floor]:q}if(l.localFuncMap[B]==null)return null;let Q=x.indexOf(B);return Q===-1&&(x.push(B),Q=x.length-1),e.op.call(Q+m.length)},rawSource:D},G=t.emit(C,F);E.push({binary:G,exportName:S,args:[],returns:[],localVariables:O})});const P=x.map(S=>{const R=l.localFuncMap[S];if(R==null)throw new Error(`Undefined local function "${S}"`);return R}),M=S=>[...S.args,"|",...S.returns].join("-"),X=[],U=new Map;function L(S){const R=M(S),D=U.get(R);if(D==null)throw new Error(`Failed to get a type index for key ${R}`);return D}[...m,...P,...E].forEach(S=>{const R=M(S);U.has(R)||(X.push([e.FUNCTION_TYPE,...e.encodeFlatVector(S.args),...e.encodeFlatVector(S.returns)]),U.set(R,X.length-1))});const T=[...g.map(([S,R])=>[...e.encodeString(S),...e.encodeString(R),e.GLOBAL_TYPE,e.VAL_TYPE.f64,e.MUTABILITY.var]),...m.map((S,R)=>{const D=L(S);return[...e.encodeString("shims"),...e.encodeString(S.name),e.TYPE_IDX,...e.unsignedLEB128(D)]})],b=[...P,...E].map(S=>{const R=L(S);return e.unsignedLEB128(R)}),v=[[1,...e.unsignedLEB128(h.WASM_MEMORY_SIZE),...e.unsignedLEB128(h.WASM_MEMORY_SIZE)]],p=_.size()-g.length,I=s.times(p,()=>[e.VAL_TYPE.f64,e.MUTABILITY.var,...e.op.f64_const(0),e.op.end]),y=[...E].map((S,R)=>{const D=R+m.length+P.length;return[...e.encodeString(S.exportName),e.EXPORT_TYPE.FUNC,...e.unsignedLEB128(D)]}),w=[...P,...E].map(S=>{var R;const D=((R=S.localVariables)!==null&&R!==void 0?R:[]).map(C=>[...e.unsignedLEB128(1),C]);return e.encodeFlatVector([...e.encodeNestedVector(D),...S.binary,e.op.end])});return new Uint8Array([...e.MAGIC,...e.WASM_VERSION,...e.encodeSection(e.SECTION.TYPE,X),...e.encodeSection(e.SECTION.IMPORT,T),...e.encodeSection(e.SECTION.FUNC,b),...e.encodeSection(e.SECTION.MEMORY,v),...e.encodeSection(e.SECTION.GLOBAL,I),...e.encodeSection(e.SECTION.EXPORT,y),...e.encodeSection(e.SECTION.CODE,w)])}},"./node_modules/eel-wasm/dist/src/constants.js":function(W,f,u){Object.defineProperty(f,"__esModule",{value:!0}),f.MAX_LOOP_COUNT=1048576,f.BUFFER_SIZE=8388608,f.WASM_MEMORY_SIZE=Math.ceil(8*f.BUFFER_SIZE*2/65536)},"./node_modules/eel-wasm/dist/src/emitter.js":function(W,f,u){var o=this&&this.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(f,"__esModule",{value:!0});const a=u("./node_modules/eel-wasm/dist/src/encoding.js"),c=o(u("./node_modules/eel-wasm/dist/src/shims.js")),t=u("./node_modules/eel-wasm/dist/src/errorUtils.js"),e=u("./node_modules/eel-wasm/dist/src/wasmFunctions.js"),i=u("./node_modules/eel-wasm/dist/src/utils.js"),s=u("./node_modules/eel-wasm/dist/src/constants.js");function l(r,n){var d,g,_;switch(r.type){case"SCRIPT":{const x=r.body.map((E,P)=>[...l(E,n),a.op.drop]);return i.flatten(x)}case"EXPRESSION_BLOCK":return h(r.body,n);case"BINARY_EXPRESSION":{const x=l(r.left,n),E=l(r.right,n),P={"+":[a.op.f64_add],"-":[a.op.f64_sub],"*":[a.op.f64_mul],"/":n.resolveFunc("div"),"%":n.resolveFunc("mod"),"|":n.resolveFunc("bitwiseOr"),"&":n.resolveFunc("bitwiseAnd"),"^":n.resolveFunc("pow"),"==":[a.op.f64_sub,...a.IS_ZEROISH,a.op.f64_convert_i32_s],"!=":[a.op.f64_sub,...a.IS_NOT_ZEROISH,a.op.f64_convert_i32_s],"<":[a.op.f64_lt,a.op.f64_convert_i32_s],">":[a.op.f64_gt,a.op.f64_convert_i32_s],"<=":[a.op.f64_le,a.op.f64_convert_i32_s],">=":[a.op.f64_ge,a.op.f64_convert_i32_s]}[r.operator];if(P==null)throw t.createCompilerError(`Unknown binary expression operator ${r.operator}`,r.loc,n.rawSource);return[...x,...E,...P]}case"CALL_EXPRESSION":{const x=r.callee.value,E=r.arguments,P=U=>{if(E.length<U)throw t.createUserError(`Too few arguments passed to \`${x}()\`. Expected ${U} but only got ${E.length}.`,r.loc,n.rawSource);if(E.length>U)throw t.createUserError(`Too many arguments passed to \`${x}()\`. Expected ${U} but got ${E.length}.`,E[U].loc,n.rawSource)};switch(x){case"exec2":return P(2),h(r.arguments,n);case"exec3":return P(3),h(r.arguments,n);case"if":P(3);const[U,L,T]=r.arguments;return function(I,y,w,S){return[...l(I,S),...a.IS_NOT_ZEROISH,...a.op.if(a.BLOCK.f64),...l(y,S),a.op.else,...l(w,S),a.op.end]}(U,L,T,n);case"while":return P(1),function(I,y){const w=l(I,y),S=y.resolveLocal(a.VAL_TYPE.i32);return[...a.op.i32_const(0),...a.op.local_set(S),...a.op.loop(a.BLOCK.void),...a.op.local_get(S),...a.op.i32_const(1),a.op.i32_add,...a.op.local_tee(S),...a.op.i32_const(s.MAX_LOOP_COUNT),a.op.i32_lt_u,...w,...a.IS_NOT_ZEROISH,a.op.i32_and,...a.op.br_if(0),a.op.end,...a.op.f64_const(0)]}(r.arguments[0],n);case"loop":return P(2),function(I,y,w){const S=l(y,w),R=w.resolveLocal(a.VAL_TYPE.i32);return[...a.op.block(a.BLOCK.void),...l(I,w),a.op.i32_trunc_f64_s,...a.op.local_tee(R),...a.op.i32_const(0),a.op.i32_le_s,...a.op.br_if(1),...a.op.loop(a.BLOCK.void),...S,a.op.drop,...a.op.local_get(R),...a.op.i32_const(1),a.op.i32_sub,...a.op.local_tee(R),...a.op.i32_const(0),a.op.i32_ne,...a.op.br_if(0),a.op.end,a.op.end,...a.op.f64_const(0)]}(r.arguments[0],r.arguments[1],n);case"megabuf":case"gmegabuf":P(1);const b=n.resolveLocal(a.VAL_TYPE.i32);return[...l(r.arguments[0],n),...(d=n.resolveFunc("_getBufferIndex"))!==null&&d!==void 0?d:[],...a.op.local_tee(b),...a.op.i32_const(-1),a.op.i32_ne,...a.op.if(a.BLOCK.f64),...a.op.local_get(b),...a.op.f64_load(3,A(x)),a.op.else,...a.op.f64_const(0),a.op.end];case"assign":P(2);const v=r.arguments[0];if(v.type!="IDENTIFIER")throw t.createUserError("Expected the first argument of `assign()` to be an identifier.",v.loc,n.rawSource);const p=n.resolveVar(v.value);return[...l(r.arguments[1],n),...a.op.global_set(p),...a.op.global_get(p)]}const M=i.flatten(r.arguments.map(U=>l(U,n)));switch(x){case"abs":return P(1),[...M,a.op.f64_abs];case"sqrt":return P(1),[...M,a.op.f64_abs,a.op.f64_sqrt];case"int":case"floor":return P(1),[...M,a.op.f64_floor];case"min":return P(2),[...M,a.op.f64_min];case"max":return P(2),[...M,a.op.f64_max];case"above":return P(2),[...M,a.op.f64_gt,a.op.f64_convert_i32_s];case"below":return P(2),[...M,a.op.f64_lt,a.op.f64_convert_i32_s];case"equal":return P(2),[...M,a.op.f64_sub,...a.IS_ZEROISH,a.op.f64_convert_i32_s];case"bnot":return P(1),[...M,...a.IS_ZEROISH,a.op.f64_convert_i32_s];case"ceil":return P(1),[...M,a.op.f64_ceil]}const X=n.resolveFunc(x);if(X==null||x.startsWith("_"))throw t.createUserError(`"${x}" is not defined.`,r.callee.loc,n.rawSource);if(c.default[x]!=null)P(c.default[x].length);else{if(e.localFuncMap[x]==null)throw t.createCompilerError(`Missing arity information for the function \`${x}()\``,r.callee.loc,n.rawSource);P(e.localFuncMap[x].args.length)}return[...M,...X]}case"ASSIGNMENT_EXPRESSION":{const{left:x}=r,E=l(r.right,n),P=function(p,I){const y={"+=":[a.op.f64_add],"-=":[a.op.f64_sub],"*=":[a.op.f64_mul],"/=":[a.op.f64_div],"%=":I.resolveFunc("mod"),"=":null},w=y[p.operator];if(w===void 0)throw t.createCompilerError(`Unknown assignment operator "${p.operator}"`,p.loc,I.rawSource);return w}(r,n);if(x.type==="IDENTIFIER"){const p=n.resolveVar(x.value),I=a.op.global_get(p),y=a.op.global_set(p);return P===null?[...E,...y,...I]:[...I,...E,...P,...y,...I]}if(x.type!=="CALL_EXPRESSION")throw t.createCompilerError(`Unexpected left hand side type for assignment: ${x.type}`,r.loc,n.rawSource);const M=n.resolveLocal(a.VAL_TYPE.i32);if(x.arguments.length!==1)throw t.createUserError(`Expected 1 argument when assinging to a buffer but got ${x.arguments.length}.`,x.arguments.length===0?x.loc:x.arguments[1].loc,n.rawSource);const X=x.callee.value;if(X!=="gmegabuf"&&X!=="megabuf")throw t.createUserError("The only function calls which may be assigned to are `gmegabuf()` and `megabuf()`.",x.callee.loc,n.rawSource);const U=A(X);if(P===null){const p=n.resolveLocal(a.VAL_TYPE.i32),I=n.resolveLocal(a.VAL_TYPE.f64);return[...E,...a.op.local_set(I),...l(x.arguments[0],n),...(g=n.resolveFunc("_getBufferIndex"))!==null&&g!==void 0?g:[],...a.op.local_tee(p),...a.op.i32_const(0),a.op.i32_lt_s,...a.op.if(a.BLOCK.f64),...a.op.f64_const(0),a.op.else,...a.op.local_get(p),...a.op.local_tee(M),...a.op.local_get(I),...a.op.f64_store(3,U),...a.op.local_get(I),a.op.end]}const L=n.resolveLocal(a.VAL_TYPE.i32),T=n.resolveLocal(a.VAL_TYPE.i32),b=n.resolveLocal(a.VAL_TYPE.f64),v=n.resolveLocal(a.VAL_TYPE.f64);return[...E,...a.op.local_set(b),...l(x.arguments[0],n),...(_=n.resolveFunc("_getBufferIndex"))!==null&&_!==void 0?_:[],...a.op.local_tee(L),...a.op.i32_const(-1),a.op.i32_ne,...a.op.local_tee(T),...a.op.if(a.BLOCK.f64),...a.op.local_get(L),...a.op.f64_load(3,U),a.op.else,...a.op.f64_const(0),a.op.end,...a.op.local_get(b),...P,...a.op.local_tee(v),...a.op.local_get(T),...a.op.if(a.BLOCK.void),...a.op.local_get(L),...a.op.local_get(v),...a.op.f64_store(3,U),a.op.end]}case"LOGICAL_EXPRESSION":{const x=l(r.left,n),E=l(r.right,n),P={"&&":{comparison:a.IS_ZEROISH,shortCircutValue:0},"||":{comparison:a.IS_NOT_ZEROISH,shortCircutValue:1}}[r.operator];if(P==null)throw t.createCompilerError(`Unknown logical expression operator ${r.operator}`,r.loc,n.rawSource);const{comparison:M,shortCircutValue:X}=P;return[...x,...M,...a.op.if(a.BLOCK.f64),...a.op.f64_const(X),a.op.else,...E,...a.IS_NOT_ZEROISH,a.op.f64_convert_i32_s,a.op.end]}case"UNARY_EXPRESSION":{const x=l(r.value,n),E={"-":[a.op.f64_neg],"+":[],"!":[...a.IS_ZEROISH,a.op.f64_convert_i32_s]}[r.operator];if(E==null)throw t.createCompilerError(`Unknown logical unary operator ${r.operator}`,r.loc,n.rawSource);return[...x,...E]}case"IDENTIFIER":const m=r.value;return a.op.global_get(n.resolveVar(m));case"NUMBER_LITERAL":return a.op.f64_const(r.value);default:throw t.createCompilerError(`Unknown AST node type ${r.type}`,r.loc,n.rawSource)}}function h(r,n){const d=r.map((g,_)=>l(g,n));return i.flatten(i.arrayJoin(d,[a.op.drop]))}function A(r){switch(r){case"gmegabuf":return 8*s.BUFFER_SIZE;case"megabuf":return 0}}f.emit=l},"./node_modules/eel-wasm/dist/src/encoding.js":function(W,f,u){var o=this&&this.__importStar||function(s){if(s&&s.__esModule)return s;var l={};if(s!=null)for(var h in s)Object.hasOwnProperty.call(s,h)&&(l[h]=s[h]);return l.default=s,l};Object.defineProperty(f,"__esModule",{value:!0});const a=o(u("./node_modules/eel-wasm/dist/src/ieee754.js")),c=u("./node_modules/eel-wasm/dist/src/utils.js");function t(s){const l=new Uint8Array(8);return a.write(l,s),l}function e(s){const l=[];do{let h=127&s;(s>>>=7)!=0&&(h|=128),l.push(h)}while(s!==0);return l}function i(s){let l=[],h=0,A=Math.ceil(Math.log2(Math.abs(s))),r=s<0,n=!0;for(;n;)h=127&s,s>>=7,r&&(s|=-(1<<A-7)),(s!=0||64&h)&&(s!=-1||64&~h)?h|=128:n=!1,l.push(h);return l}f.MAGIC=[0,97,115,109],f.WASM_VERSION=[1,0,0,0],f.EPSILON=1e-5,f.SECTION={TYPE:1,IMPORT:2,FUNC:3,MEMORY:5,GLOBAL:6,EXPORT:7,CODE:10},f.EXPORT_TYPE={FUNC:0,TABLE:1,MEMORY:2,GLOBAL:3},f.op={block:s=>[2,s],loop:s=>[3,s],if:s=>[4,s],else:5,end:11,br_if:s=>[13,...e(s)],call:s=>[16,...e(s)],drop:26,select:27,local_get:s=>[32,...e(s)],local_set:s=>[33,...e(s)],local_tee:s=>[34,...e(s)],global_get:s=>[35,...e(s)],global_set:s=>[36,...e(s)],f64_load:(s,l)=>[43,...e(s),...e(l)],f64_store:(s,l)=>[57,...e(s),...e(l)],i32_const:s=>[65,...i(s)],f64_const:s=>[68,...t(s)],i32_eqz:69,i32_ne:71,i32_lt_s:72,i32_lt_u:73,i32_gt_s:74,i32_le_s:76,i32_le_u:77,i32_ge_s:78,f64_eq:97,f64_ne:98,f64_lt:99,f64_gt:100,f64_le:101,f64_ge:102,i32_add:106,i32_sub:107,i32_mul:108,i32_rem_s:111,i32_and:113,i32_or:114,i64_rem_s:129,i64_and:131,i64_or:132,f64_abs:153,f64_neg:154,f64_ceil:155,f64_floor:156,f64_sqrt:159,f64_add:160,f64_sub:161,f64_mul:162,f64_div:163,f64_min:164,f64_max:165,i32_trunc_f64_s:170,i32_trunc_f64_u:171,i64_trunc_s_f64:176,f64_convert_i64_s:185,f64_convert_i32_s:183},f.VAL_TYPE={i32:127,i64:126,f32:125,f64:124},f.MUTABILITY={const:0,var:1},f.BLOCK={void:64,i32:127,i64:126,f32:125,f64:124},f.FUNCTION_TYPE=96,f.MEMORY_IDX=2,f.GLOBAL_TYPE=3,f.TYPE_IDX=0,f.IS_ZEROISH=[f.op.f64_abs,...f.op.f64_const(f.EPSILON),f.op.f64_lt],f.IS_NOT_ZEROISH=[f.op.f64_abs,...f.op.f64_const(f.EPSILON),f.op.f64_gt],f.encodef64=t,f.encodeString=s=>[s.length].concat(s.split("").map(l=>l.charCodeAt(0))),f.unsignedLEB128=e,f.signedLEB128=i,f.encodeFlatVector=s=>e(s.length).concat(s),f.encodeNestedVector=s=>e(s.length).concat(c.flatten(s)),f.encodeSection=function(s,l){if(l.length===0)return[];const h=f.encodeFlatVector(f.encodeNestedVector(l));return h.unshift(s),h}},"./node_modules/eel-wasm/dist/src/envParser.js":function(W,f,u){let o=u("./node_modules/eel-wasm/dist/build/parser.js");W.exports={parse:o.parse}},"./node_modules/eel-wasm/dist/src/errorUtils.js":function(W,f,u){Object.defineProperty(f,"__esModule",{value:!0});const o=u("./node_modules/eel-wasm/dist/src/utils.js");function a(e,i,s=1){const l=Math.max(e.first_line-1-s,0),h=e.last_line+s,A=i.split(`
`).slice(l,h).map((r,n)=>{const d=n+l+1;return`${d>=e.first_line&&d<=e.last_line?">":" "} ${d} | ${r}`});if(e.first_line===e.last_line){const r=o.repeat(e.first_column," "),n=o.repeat(e.last_column-e.first_column,"^"),d=e.first_line-l;A.splice(d,0,`    | ${r}${n}`)}return A.join(`
`)}f.printLoc=a;class c extends Error{constructor(i,s,l){super(i),this.sourceContext=a(s,l),this.loc=s}}class t extends c{}f.createUserError=function(e,i,s){return new t(e,i,s)},f.createCompilerError=function(e,i,s){return new c(e,i,s)}},"./node_modules/eel-wasm/dist/src/ieee754.js":function(W,f,u){Object.defineProperty(f,"__esModule",{value:!0}),f.write=function(o,a){let c=52;var t,e,i,s=64-c-1,l=(1<<s)-1,h=l>>1,A=c===23?Math.pow(2,-24)-Math.pow(2,-77):0,r=0,n=a<0||a===0&&1/a<0?1:0;for(a=Math.abs(a),isNaN(a)||a===1/0?(e=isNaN(a)?1:0,t=l):(t=Math.floor(Math.log(a)/Math.LN2),a*(i=Math.pow(2,-t))<1&&(t--,i*=2),(a+=t+h>=1?A/i:A*Math.pow(2,1-h))*i>=2&&(t++,i/=2),t+h>=l?(e=0,t=l):t+h>=1?(e=(a*i-1)*Math.pow(2,c),t+=h):(e=a*Math.pow(2,h-1)*Math.pow(2,c),t=0));c>=8;o[0+r]=255&e,r+=1,e/=256,c-=8);for(t=t<<c|e,s+=c;s>0;o[0+r]=255&t,r+=1,t/=256,s-=8);o[0+r-1]|=128*n}},"./node_modules/eel-wasm/dist/src/index.js":function(W,f,u){var o=this&&this.__importDefault||function(i){return i&&i.__esModule?i:{default:i}};Object.defineProperty(f,"__esModule",{value:!0});const a=u("./node_modules/eel-wasm/dist/src/parser.js");f.parse=a.parse;const c=u("./node_modules/eel-wasm/dist/src/compiler.js");f.compileModule=c.compileModule;const t=o(u("./node_modules/eel-wasm/dist/src/shims.js"));f.shims=t.default;const e=u("./node_modules/eel-wasm/dist/src/loader.js");f.loadModule=e.loadModule},"./node_modules/eel-wasm/dist/src/loader.js":function(W,f,u){var o=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(f,"__esModule",{value:!0});const a=o(u("./node_modules/eel-wasm/dist/src/shims.js")),c=u("./node_modules/eel-wasm/dist/src/compiler.js");f.loadModule=async function({pools:t,functions:e,eelVersion:i=2}){let s={};Object.entries(t).forEach(([r,n])=>{s[r]=new Set(Object.keys(n))});const l=c.compileModule({pools:s,functions:e,eelVersion:i}),h=await WebAssembly.compile(l);var A=Object.assign(Object.assign({},t),{shims:a.default});return await WebAssembly.instantiate(h,A)}},"./node_modules/eel-wasm/dist/src/parser.js":function(W,f,u){Object.defineProperty(f,"__esModule",{value:!0});const o=u("./node_modules/eel-wasm/dist/src/preProcessor.js"),a=u("./node_modules/eel-wasm/dist/src/envParser.js"),c=u("./node_modules/eel-wasm/dist/src/astUtils.js"),t=u("./node_modules/eel-wasm/dist/src/errorUtils.js");function e(i,s){const l=o.getLoc(s,i.first_column),h=o.getLoc(s,i.last_column);return{first_column:l.column,last_column:h.column,first_line:l.line,last_line:h.line}}f.parse=function(i){const[s,l]=o.preProcess(i);try{const h=a.parse(s);return c.mapAst(h,A=>{if(A.loc.first_line!==1||A.loc.last_line!=1)throw t.createCompilerError("Unexpected multiline",A.loc,i);return Object.assign(Object.assign({},A),{loc:e(A.loc,l)})})}catch(h){throw h.hash==null?h:t.createUserError(`Parse Error: ${h.message.split(`
`)[3]}`,e(h.hash.loc,l),i)}}},"./node_modules/eel-wasm/dist/src/preProcessor.js":function(W,f,u){Object.defineProperty(f,"__esModule",{value:!0}),f.getLoc=function(o,a){let c={destCol:1,srcCol:1,srcLine:1};o.forEach(e=>{e.destCol>a||(c=e)});const t=a-c.destCol;return{column:c.srcCol+t,line:c.srcLine}},f.preProcess=function(o){const a=[];let c=1,t="",e=0,i=!1,s=!1,l=!1;for(let h=0;h<o.length;h++){const A=o[h];if(l){const r=t.length+1,n=h-e+1;a.push({destCol:r,srcCol:n,srcLine:c}),l=!1}A===`
`?(i=!1,c++,e=h+1,l=!0):A==="\r"&&o[h+1]===`
`?(h++,i=!1,c++,e=h+1,l=!0):s&&A==="*"&&o[h+1]==="/"?(s=!1,h++,l=!0):A==="\\"&&o[h+1]==="\\"||A==="/"&&o[h+1]==="/"?(i=!0,h++):A==="/"&&o[h+1]==="*"?(s=!0,h++):i||s||(t+=A)}return[t,a]}},"./node_modules/eel-wasm/dist/src/shims.js":function(W,f,u){Object.defineProperty(f,"__esModule",{value:!0});const o={sin:Math.sin,cos:Math.cos,tan:Math.tan,asin:Math.asin,acos:Math.acos,atan:Math.atan,atan2:Math.atan2,rand:a=>Math.random()*a,pow:Math.pow,log:Math.log,log10:Math.log10,exp:Math.exp,sigmoid:function(a,c){const t=1+Math.exp(-a*c);return Math.abs(t)>1e-5?1/t:0}};f.default=o},"./node_modules/eel-wasm/dist/src/utils.js":function(W,f,u){Object.defineProperty(f,"__esModule",{value:!0}),f.arrayJoin=function(o,a){const c=[];for(let t=0;t<o.length;t++)c.push(o[t]),t===o.length-1||c.push(a);return c},f.flatten=function(o){return[].concat.apply([],o)},f.times=function(o,a){return new Array(o).fill(null).map((c,t)=>a(t))},f.repeat=function(o,a){return new Array(o).fill(a).join("")},f.ScopedIdMap=class{constructor(){this._map=new Map}get(o,a){const c=o==null?a:`${o}::${a}`;return this._map.has(c)||this._map.set(c,this._map.size),this._map.get(c)}size(){return this._map.size}},f.formatList=function(o){if(o.length===0)throw new Error("Cannot format an empty list");if(o.length===1)return o[0];const a=o.map(t=>`"${t}"`),c=a.pop();return a.join(", ")+` and ${c}`}},"./node_modules/eel-wasm/dist/src/wasmFunctions.js":function(W,f,u){Object.defineProperty(f,"__esModule",{value:!0});const o=u("./node_modules/eel-wasm/dist/src/encoding.js"),a=u("./node_modules/eel-wasm/dist/src/constants.js");f.localFuncMap={sqr:{args:[o.VAL_TYPE.f64],returns:[o.VAL_TYPE.f64],binary:[...o.op.local_get(0),...o.op.local_get(0),o.op.f64_mul]},bor:{args:[o.VAL_TYPE.f64,o.VAL_TYPE.f64],returns:[o.VAL_TYPE.f64],binary:[...o.op.local_get(0),...o.IS_NOT_ZEROISH,...o.op.local_get(1),...o.IS_NOT_ZEROISH,o.op.i32_or,...o.op.i32_const(0),o.op.i32_ne,o.op.f64_convert_i32_s]},band:{args:[o.VAL_TYPE.f64,o.VAL_TYPE.f64],returns:[o.VAL_TYPE.f64],binary:[...o.op.local_get(0),...o.IS_NOT_ZEROISH,...o.op.local_get(1),...o.IS_NOT_ZEROISH,o.op.i32_and,...o.op.i32_const(0),o.op.i32_ne,o.op.f64_convert_i32_s]},sign:{args:[o.VAL_TYPE.f64],returns:[o.VAL_TYPE.f64],binary:[...o.op.f64_const(0),...o.op.local_get(0),o.op.f64_lt,...o.op.local_get(0),...o.op.f64_const(0),o.op.f64_lt,o.op.i32_sub,o.op.f64_convert_i32_s]},mod:{args:[o.VAL_TYPE.f64,o.VAL_TYPE.f64],returns:[o.VAL_TYPE.f64],localVariables:[o.VAL_TYPE.i32],binary:[...o.op.local_get(1),o.op.i32_trunc_f64_s,...o.op.local_tee(2),...o.op.i32_const(0),o.op.i32_ne,...o.op.if(o.BLOCK.f64),...o.op.local_get(0),o.op.i32_trunc_f64_s,...o.op.local_get(2),o.op.i32_rem_s,o.op.f64_convert_i32_s,o.op.else,...o.op.f64_const(0),o.op.end]},bitwiseOr:{args:[o.VAL_TYPE.f64,o.VAL_TYPE.f64],returns:[o.VAL_TYPE.f64],binary:[...o.op.local_get(0),o.op.i64_trunc_s_f64,...o.op.local_get(1),o.op.i64_trunc_s_f64,o.op.i64_or,o.op.f64_convert_i64_s]},bitwiseAnd:{args:[o.VAL_TYPE.f64,o.VAL_TYPE.f64],returns:[o.VAL_TYPE.f64],binary:[...o.op.local_get(0),o.op.i64_trunc_s_f64,...o.op.local_get(1),o.op.i64_trunc_s_f64,o.op.i64_and,o.op.f64_convert_i64_s]},div:{args:[o.VAL_TYPE.f64,o.VAL_TYPE.f64],returns:[o.VAL_TYPE.f64],localVariables:[o.VAL_TYPE.i32],binary:[...o.op.local_get(1),...o.op.f64_const(0),o.op.f64_ne,...o.op.if(o.BLOCK.f64),...o.op.local_get(0),...o.op.local_get(1),o.op.f64_div,o.op.else,...o.op.f64_const(0),o.op.end]},_getBufferIndex:{args:[o.VAL_TYPE.f64],returns:[o.VAL_TYPE.i32],localVariables:[o.VAL_TYPE.f64,o.VAL_TYPE.i32],binary:[...o.op.f64_const(o.EPSILON),...o.op.local_get(0),o.op.f64_add,...o.op.local_tee(1),o.op.i32_trunc_f64_s,...o.op.local_set(2),...o.op.i32_const(-1),...o.op.local_get(2),...o.op.i32_const(8),o.op.i32_mul,...o.op.local_get(2),...o.op.i32_const(0),o.op.i32_lt_s,...o.op.local_get(2),...o.op.i32_const(a.BUFFER_SIZE-1),o.op.i32_gt_s,o.op.i32_or,o.op.select]}}},"./node_modules/process/browser.js":function(W,f){var u,o,a=W.exports={};function c(){throw new Error("setTimeout has not been defined")}function t(){throw new Error("clearTimeout has not been defined")}function e(g){if(u===setTimeout)return setTimeout(g,0);if((u===c||!u)&&setTimeout)return u=setTimeout,setTimeout(g,0);try{return u(g,0)}catch{try{return u.call(null,g,0)}catch{return u.call(this,g,0)}}}(function(){try{u=typeof setTimeout=="function"?setTimeout:c}catch{u=c}try{o=typeof clearTimeout=="function"?clearTimeout:t}catch{o=t}})();var i,s=[],l=!1,h=-1;function A(){l&&i&&(l=!1,i.length?s=i.concat(s):h=-1,s.length&&r())}function r(){if(!l){var g=e(A);l=!0;for(var _=s.length;_;){for(i=s,s=[];++h<_;)i&&i[h].run();h=-1,_=s.length}i=null,l=!1,function(m){if(o===clearTimeout)return clearTimeout(m);if((o===t||!o)&&clearTimeout)return o=clearTimeout,clearTimeout(m);try{return o(m)}catch{try{return o.call(null,m)}catch{return o.call(this,m)}}}(g)}}function n(g,_){this.fun=g,this.array=_}function d(){}a.nextTick=function(g){var _=new Array(arguments.length-1);if(arguments.length>1)for(var m=1;m<arguments.length;m++)_[m-1]=arguments[m];s.push(new n(g,_)),s.length!==1||l||e(r)},n.prototype.run=function(){this.fun.apply(null,this.array)},a.title="browser",a.browser=!0,a.env={},a.argv=[],a.version="",a.versions={},a.on=d,a.addListener=d,a.once=d,a.off=d,a.removeListener=d,a.removeAllListeners=d,a.emit=d,a.prependListener=d,a.prependOnceListener=d,a.listeners=function(g){return[]},a.binding=function(g){throw new Error("process.binding is not supported")},a.cwd=function(){return"/"},a.chdir=function(g){throw new Error("process.chdir is not supported")},a.umask=function(){return 0}},"./node_modules/webpack/buildin/module.js":function(W,f){W.exports=function(u){return u.webpackPolyfill||(u.deprecate=function(){},u.paths=[],u.children||(u.children=[]),Object.defineProperty(u,"loaded",{enumerable:!0,get:function(){return u.l}}),Object.defineProperty(u,"id",{enumerable:!0,get:function(){return u.i}}),u.webpackPolyfill=1),u}},"./src/assemblyscript/presetFunctions.ts":function(W,f){W.exports=()=>"AGFzbQEAAAABPQpgAABgAXwBfGACfHwBfGACf38AYAR/f39/AGAJf39/f3x8fHx8AGADf399AGABfwF/YAJ/fwF/YAF+AX8CuBWMAQNlbnYFYWJvcnQABAhwaXhlbEVxcwtwZXJQaXhlbEVxcwAADHBpeGVsVmFyUG9vbAR3YXJwA3wBDHBpeGVsVmFyUG9vbAR6b29tA3wBDHBpeGVsVmFyUG9vbAd6b29tZXhwA3wBDHBpeGVsVmFyUG9vbAJjeAN8AQxwaXhlbFZhclBvb2wCY3kDfAEMcGl4ZWxWYXJQb29sAnN4A3wBDHBpeGVsVmFyUG9vbAJzeQN8AQxwaXhlbFZhclBvb2wCZHgDfAEMcGl4ZWxWYXJQb29sAmR5A3wBDHBpeGVsVmFyUG9vbANyb3QDfAEMcGl4ZWxWYXJQb29sA3JhZAN8AQxwaXhlbFZhclBvb2wDYW5nA3wBDHBpeGVsVmFyUG9vbAF4A3wBDHBpeGVsVmFyUG9vbAF5A3wBCHFWYXJQb29sAnExA3wBCHFWYXJQb29sAnEyA3wBCHFWYXJQb29sAnEzA3wBCHFWYXJQb29sAnE0A3wBCHFWYXJQb29sAnE1A3wBCHFWYXJQb29sAnE2A3wBCHFWYXJQb29sAnE3A3wBCHFWYXJQb29sAnE4A3wBCHFWYXJQb29sAnE5A3wBCHFWYXJQb29sA3ExMAN8AQhxVmFyUG9vbANxMTEDfAEIcVZhclBvb2wDcTEyA3wBCHFWYXJQb29sA3ExMwN8AQhxVmFyUG9vbANxMTQDfAEIcVZhclBvb2wDcTE1A3wBCHFWYXJQb29sA3ExNgN8AQhxVmFyUG9vbANxMTcDfAEIcVZhclBvb2wDcTE4A3wBCHFWYXJQb29sA3ExOQN8AQhxVmFyUG9vbANxMjADfAEIcVZhclBvb2wDcTIxA3wBCHFWYXJQb29sA3EyMgN8AQhxVmFyUG9vbANxMjMDfAEIcVZhclBvb2wDcTI0A3wBCHFWYXJQb29sA3EyNQN8AQhxVmFyUG9vbANxMjYDfAEIcVZhclBvb2wDcTI3A3wBCHFWYXJQb29sA3EyOAN8AQhxVmFyUG9vbANxMjkDfAEIcVZhclBvb2wDcTMwA3wBCHFWYXJQb29sA3EzMQN8AQhxVmFyUG9vbANxMzIDfAEIdFZhclBvb2wCdDEDfAEIdFZhclBvb2wCdDIDfAEIdFZhclBvb2wCdDMDfAEIdFZhclBvb2wCdDQDfAEIdFZhclBvb2wCdDUDfAEIdFZhclBvb2wCdDYDfAEIdFZhclBvb2wCdDcDfAEIdFZhclBvb2wCdDgDfAEKc2hhcGVQb29sMAN4XzADfAEKc2hhcGVQb29sMAN5XzADfAEKc2hhcGVQb29sMAVyYWRfMAN8AQpzaGFwZVBvb2wwBWFuZ18wA3wBCnNoYXBlUG9vbDADcl8wA3wBCnNoYXBlUG9vbDADZ18wA3wBCnNoYXBlUG9vbDADYl8wA3wBCnNoYXBlUG9vbDADYV8wA3wBCnNoYXBlUG9vbDAEcjJfMAN8AQpzaGFwZVBvb2wwBGcyXzADfAEKc2hhcGVQb29sMARiMl8wA3wBCnNoYXBlUG9vbDAEYTJfMAN8AQpzaGFwZVBvb2wwCmJvcmRlcl9yXzADfAEKc2hhcGVQb29sMApib3JkZXJfZ18wA3wBCnNoYXBlUG9vbDAKYm9yZGVyX2JfMAN8AQpzaGFwZVBvb2wwCmJvcmRlcl9hXzADfAEKc2hhcGVQb29sMA50aGlja291dGxpbmVfMAN8AQpzaGFwZVBvb2wwCnRleHR1cmVkXzADfAEKc2hhcGVQb29sMAp0ZXhfem9vbV8wA3wBCnNoYXBlUG9vbDAJdGV4X2FuZ18wA3wBCnNoYXBlUG9vbDAKYWRkaXRpdmVfMAN8AQpzaGFwZVBvb2wxA3hfMQN8AQpzaGFwZVBvb2wxA3lfMQN8AQpzaGFwZVBvb2wxBXJhZF8xA3wBCnNoYXBlUG9vbDEFYW5nXzEDfAEKc2hhcGVQb29sMQNyXzEDfAEKc2hhcGVQb29sMQNnXzEDfAEKc2hhcGVQb29sMQNiXzEDfAEKc2hhcGVQb29sMQNhXzEDfAEKc2hhcGVQb29sMQRyMl8xA3wBCnNoYXBlUG9vbDEEZzJfMQN8AQpzaGFwZVBvb2wxBGIyXzEDfAEKc2hhcGVQb29sMQRhMl8xA3wBCnNoYXBlUG9vbDEKYm9yZGVyX3JfMQN8AQpzaGFwZVBvb2wxCmJvcmRlcl9nXzEDfAEKc2hhcGVQb29sMQpib3JkZXJfYl8xA3wBCnNoYXBlUG9vbDEKYm9yZGVyX2FfMQN8AQpzaGFwZVBvb2wxDnRoaWNrb3V0bGluZV8xA3wBCnNoYXBlUG9vbDEKdGV4dHVyZWRfMQN8AQpzaGFwZVBvb2wxCnRleF96b29tXzEDfAEKc2hhcGVQb29sMQl0ZXhfYW5nXzEDfAEKc2hhcGVQb29sMQphZGRpdGl2ZV8xA3wBCnNoYXBlUG9vbDIDeF8yA3wBCnNoYXBlUG9vbDIDeV8yA3wBCnNoYXBlUG9vbDIFcmFkXzIDfAEKc2hhcGVQb29sMgVhbmdfMgN8AQpzaGFwZVBvb2wyA3JfMgN8AQpzaGFwZVBvb2wyA2dfMgN8AQpzaGFwZVBvb2wyA2JfMgN8AQpzaGFwZVBvb2wyA2FfMgN8AQpzaGFwZVBvb2wyBHIyXzIDfAEKc2hhcGVQb29sMgRnMl8yA3wBCnNoYXBlUG9vbDIEYjJfMgN8AQpzaGFwZVBvb2wyBGEyXzIDfAEKc2hhcGVQb29sMgpib3JkZXJfcl8yA3wBCnNoYXBlUG9vbDIKYm9yZGVyX2dfMgN8AQpzaGFwZVBvb2wyCmJvcmRlcl9iXzIDfAEKc2hhcGVQb29sMgpib3JkZXJfYV8yA3wBCnNoYXBlUG9vbDIOdGhpY2tvdXRsaW5lXzIDfAEKc2hhcGVQb29sMgp0ZXh0dXJlZF8yA3wBCnNoYXBlUG9vbDIKdGV4X3pvb21fMgN8AQpzaGFwZVBvb2wyCXRleF9hbmdfMgN8AQpzaGFwZVBvb2wyCmFkZGl0aXZlXzIDfAEKc2hhcGVQb29sMwN4XzMDfAEKc2hhcGVQb29sMwN5XzMDfAEKc2hhcGVQb29sMwVyYWRfMwN8AQpzaGFwZVBvb2wzBWFuZ18zA3wBCnNoYXBlUG9vbDMDcl8zA3wBCnNoYXBlUG9vbDMDZ18zA3wBCnNoYXBlUG9vbDMDYl8zA3wBCnNoYXBlUG9vbDMDYV8zA3wBCnNoYXBlUG9vbDMEcjJfMwN8AQpzaGFwZVBvb2wzBGcyXzMDfAEKc2hhcGVQb29sMwRiMl8zA3wBCnNoYXBlUG9vbDMEYTJfMwN8AQpzaGFwZVBvb2wzCmJvcmRlcl9yXzMDfAEKc2hhcGVQb29sMwpib3JkZXJfZ18zA3wBCnNoYXBlUG9vbDMKYm9yZGVyX2JfMwN8AQpzaGFwZVBvb2wzCmJvcmRlcl9hXzMDfAEKc2hhcGVQb29sMw50aGlja291dGxpbmVfMwN8AQpzaGFwZVBvb2wzCnRleHR1cmVkXzMDfAEKc2hhcGVQb29sMwp0ZXhfem9vbV8zA3wBCnNoYXBlUG9vbDMJdGV4X2FuZ18zA3wBCnNoYXBlUG9vbDMKYWRkaXRpdmVfMwN8AQMZGAgDBwkBAQICAQYFAAAAAAAAAAAAAAAAAAUDAQABBuwMigF8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt8AUQAAAAAAAAAAAt/AUEAC3wBRAAAAAAAAAAAC3wBRAAAAAAAAAAAC34BQgALB9kB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"},"./src/audio/audioLevels.js":function(W,f,u){u.r(f),u.d(f,"default",function(){return o});class o{constructor(c){let t;this.audio=c,t=this.audio.audioContext?this.audio.audioContext.sampleRate:44100;const e=t/this.audio.fftSize,i=Math.clamp(Math.round(20/e)-1,0,this.audio.numSamps-1),s=Math.clamp(Math.round(320/e)-1,0,this.audio.numSamps-1),l=Math.clamp(Math.round(2800/e)-1,0,this.audio.numSamps-1),h=Math.clamp(Math.round(11025/e)-1,0,this.audio.numSamps-1);this.starts=[i,s,l],this.stops=[s,l,h],this.val=new Float32Array(3),this.imm=new Float32Array(3),this.att=new Float32Array(3),this.avg=new Float32Array(3),this.longAvg=new Float32Array(3),this.att.fill(1),this.avg.fill(1),this.longAvg.fill(1)}get bass(){return this.val[0]}get bass_att(){return this.att[0]}get mid(){return this.val[1]}get mid_att(){return this.att[1]}get treb(){return this.val[2]}get treb_att(){return this.att[2]}static isFiniteNumber(c){return Number.isFinite(c)&&!Number.isNaN(c)}static adjustRateToFPS(c,t,e){return c**(t/e)}updateAudioLevels(c,t){if(this.audio.freqArray.length>0){let e=c;!o.isFiniteNumber(e)||e<15?e=15:e>144&&(e=144),this.imm.fill(0);for(let i=0;i<3;i++)for(let s=this.starts[i];s<this.stops[i];s++)this.imm[i]+=this.audio.freqArray[s];for(let i=0;i<3;i++){let s;s=this.imm[i]>this.avg[i]?.2:.5,s=o.adjustRateToFPS(s,30,e),this.avg[i]=this.avg[i]*s+this.imm[i]*(1-s),s=t<50?.9:.992,s=o.adjustRateToFPS(s,30,e),this.longAvg[i]=this.longAvg[i]*s+this.imm[i]*(1-s),this.longAvg[i]<.001?(this.val[i]=1,this.att[i]=1):(this.val[i]=this.imm[i]/this.longAvg[i],this.att[i]=this.avg[i]/this.longAvg[i])}}}}},"./src/audio/audioProcessor.js":function(W,f,u){u.r(f),u.d(f,"default",function(){return a});var o=u("./src/audio/fft.js");class a{constructor(t){this.numSamps=512,this.fftSize=2*this.numSamps,this.fft=new o.default(this.fftSize,512,!0),t&&(this.audioContext=t,this.audible=t.createDelay(),this.analyser=t.createAnalyser(),this.analyser.smoothingTimeConstant=0,this.analyser.fftSize=this.fftSize,this.audible.connect(this.analyser),this.analyserL=t.createAnalyser(),this.analyserL.smoothingTimeConstant=0,this.analyserL.fftSize=this.fftSize,this.analyserR=t.createAnalyser(),this.analyserR.smoothingTimeConstant=0,this.analyserR.fftSize=this.fftSize,this.splitter=t.createChannelSplitter(2),this.audible.connect(this.splitter),this.splitter.connect(this.analyserL,0),this.splitter.connect(this.analyserR,1)),this.timeByteArray=new Uint8Array(this.fftSize),this.timeByteArrayL=new Uint8Array(this.fftSize),this.timeByteArrayR=new Uint8Array(this.fftSize),this.timeArray=new Int8Array(this.fftSize),this.timeByteArraySignedL=new Int8Array(this.fftSize),this.timeByteArraySignedR=new Int8Array(this.fftSize),this.tempTimeArrayL=new Int8Array(this.fftSize),this.tempTimeArrayR=new Int8Array(this.fftSize),this.timeArrayL=new Int8Array(this.numSamps),this.timeArrayR=new Int8Array(this.numSamps)}sampleAudio(){this.analyser.getByteTimeDomainData(this.timeByteArray),this.analyserL.getByteTimeDomainData(this.timeByteArrayL),this.analyserR.getByteTimeDomainData(this.timeByteArrayR),this.processAudio()}updateAudio(t,e,i){this.timeByteArray.set(t),this.timeByteArrayL.set(e),this.timeByteArrayR.set(i),this.processAudio()}processAudio(){for(let t=0,e=0,i=0;t<this.fftSize;t++)this.timeArray[t]=this.timeByteArray[t]-128,this.timeByteArraySignedL[t]=this.timeByteArrayL[t]-128,this.timeByteArraySignedR[t]=this.timeByteArrayR[t]-128,this.tempTimeArrayL[t]=.5*(this.timeByteArraySignedL[t]+this.timeByteArraySignedL[i]),this.tempTimeArrayR[t]=.5*(this.timeByteArraySignedR[t]+this.timeByteArraySignedR[i]),t%2==0&&(this.timeArrayL[e]=this.tempTimeArrayL[t],this.timeArrayR[e]=this.tempTimeArrayR[t],e+=1),i=t;this.freqArray=this.fft.timeToFrequencyDomain(this.timeArray),this.freqArrayL=this.fft.timeToFrequencyDomain(this.timeByteArraySignedL),this.freqArrayR=this.fft.timeToFrequencyDomain(this.timeByteArraySignedR)}connectAudio(t){t.connect(this.audible)}disconnectAudio(t){t.disconnect(this.audible)}}},"./src/audio/fft.js":function(W,f,u){u.r(f),u.d(f,"default",function(){return o});class o{constructor(c,t,e=!1){this.samplesIn=c,this.samplesOut=t,this.equalize=e,this.NFREQ=2*t,this.equalize&&this.initEqualizeTable(),this.initBitRevTable(),this.initCosSinTable()}initEqualizeTable(){this.equalizeArr=new Float32Array(this.samplesOut);const c=1/this.samplesOut;for(let t=0;t<this.samplesOut;t++)this.equalizeArr[t]=-.02*Math.log((this.samplesOut-t)*c)}initBitRevTable(){this.bitrevtable=new Uint16Array(this.NFREQ);for(let t=0;t<this.NFREQ;t++)this.bitrevtable[t]=t;let c=0;for(let t=0;t<this.NFREQ;t++){if(c>t){const i=this.bitrevtable[t];this.bitrevtable[t]=this.bitrevtable[c],this.bitrevtable[c]=i}let e=this.NFREQ>>1;for(;e>=1&&c>=e;)c-=e,e>>=1;c+=e}}initCosSinTable(){let c=2,t=0;for(;c<=this.NFREQ;)t+=1,c<<=1;this.cossintable=[new Float32Array(t),new Float32Array(t)],c=2;let e=0;for(;c<=this.NFREQ;){const i=-2*Math.PI/c;this.cossintable[0][e]=Math.cos(i),this.cossintable[1][e]=Math.sin(i),e+=1,c<<=1}}timeToFrequencyDomain(c){const t=new Float32Array(this.NFREQ),e=new Float32Array(this.NFREQ);for(let h=0;h<this.NFREQ;h++){const A=this.bitrevtable[h];A<this.samplesIn?t[h]=c[A]:t[h]=0,e[h]=0}let i=2,s=0;for(;i<=this.NFREQ;){const h=this.cossintable[0][s],A=this.cossintable[1][s];let r=1,n=0;const d=i>>1;for(let g=0;g<d;g++){for(let m=g;m<this.NFREQ;m+=i){const x=m+d,E=r*t[x]-n*e[x],P=r*e[x]+n*t[x];t[x]=t[m]-E,e[x]=e[m]-P,t[m]+=E,e[m]+=P}const _=r;r=_*h-n*A,n=n*h+_*A}i<<=1,s+=1}const l=new Float32Array(this.samplesOut);if(this.equalize)for(let h=0;h<this.samplesOut;h++)l[h]=this.equalizeArr[h]*Math.sqrt(t[h]*t[h]+e[h]*e[h]);else for(let h=0;h<this.samplesOut;h++)l[h]=Math.sqrt(t[h]*t[h]+e[h]*e[h]);return l}}},"./src/blankPreset.js":function(W,f,u){var o;(o=(function(){return{baseVals:{gammaadj:1.25,wave_g:.5,mv_x:12,warpscale:1,brighten:0,mv_y:9,wave_scale:1,echo_alpha:0,additivewave:0,sx:1,sy:1,warp:.01,red_blue:0,wave_mode:0,wave_brighten:0,wrap:0,zoomexp:1,fshader:0,wave_r:.5,echo_zoom:1,wave_smoothing:.75,warpanimspeed:1,wave_dots:0,wave_x:.5,wave_y:.5,zoom:1,solarize:0,modwavealphabyvolume:0,dx:0,cx:.5,dy:0,darken_center:0,cy:.5,invert:0,bmotionvectorson:0,rot:0,modwavealphaend:.95,wave_mystery:-.2,decay:.9,wave_a:1,wave_b:.5,rating:5,modwavealphastart:.75,darken:0,echo_orient:0,ib_r:.5,ib_g:.5,ib_b:.5,ib_a:0,ib_size:0,ob_r:.5,ob_g:.5,ob_b:.5,ob_a:0,ob_size:0,mv_dx:0,mv_dy:0,mv_a:0,mv_r:.5,mv_g:.5,mv_b:.5,mv_l:0},init_eqs:function(){return{}},frame_eqs:function(a){return a.rkeys=["warp"],a.zoom=1.01+.02*a.treb_att,a.warp=.15+.25*a.bass_att,a},pixel_eqs:function(a){return a.warp=a.warp+.15*a.rad,a},waves:[{baseVals:{a:1,enabled:0,b:1,g:1,scaling:1,samples:512,additive:0,usedots:0,spectrum:0,r:1,smoothing:.5,thick:0,sep:0},init_eqs:function(a){return a.rkeys=[],a},frame_eqs:function(a){return a},point_eqs:""},{baseVals:{a:1,enabled:0,b:1,g:1,scaling:1,samples:512,additive:0,usedots:0,spectrum:0,r:1,smoothing:.5,thick:0,sep:0},init_eqs:function(a){return a.rkeys=[],a},frame_eqs:function(a){return a},point_eqs:""},{baseVals:{a:1,enabled:0,b:1,g:1,scaling:1,samples:512,additive:0,usedots:0,spectrum:0,r:1,smoothing:.5,thick:0,sep:0},init_eqs:function(a){return a.rkeys=[],a},frame_eqs:function(a){return a},point_eqs:""},{baseVals:{a:1,enabled:0,b:1,g:1,scaling:1,samples:512,additive:0,usedots:0,spectrum:0,r:1,smoothing:.5,thick:0,sep:0},init_eqs:function(a){return a.rkeys=[],a},frame_eqs:function(a){return a},point_eqs:""}],shapes:[{baseVals:{r2:0,a:1,enabled:0,b:0,tex_ang:0,thickoutline:0,g:0,textured:0,g2:1,tex_zoom:1,additive:0,border_a:.1,border_b:1,b2:0,a2:0,r:1,border_g:1,rad:.1,x:.5,y:.5,ang:0,sides:4,border_r:1},init_eqs:function(a){return a.rkeys=[],a},frame_eqs:function(a){return a}},{baseVals:{r2:0,a:1,enabled:0,b:0,tex_ang:0,thickoutline:0,g:0,textured:0,g2:1,tex_zoom:1,additive:0,border_a:.1,border_b:1,b2:0,a2:0,r:1,border_g:1,rad:.1,x:.5,y:.5,ang:0,sides:4,border_r:1},init_eqs:function(a){return a.rkeys=[],a},frame_eqs:function(a){return a}},{baseVals:{r2:0,a:1,enabled:0,b:0,tex_ang:0,thickoutline:0,g:0,textured:0,g2:1,tex_zoom:1,additive:0,border_a:.1,border_b:1,b2:0,a2:0,r:1,border_g:1,rad:.1,x:.5,y:.5,ang:0,sides:4,border_r:1},init_eqs:function(a){return a.rkeys=[],a},frame_eqs:function(a){return a}},{baseVals:{r2:0,a:1,enabled:0,b:0,tex_ang:0,thickoutline:0,g:0,textured:0,g2:1,tex_zoom:1,additive:0,border_a:.1,border_b:1,b2:0,a2:0,r:1,border_g:1,rad:.1,x:.5,y:.5,ang:0,sides:4,border_r:1},init_eqs:function(a){return a.rkeys=[],a},frame_eqs:function(a){return a}}],warp:`shader_body {
ret = texture2D(sampler_main, uv).rgb;
ret -= 0.004;
}
`,comp:`shader_body {
ret = texture2D(sampler_main, uv).rgb;
ret *= hue_shader;
}
`}}).apply(f,[]))===void 0||(W.exports=o)},"./src/equations/presetEquationRunner.js":function(W,f,u){u.r(f),u.d(f,"default",function(){return a});var o=u("./src/utils.js");class a{constructor(t,e,i){this.preset=t,this.texsizeX=i.texsizeX,this.texsizeY=i.texsizeY,this.mesh_width=i.mesh_width,this.mesh_height=i.mesh_height,this.aspectx=i.aspectx,this.aspecty=i.aspecty,this.invAspectx=1/this.aspectx,this.invAspecty=1/this.aspecty,this.qs=o.default.range(1,33).map(s=>`q${s}`),this.ts=o.default.range(1,9).map(s=>`t${s}`),this.regs=o.default.range(100).map(s=>s<10?`reg0${s}`:`reg${s}`),this.initializeEquations(e)}initializeEquations(t){this.runVertEQs=this.preset.pixel_eqs!=="",this.mdVSQInit=null,this.mdVSRegs=null,this.mdVSFrame=null,this.mdVSUserKeys=null,this.mdVSFrameMap=null,this.mdVSShapes=null,this.mdVSUserKeysShapes=null,this.mdVSFrameMapShapes=null,this.mdVSWaves=null,this.mdVSUserKeysWaves=null,this.mdVSFrameMapWaves=null,this.mdVSQAfterFrame=null,this.gmegabuf=new Array(1048576).fill(0);const e={frame:t.frame,time:t.time,fps:t.fps,bass:t.bass,bass_att:t.bass_att,mid:t.mid,mid_att:t.mid_att,treb:t.treb,treb_att:t.treb_att,meshx:this.mesh_width,meshy:this.mesh_height,aspectx:this.invAspectx,aspecty:this.invAspecty,pixelsx:this.texsizeX,pixelsy:this.texsizeY,gmegabuf:this.gmegabuf};this.mdVS=Object.assign({},this.preset.baseVals,e),this.mdVS.megabuf=new Array(1048576).fill(0),this.mdVS.rand_start=new Float32Array([Math.random(),Math.random(),Math.random(),Math.random()]),this.mdVS.rand_preset=new Float32Array([Math.random(),Math.random(),Math.random(),Math.random()]);const i=this.qs.concat(this.regs,Object.keys(this.mdVS)),s=this.preset.init_eqs(o.default.cloneVars(this.mdVS));this.mdVSQInit=o.default.pick(s,this.qs),this.mdVSRegs=o.default.pick(s,this.regs);const l=o.default.pick(s,Object.keys(o.default.omit(s,i)));if(l.megabuf=s.megabuf,l.gmegabuf=s.gmegabuf,this.mdVSFrame=this.preset.frame_eqs(Object.assign({},this.mdVS,this.mdVSQInit,this.mdVSRegs,l)),this.mdVSUserKeys=Object.keys(o.default.omit(this.mdVSFrame,i)),this.mdVSFrameMap=o.default.pick(this.mdVSFrame,this.mdVSUserKeys),this.mdVSQAfterFrame=o.default.pick(this.mdVSFrame,this.qs),this.mdVSRegs=o.default.pick(this.mdVSFrame,this.regs),this.mdVSWaves=[],this.mdVSTWaveInits=[],this.mdVSUserKeysWaves=[],this.mdVSFrameMapWaves=[],this.preset.waves&&this.preset.waves.length>0)for(let h=0;h<this.preset.waves.length;h++){const A=this.preset.waves[h],r=A.baseVals;if(r.enabled!==0){let n=Object.assign({},r,e);const d=this.qs.concat(this.ts,this.regs,Object.keys(n));Object.assign(n,this.mdVSQAfterFrame,this.mdVSRegs),n.megabuf=new Array(1048576).fill(0),A.init_eqs&&(n=A.init_eqs(n),this.mdVSRegs=o.default.pick(n,this.regs),Object.assign(n,r)),this.mdVSWaves.push(n),this.mdVSTWaveInits.push(o.default.pick(n,this.ts)),this.mdVSUserKeysWaves.push(Object.keys(o.default.omit(n,d))),this.mdVSFrameMapWaves.push(o.default.pick(n,this.mdVSUserKeysWaves[h]))}else this.mdVSWaves.push({}),this.mdVSTWaveInits.push({}),this.mdVSUserKeysWaves.push([]),this.mdVSFrameMapWaves.push({})}if(this.mdVSShapes=[],this.mdVSTShapeInits=[],this.mdVSUserKeysShapes=[],this.mdVSFrameMapShapes=[],this.preset.shapes&&this.preset.shapes.length>0)for(let h=0;h<this.preset.shapes.length;h++){const A=this.preset.shapes[h],r=A.baseVals;if(r.enabled!==0){let n=Object.assign({},r,e);const d=this.qs.concat(this.ts,this.regs,Object.keys(n));Object.assign(n,this.mdVSQAfterFrame,this.mdVSRegs),n.megabuf=new Array(1048576).fill(0),A.init_eqs&&(n=A.init_eqs(n),this.mdVSRegs=o.default.pick(n,this.regs),Object.assign(n,r)),this.mdVSShapes.push(n),this.mdVSTShapeInits.push(o.default.pick(n,this.ts)),this.mdVSUserKeysShapes.push(Object.keys(o.default.omit(n,d))),this.mdVSFrameMapShapes.push(o.default.pick(n,this.mdVSUserKeysShapes[h]))}else this.mdVSShapes.push({}),this.mdVSTShapeInits.push({}),this.mdVSUserKeysShapes.push([]),this.mdVSFrameMapShapes.push({})}}updatePreset(t,e){this.preset=t,this.initializeEquations(e)}updateGlobals(t){this.texsizeX=t.texsizeX,this.texsizeY=t.texsizeY,this.mesh_width=t.mesh_width,this.mesh_height=t.mesh_height,this.aspectx=t.aspectx,this.aspecty=t.aspecty,this.invAspectx=1/this.aspectx,this.invAspecty=1/this.aspecty}runFrameEquations(t){return this.mdVSFrame=Object.assign({},this.mdVS,this.mdVSQInit,this.mdVSFrameMap,t),this.mdVSFrame=this.preset.frame_eqs(this.mdVSFrame),this.mdVSFrameMap=o.default.pick(this.mdVSFrame,this.mdVSUserKeys),this.mdVSQAfterFrame=o.default.pick(this.mdVSFrame,this.qs),this.mdVSFrame}runPixelEquations(t){return this.preset.pixel_eqs(t)}runShapeFrameEquations(t,e){return this.preset.shapes[t].frame_eqs(e)}runWaveFrameEquations(t,e){return this.preset.waves[t].frame_eqs(e)}runWavePointEquations(t,e){return this.preset.waves[t].point_eqs(e)}}},"./src/equations/presetEquationRunnerWASM.js":function(W,f,u){u.r(f),u.d(f,"default",function(){return a});var o=u("./src/utils.js");class a{constructor(t,e,i){this.preset=t,this.texsizeX=i.texsizeX,this.texsizeY=i.texsizeY,this.mesh_width=i.mesh_width,this.mesh_height=i.mesh_height,this.aspectx=i.aspectx,this.aspecty=i.aspecty,this.invAspectx=1/this.aspectx,this.invAspecty=1/this.aspecty,this.qs=o.default.range(1,33).map(s=>`q${s}`),this.ts=o.default.range(1,9).map(s=>`t${s}`),this.regs=o.default.range(100).map(s=>s<10?`reg0${s}`:`reg${s}`),this.globalKeys=["frame","time","fps","bass","bass_att","mid","mid_att","treb","treb_att","meshx","meshy","aspectx","aspecty","pixelsx","pixelsy"],this.frameKeys=["decay","wave_a","wave_r","wave_g","wave_b","wave_x","wave_y","wave_scale","wave_smoothing","wave_mode","old_wave_mode","wave_mystery","ob_size","ob_r","ob_g","ob_b","ob_a","ib_size","ib_r","ib_g","ib_b","ib_a","mv_x","mv_y","mv_dx","mv_dy","mv_l","mv_r","mv_g","mv_b","mv_a","echo_zoom","echo_alpha","echo_orient","wave_dots","wave_thick","additivewave","wave_brighten","modwavealphabyvolume","modwavealphastart","modwavealphaend","darken_center","gammaadj","warp","warpanimspeed","warpscale","zoom","zoomexp","rot","cx","cy","dx","dy","sx","sy","fshader","wrap","invert","brighten","darken","solarize","bmotionvectorson","b1n","b2n","b3n","b1x","b2x","b3x","b1ed"],this.waveFrameKeys=["samples","sep","scaling","spectrum","smoothing","r","g","b","a"],this.waveFrameInputKeys=["samples","r","g","b","a"],this.initializeEquations(e)}getQVars(t){return o.default.pickWasm(this.preset.globalPools[t],this.qs)}getTVars(t){return o.default.pickWasm(this.preset.globalPools[t],this.ts)}initializeEquations(t){this.runVertEQs=!!this.preset.pixel_eqs,this.mdVSQInit=null,this.mdVSQAfterFrame=null;const e={frame:t.frame,time:t.time,fps:t.fps,bass:t.bass,bass_att:t.bass_att,mid:t.mid,mid_att:t.mid_att,treb:t.treb,treb_att:t.treb_att,meshx:this.mesh_width,meshy:this.mesh_height,aspectx:this.invAspectx,aspecty:this.invAspecty,pixelsx:this.texsizeX,pixelsy:this.texsizeY};if(this.mdVS=Object.assign({},this.preset.baseVals,e),o.default.setWasm(this.preset.globalPools.perFrame,this.mdVS,Object.keys(this.mdVS)),this.rand_start=new Float32Array([Math.random(),Math.random(),Math.random(),Math.random()]),this.rand_preset=new Float32Array([Math.random(),Math.random(),Math.random(),Math.random()]),this.preset.init_eqs(),this.mdVSQInit=this.getQVars("perFrame"),this.preset.frame_eqs(),this.mdVSQAfterFrame=this.getQVars("perFrame"),this.mdVSTWaveInits=[],this.preset.waves&&this.preset.waves.length>0)for(let i=0;i<this.preset.waves.length;i++){const s=this.preset.waves[i],l=s.baseVals;l.enabled!==0?(o.default.setWasm(this.preset.globalPools[`wavePerFrame${i}`],l,Object.keys(l)),s.init_eqs&&(s.init_eqs(),o.default.setWasm(this.preset.globalPools[`wavePerFrame${i}`],l,Object.keys(l))),this.mdVSTWaveInits.push(this.getTVars(`wavePerFrame${i}`))):this.mdVSTWaveInits.push({})}if(this.mdVSTShapeInits=[],this.preset.shapes&&this.preset.shapes.length>0)for(let i=0;i<this.preset.shapes.length;i++){const s=this.preset.shapes[i],l=s.baseVals;l.enabled!==0?(o.default.setWasm(this.preset.globalPools[`shapePerFrame${i}`],l,Object.keys(l)),s.init_eqs&&(s.init_eqs(),o.default.setWasm(this.preset.globalPools[`shapePerFrame${i}`],l,Object.keys(l))),this.mdVSTShapeInits.push(this.getTVars(`shapePerFrame${i}`))):this.mdVSTShapeInits.push({})}}updatePreset(t,e){this.preset=t,this.initializeEquations(e)}updateGlobals(t){this.texsizeX=t.texsizeX,this.texsizeY=t.texsizeY,this.mesh_width=t.mesh_width,this.mesh_height=t.mesh_height,this.aspectx=t.aspectx,this.aspecty=t.aspecty,this.invAspectx=1/this.aspectx,this.invAspecty=1/this.aspecty}runFrameEquations(t){o.default.setWasm(this.preset.globalPools.perFrame,this.mdVS,this.frameKeys),o.default.setWasm(this.preset.globalPools.perFrame,this.mdVSQInit,this.qs),o.default.setWasm(this.preset.globalPools.perFrame,t,this.globalKeys),this.preset.frame_eqs(),this.preset.save_qs(),this.mdVSQAfterFrame=this.getQVars("perFrame");const e=o.default.pickWasm(this.preset.globalPools.perFrame,[...this.frameKeys,...this.globalKeys]);return e.rand_preset=this.rand_preset,e.rand_start=this.rand_start,e}runWaveFrameEquations(t,e){const i=this.preset.waves[t].baseVals;return o.default.setWasm(this.preset.globalPools[`wavePerFrame${t}`],i,this.waveFrameInputKeys),o.default.setWasm(this.preset.globalPools[`wavePerFrame${t}`],this.mdVSQAfterFrame,this.qs),o.default.setWasm(this.preset.globalPools[`wavePerFrame${t}`],this.mdVSTWaveInits[t],this.ts),o.default.setWasm(this.preset.globalPools[`wavePerFrame${t}`],e,this.globalKeys),this.preset.waves[t].frame_eqs(),o.default.pickWasm(this.preset.globalPools[`wavePerFrame${t}`],this.waveFrameKeys)}}},"./src/image/imageTextures.js":function(W,f,u){u.r(f),u.d(f,"default",function(){return o});class o{constructor(c){this.gl=c,this.anisoExt=this.gl.getExtension("EXT_texture_filter_anisotropic")||this.gl.getExtension("MOZ_EXT_texture_filter_anisotropic")||this.gl.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.samplers={},this.clouds2Image=new Image,this.clouds2Image.onload=()=>{this.samplers.clouds2=this.gl.createTexture(),this.bindTexture(this.samplers.clouds2,this.clouds2Image,128,128)},this.clouds2Image.src="data:image/jpeg;base64,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",this.emptyImage=new Image,this.emptyImage.onload=()=>{this.samplers.empty=this.gl.createTexture(),this.bindTexture(this.samplers.empty,this.emptyImage,1,1)},this.emptyImage.src="data:image/gif;base64,R0lGODlhAQABAIAAAAUEBAAAACwAAAAAAQABAAACAkQBADs="}bindTexture(c,t,e,i){if(this.gl.bindTexture(this.gl.TEXTURE_2D,c),this.gl.pixelStorei(this.gl.UNPACK_ALIGNMENT,1),this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl.RGBA,e,i,0,this.gl.RGBA,this.gl.UNSIGNED_BYTE,t),this.gl.generateMipmap(this.gl.TEXTURE_2D),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_S,this.gl.REPEAT),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_T,this.gl.REPEAT),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MIN_FILTER,this.gl.LINEAR_MIPMAP_LINEAR),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MAG_FILTER,this.gl.LINEAR),this.anisoExt){const s=this.gl.getParameter(this.anisoExt.MAX_TEXTURE_MAX_ANISOTROPY_EXT);this.gl.texParameterf(this.gl.TEXTURE_2D,this.anisoExt.TEXTURE_MAX_ANISOTROPY_EXT,s)}}loadExtraImages(c){Object.keys(c).forEach(t=>{const{data:e,width:i,height:s}=c[t];if(!this.samplers[t]){const l=new Image;l.onload=()=>{this.samplers[t]=this.gl.createTexture(),this.bindTexture(this.samplers[t],l,i,s)},l.src=e}})}getTexture(c){return this.samplers[c]||this.samplers.clouds2}}},"./src/index.js":function(W,f,u){u.r(f),u.d(f,"default",function(){return a}),u("./node_modules/ecma-proposal-math-extensions/reference-implementation/index.js"),u("./src/presetBase.js");var o=u("./src/visualizer.js");class a{static createVisualizer(t,e,i){return new o.default(t,e,i)}}},"./src/noise/noise.js":function(W,f,u){u.r(f),u.d(f,"default",function(){return o});class o{constructor(c){this.gl=c,this.anisoExt=this.gl.getExtension("EXT_texture_filter_anisotropic")||this.gl.getExtension("MOZ_EXT_texture_filter_anisotropic")||this.gl.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.noiseTexLQ=this.gl.createTexture(),this.noiseTexLQLite=this.gl.createTexture(),this.noiseTexMQ=this.gl.createTexture(),this.noiseTexHQ=this.gl.createTexture(),this.noiseTexVolLQ=this.gl.createTexture(),this.noiseTexVolHQ=this.gl.createTexture(),this.nTexArrLQ=o.createNoiseTex(256,1),this.nTexArrLQLite=o.createNoiseTex(32,1),this.nTexArrMQ=o.createNoiseTex(256,4),this.nTexArrHQ=o.createNoiseTex(256,8),this.nTexArrVolLQ=o.createNoiseVolTex(32,1),this.nTexArrVolHQ=o.createNoiseVolTex(32,4),this.bindTexture(this.noiseTexLQ,this.nTexArrLQ,256,256),this.bindTexture(this.noiseTexLQLite,this.nTexArrLQLite,32,32),this.bindTexture(this.noiseTexMQ,this.nTexArrMQ,256,256),this.bindTexture(this.noiseTexHQ,this.nTexArrHQ,256,256),this.bindTexture3D(this.noiseTexVolLQ,this.nTexArrVolLQ,32,32,32),this.bindTexture3D(this.noiseTexVolHQ,this.nTexArrVolHQ,32,32,32),this.noiseTexPointLQ=this.gl.createSampler(),c.samplerParameteri(this.noiseTexPointLQ,c.TEXTURE_MIN_FILTER,c.NEAREST_MIPMAP_NEAREST),c.samplerParameteri(this.noiseTexPointLQ,c.TEXTURE_MAG_FILTER,c.NEAREST),c.samplerParameteri(this.noiseTexPointLQ,c.TEXTURE_WRAP_S,c.REPEAT),c.samplerParameteri(this.noiseTexPointLQ,c.TEXTURE_WRAP_T,c.REPEAT)}bindTexture(c,t,e,i){if(this.gl.bindTexture(this.gl.TEXTURE_2D,c),this.gl.pixelStorei(this.gl.UNPACK_ALIGNMENT,1),this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl.RGBA,e,i,0,this.gl.RGBA,this.gl.UNSIGNED_BYTE,t),this.gl.generateMipmap(this.gl.TEXTURE_2D),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_S,this.gl.REPEAT),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_T,this.gl.REPEAT),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MIN_FILTER,this.gl.LINEAR_MIPMAP_LINEAR),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MAG_FILTER,this.gl.LINEAR),this.anisoExt){const s=this.gl.getParameter(this.anisoExt.MAX_TEXTURE_MAX_ANISOTROPY_EXT);this.gl.texParameterf(this.gl.TEXTURE_2D,this.anisoExt.TEXTURE_MAX_ANISOTROPY_EXT,s)}}bindTexture3D(c,t,e,i,s){if(this.gl.bindTexture(this.gl.TEXTURE_3D,c),this.gl.pixelStorei(this.gl.UNPACK_ALIGNMENT,1),this.gl.texImage3D(this.gl.TEXTURE_3D,0,this.gl.RGBA,e,i,s,0,this.gl.RGBA,this.gl.UNSIGNED_BYTE,t),this.gl.generateMipmap(this.gl.TEXTURE_3D),this.gl.texParameteri(this.gl.TEXTURE_3D,this.gl.TEXTURE_WRAP_S,this.gl.REPEAT),this.gl.texParameteri(this.gl.TEXTURE_3D,this.gl.TEXTURE_WRAP_T,this.gl.REPEAT),this.gl.texParameteri(this.gl.TEXTURE_3D,this.gl.TEXTURE_WRAP_R,this.gl.REPEAT),this.gl.texParameteri(this.gl.TEXTURE_3D,this.gl.TEXTURE_MIN_FILTER,this.gl.LINEAR_MIPMAP_LINEAR),this.gl.texParameteri(this.gl.TEXTURE_3D,this.gl.TEXTURE_MAG_FILTER,this.gl.LINEAR),this.anisoExt){const l=this.gl.getParameter(this.anisoExt.MAX_TEXTURE_MAX_ANISOTROPY_EXT);this.gl.texParameterf(this.gl.TEXTURE_3D,this.anisoExt.TEXTURE_MAX_ANISOTROPY_EXT,l)}}static fCubicInterpolate(c,t,e,i,s){const l=s*s,h=i-e-c+t;return h*(s*l)+(c-t-h)*l+(e-c)*s+t}static dwCubicInterpolate(c,t,e,i,s){const l=[];for(let h=0;h<4;h++){let A=o.fCubicInterpolate(c[h]/255,t[h]/255,e[h]/255,i[h]/255,s);A=Math.clamp(A,0,1),l[h]=255*A}return l}static createNoiseVolTex(c,t){const e=c*c*c,i=new Uint8Array(4*e),s=t>1?216:256,l=.5*s;for(let r=0;r<e;r++)i[4*r+0]=Math.floor(Math.random()*s+l),i[4*r+1]=Math.floor(Math.random()*s+l),i[4*r+2]=Math.floor(Math.random()*s+l),i[4*r+3]=Math.floor(Math.random()*s+l);const h=c*c,A=c;if(t>1){for(let r=0;r<c;r+=t)for(let n=0;n<c;n+=t)for(let d=0;d<c;d++)if(d%t!=0){const g=Math.floor(d/t)*t+c,_=r*h+n*A,m=[],x=[],E=[],P=[];for(let U=0;U<4;U++)m[U]=i[4*_+(g-t)%c*4+U],x[U]=i[4*_+g%c*4+U],E[U]=i[4*_+(g+t)%c*4+U],P[U]=i[4*_+(g+2*t)%c*4+U];const M=d%t/t,X=o.dwCubicInterpolate(m,x,E,P,M);for(let U=0;U<4;U++)i[r*h*4+n*A*4+(4*d+U)]=X[U]}for(let r=0;r<c;r+=t)for(let n=0;n<c;n++)for(let d=0;d<c;d++)if(d%t!=0){const g=Math.floor(d/t)*t+c,_=r*h,m=[],x=[],E=[],P=[];for(let U=0;U<4;U++){const L=4*n+4*_+U;m[U]=i[(g-t)%c*A*4+L],x[U]=i[g%c*A*4+L],E[U]=i[(g+t)%c*A*4+L],P[U]=i[(g+2*t)%c*A*4+L]}const M=d%t/t,X=o.dwCubicInterpolate(m,x,E,P,M);for(let U=0;U<4;U++)i[d*A*4+(4*n+4*_+U)]=X[U]}for(let r=0;r<c;r++)for(let n=0;n<c;n++)for(let d=0;d<c;d++)if(d%t!=0){const g=n*A,_=Math.floor(d/t)*t+c,m=[],x=[],E=[],P=[];for(let U=0;U<4;U++){const L=4*r+4*g+U;m[U]=i[(_-t)%c*h*4+L],x[U]=i[_%c*h*4+L],E[U]=i[(_+t)%c*h*4+L],P[U]=i[(_+2*t)%c*h*4+L]}const M=n%t/t,X=o.dwCubicInterpolate(m,x,E,P,M);for(let U=0;U<4;U++)i[d*h*4+(4*r+4*g+U)]=X[U]}}return i}static createNoiseTex(c,t){const e=c*c,i=new Uint8Array(4*e),s=t>1?216:256,l=.5*s;for(let h=0;h<e;h++)i[4*h+0]=Math.floor(Math.random()*s+l),i[4*h+1]=Math.floor(Math.random()*s+l),i[4*h+2]=Math.floor(Math.random()*s+l),i[4*h+3]=Math.floor(Math.random()*s+l);if(t>1){for(let h=0;h<c;h+=t)for(let A=0;A<c;A++)if(A%t!=0){const r=Math.floor(A/t)*t+c,n=h*c,d=[],g=[],_=[],m=[];for(let P=0;P<4;P++)d[P]=i[4*n+(r-t)%c*4+P],g[P]=i[4*n+r%c*4+P],_[P]=i[4*n+(r+t)%c*4+P],m[P]=i[4*n+(r+2*t)%c*4+P];const x=A%t/t,E=o.dwCubicInterpolate(d,g,_,m,x);for(let P=0;P<4;P++)i[h*c*4+4*A+P]=E[P]}for(let h=0;h<c;h++)for(let A=0;A<c;A++)if(A%t!=0){const r=Math.floor(A/t)*t+c,n=[],d=[],g=[],_=[];for(let E=0;E<4;E++)n[E]=i[(r-t)%c*c*4+4*h+E],d[E]=i[r%c*c*4+4*h+E],g[E]=i[(r+t)%c*c*4+4*h+E],_[E]=i[(r+2*t)%c*c*4+4*h+E];const m=A%t/t,x=o.dwCubicInterpolate(n,d,g,_,m);for(let E=0;E<4;E++)i[A*c*4+4*h+E]=x[E]}}return i}}},"./src/presetBase.js":function(W,f){var u=1e-5;window.sqr=function(o){return o*o},window.sqrt=function(o){return Math.sqrt(Math.abs(o))},window.log10=function(o){return Math.log(o)*Math.LOG10E},window.sign=function(o){return o>0?1:o<0?-1:0},window.rand=function(o){var a=Math.floor(o);return a<1?Math.random():Math.random()*a},window.randint=function(o){return Math.floor(rand(o))},window.bnot=function(o){return Math.abs(o)<u?1:0},window.pow=function(o,a){var c,t=Math.pow(o,a);return c=t,!isFinite(c)||isNaN(c)?0:t},window.div=function(o,a){return a===0?0:o/a},window.mod=function(o,a){return a===0?0:Math.floor(o)%Math.floor(a)},window.bitor=function(o,a){return Math.floor(o)|Math.floor(a)},window.bitand=function(o,a){return Math.floor(o)&Math.floor(a)},window.sigmoid=function(o,a){var c=1+Math.exp(-o*a);return Math.abs(c)>u?1/c:0},window.bor=function(o,a){return Math.abs(o)>u||Math.abs(a)>u?1:0},window.band=function(o,a){return Math.abs(o)>u&&Math.abs(a)>u?1:0},window.equal=function(o,a){return Math.abs(o-a)<u?1:0},window.above=function(o,a){return o>a?1:0},window.below=function(o,a){return o<a?1:0},window.ifcond=function(o,a,c){return Math.abs(o)>u?a:c},window.memcpy=function(o,a,c,t){let e=a,i=c,s=t;return i<0&&(s+=i,e-=i,i=0),e<0&&(s+=e,i-=e,e=0),s>0&&o.copyWithin(e,i,s),a}},"./src/rendering/blendPattern.js":function(W,f,u){u.r(f),u.d(f,"default",function(){return o});class o{constructor(c){this.mesh_width=c.mesh_width,this.mesh_height=c.mesh_height,this.aspectx=c.aspectx,this.aspecty=c.aspecty,this.vertInfoA=new Float32Array((this.mesh_width+1)*(this.mesh_height+1)),this.vertInfoC=new Float32Array((this.mesh_width+1)*(this.mesh_height+1)),this.createBlendPattern()}static resizeMatrixValues(c,t,e,i,s){const l=new Float32Array((i+1)*(s+1));let h=0;for(let A=0;A<s+1;A++)for(let r=0;r<i+1;r++){let n=r/s,d=A/i;n*=t+1,d*=e+1,n=Math.clamp(n,0,t-1),d=Math.clamp(d,0,e-1);const g=Math.floor(n),_=Math.floor(d),m=n-g,x=d-_,E=c[_*(t+1)+g],P=c[_*(t+1)+(g+1)],M=c[(_+1)*(t+1)+g],X=c[(_+1)*(t+1)+(g+1)];l[h]=E*(1-m)*(1-x)+P*m*(1-x)+M*(1-m)*x+X*m*x,h+=1}return l}updateGlobals(c){const t=this.mesh_width,e=this.mesh_height;this.mesh_width=c.mesh_width,this.mesh_height=c.mesh_height,this.aspectx=c.aspectx,this.aspecty=c.aspecty,this.mesh_width===t&&this.mesh_height===e||(this.vertInfoA=o.resizeMatrixValues(this.vertInfoA,t,e,this.mesh_width,this.mesh_height),this.vertInfoC=o.resizeMatrixValues(this.vertInfoC,t,e,this.mesh_width,this.mesh_height))}genPlasma(c,t,e,i,s){const l=Math.floor((c+t)/2),h=Math.floor((e+i)/2);let A=this.vertInfoC[e*(this.mesh_width+1)+c],r=this.vertInfoC[e*(this.mesh_width+1)+t],n=this.vertInfoC[i*(this.mesh_width+1)+c],d=this.vertInfoC[i*(this.mesh_width+1)+t];i-e>=2&&(c===0&&(this.vertInfoC[h*(this.mesh_width+1)+c]=.5*(A+n)+(2*Math.random()-1)*s*this.aspecty),this.vertInfoC[h*(this.mesh_width+1)+t]=.5*(r+d)+(2*Math.random()-1)*s*this.aspecty),t-c>=2&&(e===0&&(this.vertInfoC[e*(this.mesh_width+1)+l]=.5*(A+r)+(2*Math.random()-1)*s*this.aspectx),this.vertInfoC[i*(this.mesh_width+1)+l]=.5*(n+d)+(2*Math.random()-1)*s*this.aspectx),i-e>=2&&t-c>=2&&(A=this.vertInfoC[h*(this.mesh_width+1)+c],r=this.vertInfoC[h*(this.mesh_width+1)+t],n=this.vertInfoC[e*(this.mesh_width+1)+l],d=this.vertInfoC[i*(this.mesh_width+1)+l],this.vertInfoC[h*(this.mesh_width+1)+l]=.25*(n+d+A+r)+(2*Math.random()-1)*s,this.genPlasma(c,l,e,h,.5*s),this.genPlasma(l,t,e,h,.5*s),this.genPlasma(c,l,h,i,.5*s),this.genPlasma(l,t,h,i,.5*s))}createBlendPattern(){const c=1+Math.floor(3*Math.random());if(c===0){let t=0;for(let e=0;e<=this.mesh_height;e++)for(let i=0;i<=this.mesh_width;i++)this.vertInfoA[t]=1,this.vertInfoC[t]=0,t+=1}else if(c===1){const t=6.28*Math.random(),e=Math.cos(t),i=Math.sin(t),s=.1+.2*Math.random(),l=1/s;let h=0;for(let A=0;A<=this.mesh_height;A++){const r=A/this.mesh_height*this.aspecty;for(let n=0;n<=this.mesh_width;n++){let d=(n/this.mesh_width*this.aspectx-.5)*e+(r-.5)*i+.5;d=(d-.5)/Math.sqrt(2)+.5,this.vertInfoA[h]=l*(1+s),this.vertInfoC[h]=l*d-l,h+=1}}}else if(c===2){const t=.12+.13*Math.random(),e=1/t;this.vertInfoC[0]=Math.random(),this.vertInfoC[this.mesh_width]=Math.random(),this.vertInfoC[this.mesh_height*(this.mesh_width+1)]=Math.random(),this.vertInfoC[this.mesh_height*(this.mesh_width+1)+this.mesh_width]=Math.random(),this.genPlasma(0,this.mesh_width,0,this.mesh_height,.25);let i=this.vertInfoC[0],s=this.vertInfoC[0],l=0;for(let A=0;A<=this.mesh_height;A++)for(let r=0;r<=this.mesh_width;r++)i>this.vertInfoC[l]&&(i=this.vertInfoC[l]),s<this.vertInfoC[l]&&(s=this.vertInfoC[l]),l+=1;const h=1/(s-i);l=0;for(let A=0;A<=this.mesh_height;A++)for(let r=0;r<=this.mesh_width;r++){const n=(this.vertInfoC[l]-i)*h;this.vertInfoA[l]=e*(1+t),this.vertInfoC[l]=e*n-e,l+=1}}else if(c===3){const t=.02+.14*Math.random()+.34*Math.random(),e=1/t,i=2*Math.floor(2*Math.random())-1;let s=0;for(let l=0;l<=this.mesh_height;l++){const h=(l/this.mesh_height-.5)*this.aspecty;for(let A=0;A<=this.mesh_width;A++){const r=(A/this.mesh_width-.5)*this.aspectx;let n=1.41421*Math.sqrt(r*r+h*h);i===-1&&(n=1-n),this.vertInfoA[s]=e*(1+t),this.vertInfoC[s]=e*n-e,s+=1}}}}}},"./src/rendering/motionVectors/motionVectors.js":function(W,f,u){u.r(f),u.d(f,"default",function(){return a});var o=u("./src/rendering/shaders/shaderUtils.js");class a{constructor(t,e){this.gl=t,this.maxX=64,this.maxY=48,this.positions=new Float32Array(this.maxX*this.maxY*2*3),this.texsizeX=e.texsizeX,this.texsizeY=e.texsizeY,this.mesh_width=e.mesh_width,this.mesh_height=e.mesh_height,this.positionVertexBuf=this.gl.createBuffer(),this.floatPrecision=o.default.getFragmentFloatPrecision(this.gl),this.createShader()}updateGlobals(t){this.texsizeX=t.texsizeX,this.texsizeY=t.texsizeY,this.mesh_width=t.mesh_width,this.mesh_height=t.mesh_height}createShader(){this.shaderProgram=this.gl.createProgram();const t=this.gl.createShader(this.gl.VERTEX_SHADER);this.gl.shaderSource(t,`
      #version 300 es
      in vec3 aPos;
      void main(void) {
        gl_Position = vec4(aPos, 1.0);
      }
      `.trim()),this.gl.compileShader(t);const e=this.gl.createShader(this.gl.FRAGMENT_SHADER);this.gl.shaderSource(e,`
      #version 300 es
      precision ${this.floatPrecision} float;
      precision highp int;
      precision mediump sampler2D;
      out vec4 fragColor;
      uniform vec4 u_color;
      void main(void) {
        fragColor = u_color;
      }
      `.trim()),this.gl.compileShader(e),this.gl.attachShader(this.shaderProgram,t),this.gl.attachShader(this.shaderProgram,e),this.gl.linkProgram(this.shaderProgram),this.aPosLoc=this.gl.getAttribLocation(this.shaderProgram,"aPos"),this.colorLoc=this.gl.getUniformLocation(this.shaderProgram,"u_color")}getMotionDir(t,e,i){const s=Math.floor(i*this.mesh_height),l=i*this.mesh_height-s,h=Math.floor(e*this.mesh_width),A=e*this.mesh_width-h,r=h+1,n=s+1,d=this.mesh_width+1;let g,_;return g=t[2*(s*d+h)+0]*(1-A)*(1-l),_=t[2*(s*d+h)+1]*(1-A)*(1-l),g+=t[2*(s*d+r)+0]*A*(1-l),_+=t[2*(s*d+r)+1]*A*(1-l),g+=t[2*(n*d+h)+0]*(1-A)*l,_+=t[2*(n*d+h)+1]*(1-A)*l,g+=t[2*(n*d+r)+0]*A*l,_+=t[2*(n*d+r)+1]*A*l,[g,1-_]}generateMotionVectors(t,e){const i=t.bmotionvectorson===0?0:t.mv_a;let s=Math.floor(t.mv_x),l=Math.floor(t.mv_y);if(i>.001&&s>0&&l>0){let h=t.mv_x-s,A=t.mv_y-l;s>this.maxX&&(s=this.maxX,h=0),l>this.maxY&&(l=this.maxY,A=0);const r=t.mv_dx,n=t.mv_dy,d=t.mv_l,g=1/this.texsizeX;this.numVecVerts=0;for(let _=0;_<l;_++){let m=(_+.25)/(l+A+.25-1);if(m-=n,m>1e-4&&m<.9999)for(let x=0;x<s;x++){let E=(x+.25)/(s+h+.25-1);if(E+=r,E>1e-4&&E<.9999){const P=this.getMotionDir(e,E,m);let M=P[0],X=P[1],U=M-E,L=X-m;U*=d,L*=d;let T=Math.sqrt(U*U+L*L);T<g&&T>1e-8?(T=g/T,U*=T,L*=T):(U=g,U=g),M=E+U,X=m+L;const b=2*E-1,v=2*m-1,p=2*M-1,I=2*X-1;this.positions[3*this.numVecVerts+0]=b,this.positions[3*this.numVecVerts+1]=v,this.positions[3*this.numVecVerts+2]=0,this.positions[3*(this.numVecVerts+1)+0]=p,this.positions[3*(this.numVecVerts+1)+1]=I,this.positions[3*(this.numVecVerts+1)+2]=0,this.numVecVerts+=2}}}if(this.numVecVerts>0)return this.color=[t.mv_r,t.mv_g,t.mv_b,i],!0}return!1}drawMotionVectors(t,e){this.generateMotionVectors(t,e)&&(this.gl.useProgram(this.shaderProgram),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.positionVertexBuf),this.gl.bufferData(this.gl.ARRAY_BUFFER,this.positions,this.gl.STATIC_DRAW),this.gl.vertexAttribPointer(this.aPosLoc,3,this.gl.FLOAT,!1,0,0),this.gl.enableVertexAttribArray(this.aPosLoc),this.gl.uniform4fv(this.colorLoc,this.color),this.gl.lineWidth(1),this.gl.blendFunc(this.gl.SRC_ALPHA,this.gl.ONE_MINUS_SRC_ALPHA),this.gl.drawArrays(this.gl.LINES,0,this.numVecVerts))}}},"./src/rendering/renderer.js":function(W,f,u){u.r(f),u.d(f,"default",function(){return U});var o=u("./src/audio/audioLevels.js"),a=u("./src/blankPreset.js"),c=u.n(a),t=u("./src/equations/presetEquationRunner.js"),e=u("./src/equations/presetEquationRunnerWASM.js"),i=u("./src/rendering/waves/basicWaveform.js"),s=u("./src/rendering/waves/customWaveform.js"),l=u("./src/rendering/shapes/customShape.js"),h=u("./src/rendering/sprites/border.js"),A=u("./src/rendering/sprites/darkenCenter.js"),r=u("./src/rendering/motionVectors/motionVectors.js"),n=u("./src/rendering/shaders/warp.js"),d=u("./src/rendering/shaders/comp.js"),g=u("./src/rendering/shaders/output.js"),_=u("./src/rendering/shaders/resample.js"),m=u("./src/rendering/shaders/blur/blur.js"),x=u("./src/noise/noise.js"),E=u("./src/image/imageTextures.js"),P=u("./src/rendering/text/titleText.js"),M=u("./src/rendering/blendPattern.js"),X=u("./src/utils.js");class U{constructor(T,b,v){this.gl=T,this.audio=b,this.frameNum=0,this.fps=30,this.time=0,this.presetTime=0,this.lastTime=performance.now(),this.timeHist=[0],this.timeHistMax=120,this.blending=!1,this.blendStartTime=0,this.blendProgress=0,this.blendDuration=0,this.width=v.width||1200,this.height=v.height||900,this.mesh_width=v.meshWidth||48,this.mesh_height=v.meshHeight||36,this.pixelRatio=v.pixelRatio||window.devicePixelRatio||1,this.textureRatio=v.textureRatio||1,this.outputFXAA=v.outputFXAA||!1,this.texsizeX=this.width*this.pixelRatio*this.textureRatio,this.texsizeY=this.height*this.pixelRatio*this.textureRatio,this.aspectx=this.texsizeY>this.texsizeX?this.texsizeX/this.texsizeY:1,this.aspecty=this.texsizeX>this.texsizeY?this.texsizeY/this.texsizeX:1,this.invAspectx=1/this.aspectx,this.invAspecty=1/this.aspecty,this.qs=X.default.range(1,33).map(y=>`q${y}`),this.ts=X.default.range(1,9).map(y=>`t${y}`),this.regs=X.default.range(0,100).map(y=>y<10?`reg0${y}`:`reg${y}`),this.blurRatios=[[.5,.25],[.125,.125],[.0625,.0625]],this.audioLevels=new o.default(this.audio),this.prevFrameBuffer=this.gl.createFramebuffer(),this.targetFrameBuffer=this.gl.createFramebuffer(),this.prevTexture=this.gl.createTexture(),this.targetTexture=this.gl.createTexture(),this.compFrameBuffer=this.gl.createFramebuffer(),this.compTexture=this.gl.createTexture(),this.anisoExt=this.gl.getExtension("EXT_texture_filter_anisotropic")||this.gl.getExtension("MOZ_EXT_texture_filter_anisotropic")||this.gl.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.bindFrameBufferTexture(this.prevFrameBuffer,this.prevTexture),this.bindFrameBufferTexture(this.targetFrameBuffer,this.targetTexture),this.bindFrameBufferTexture(this.compFrameBuffer,this.compTexture);const p={pixelRatio:this.pixelRatio,textureRatio:this.textureRatio,texsizeX:this.texsizeX,texsizeY:this.texsizeY,mesh_width:this.mesh_width,mesh_height:this.mesh_height,aspectx:this.aspectx,aspecty:this.aspecty};this.noise=new x.default(T),this.image=new E.default(T),this.warpShader=new n.default(T,this.noise,this.image,p),this.compShader=new d.default(T,this.noise,this.image,p),this.outputShader=new g.default(T,p),this.prevWarpShader=new n.default(T,this.noise,this.image,p),this.prevCompShader=new d.default(T,this.noise,this.image,p),this.numBlurPasses=0,this.blurShader1=new m.default(0,this.blurRatios,T,p),this.blurShader2=new m.default(1,this.blurRatios,T,p),this.blurShader3=new m.default(2,this.blurRatios,T,p),this.blurTexture1=this.blurShader1.blurVerticalTexture,this.blurTexture2=this.blurShader2.blurVerticalTexture,this.blurTexture3=this.blurShader3.blurVerticalTexture,this.basicWaveform=new i.default(T,p),this.customWaveforms=X.default.range(4).map(y=>new s.default(y,T,p)),this.customShapes=X.default.range(4).map(y=>new l.default(y,T,p)),this.prevCustomWaveforms=X.default.range(4).map(y=>new s.default(y,T,p)),this.prevCustomShapes=X.default.range(4).map(y=>new l.default(y,T,p)),this.darkenCenter=new A.default(T,p),this.innerBorder=new h.default(T,p),this.outerBorder=new h.default(T,p),this.motionVectors=new r.default(T,p),this.titleText=new P.default(T,p),this.blendPattern=new M.default(p),this.resampleShader=new _.default(T),this.supertext={startTime:-1},this.warpUVs=new Float32Array((this.mesh_width+1)*(this.mesh_height+1)*2),this.warpColor=new Float32Array((this.mesh_width+1)*(this.mesh_height+1)*4),this.gl.clearColor(0,0,0,1),this.blankPreset=c.a;const I={frame:0,time:0,fps:45,bass:1,bass_att:1,mid:1,mid_att:1,treb:1,treb_att:1};this.preset=c.a,this.prevPreset=this.preset,this.presetEquationRunner=new t.default(this.preset,I,p),this.prevPresetEquationRunner=new t.default(this.prevPreset,I,p),this.preset.useWASM||(this.regVars=this.presetEquationRunner.mdVSRegs)}static getHighestBlur(T){return/sampler_blur3/.test(T)?3:/sampler_blur2/.test(T)?2:/sampler_blur1/.test(T)?1:0}loadPreset(T,b){this.blendPattern.createBlendPattern(),this.blending=!0,this.blendStartTime=this.time,this.blendDuration=b,this.blendProgress=0,this.prevPresetEquationRunner=this.presetEquationRunner,this.prevPreset=this.preset,this.preset=T,this.presetTime=this.time;const v={frame:this.frameNum,time:this.time,fps:this.fps,bass:this.audioLevels.bass,bass_att:this.audioLevels.bass_att,mid:this.audioLevels.mid,mid_att:this.audioLevels.mid_att,treb:this.audioLevels.treb,treb_att:this.audioLevels.treb_att},p={pixelRatio:this.pixelRatio,textureRatio:this.textureRatio,texsizeX:this.texsizeX,texsizeY:this.texsizeY,mesh_width:this.mesh_width,mesh_height:this.mesh_height,aspectx:this.aspectx,aspecty:this.aspecty};T.useWASM?(this.preset.globalPools.perFrame.old_wave_mode.value=this.prevPreset.baseVals.wave_mode,this.preset.baseVals.old_wave_mode=this.prevPreset.baseVals.wave_mode,this.presetEquationRunner=new e.default(this.preset,v,p),this.preset.pixel_eqs_initialize_array&&this.preset.pixel_eqs_initialize_array(this.mesh_width,this.mesh_height)):(this.preset.baseVals.old_wave_mode=this.prevPreset.baseVals.wave_mode,this.presetEquationRunner=new t.default(this.preset,v,p),this.regVars=this.presetEquationRunner.mdVSRegs);const I=this.prevWarpShader;this.prevWarpShader=this.warpShader,this.warpShader=I;const y=this.prevCompShader;this.prevCompShader=this.compShader,this.compShader=y;const w=this.preset.warp.trim(),S=this.preset.comp.trim();this.warpShader.updateShader(w),this.compShader.updateShader(S),w.length===0?this.numBlurPasses=0:this.numBlurPasses=U.getHighestBlur(w),S.length!==0&&(this.numBlurPasses=Math.max(this.numBlurPasses,U.getHighestBlur(S)))}loadExtraImages(T){this.image.loadExtraImages(T)}setRendererSize(T,b,v){const p=this.texsizeX,I=this.texsizeY;if(this.width=T,this.height=b,this.mesh_width=v.meshWidth||this.mesh_width,this.mesh_height=v.meshHeight||this.mesh_height,this.pixelRatio=v.pixelRatio||this.pixelRatio,this.textureRatio=v.textureRatio||this.textureRatio,this.texsizeX=T*this.pixelRatio*this.textureRatio,this.texsizeY=b*this.pixelRatio*this.textureRatio,this.aspectx=this.texsizeY>this.texsizeX?this.texsizeX/this.texsizeY:1,this.aspecty=this.texsizeX>this.texsizeY?this.texsizeY/this.texsizeX:1,this.texsizeX!==p||this.texsizeY!==I){const y=this.gl.createTexture();this.bindFrameBufferTexture(this.targetFrameBuffer,y),this.bindFrambufferAndSetViewport(this.targetFrameBuffer,this.texsizeX,this.texsizeY),this.resampleShader.renderQuadTexture(this.targetTexture),this.targetTexture=y,this.bindFrameBufferTexture(this.prevFrameBuffer,this.prevTexture),this.bindFrameBufferTexture(this.compFrameBuffer,this.compTexture)}this.updateGlobals(),this.frameNum>0&&this.renderToScreen()}setInternalMeshSize(T,b){this.mesh_width=T,this.mesh_height=b,this.updateGlobals()}setOutputAA(T){this.outputFXAA=T}updateGlobals(){const T={pixelRatio:this.pixelRatio,textureRatio:this.textureRatio,texsizeX:this.texsizeX,texsizeY:this.texsizeY,mesh_width:this.mesh_width,mesh_height:this.mesh_height,aspectx:this.aspectx,aspecty:this.aspecty};this.presetEquationRunner.updateGlobals(T),this.prevPresetEquationRunner.updateGlobals(T),this.warpShader.updateGlobals(T),this.prevWarpShader.updateGlobals(T),this.compShader.updateGlobals(T),this.prevCompShader.updateGlobals(T),this.outputShader.updateGlobals(T),this.blurShader1.updateGlobals(T),this.blurShader2.updateGlobals(T),this.blurShader3.updateGlobals(T),this.basicWaveform.updateGlobals(T),this.customWaveforms.forEach(b=>b.updateGlobals(T)),this.customShapes.forEach(b=>b.updateGlobals(T)),this.prevCustomWaveforms.forEach(b=>b.updateGlobals(T)),this.prevCustomShapes.forEach(b=>b.updateGlobals(T)),this.darkenCenter.updateGlobals(T),this.innerBorder.updateGlobals(T),this.outerBorder.updateGlobals(T),this.motionVectors.updateGlobals(T),this.titleText.updateGlobals(T),this.blendPattern.updateGlobals(T),this.warpUVs=new Float32Array((this.mesh_width+1)*(this.mesh_height+1)*2),this.warpColor=new Float32Array((this.mesh_width+1)*(this.mesh_height+1)*4),this.preset.pixel_eqs_initialize_array&&this.preset.pixel_eqs_initialize_array(this.mesh_width,this.mesh_height)}calcTimeAndFPS(T){let b;if(T)b=T;else{const I=performance.now();b=(I-this.lastTime)/1e3,(b>1||b<0||this.frame<2)&&(b=1/30),this.lastTime=I}this.time+=1/this.fps,this.blending&&(this.blendProgress=(this.time-this.blendStartTime)/this.blendDuration,this.blendProgress>1&&(this.blending=!1));const v=this.timeHist[this.timeHist.length-1]+b;this.timeHist.push(v),this.timeHist.length>this.timeHistMax&&this.timeHist.shift();const p=this.timeHist.length/(v-this.timeHist[0]);Math.abs(p-this.fps)>3&&this.frame>this.timeHistMax?this.fps=p:this.fps=.93*this.fps+(1-.93)*p}runPixelEquations(T,b,v,p){const I=this.mesh_width,y=this.mesh_height,w=I+1,S=y+1,R=this.time*b.warpanimspeed,D=1/b.warpscale,C=11.68+4*Math.cos(1.413*R+10),O=8.77+3*Math.cos(1.113*R+7),F=10.54+3*Math.cos(1.233*R+3),G=11.49+4*Math.cos(.933*R+5),B=0/this.texsizeX,V=0/this.texsizeY,Q=this.aspectx,q=this.aspecty;let k=0,N=0;if(T.preset.useWASM){const z=T.preset.globalPools.perVertex;if(X.default.setWasm(z,v,T.globalKeys),X.default.setWasm(z,T.mdVSQAfterFrame,T.qs),z.zoom.value=b.zoom,z.zoomexp.value=b.zoomexp,z.rot.value=b.rot,z.warp.value=b.warp,z.cx.value=b.cx,z.cy.value=b.cy,z.dx.value=b.dx,z.dy.value=b.dy,z.sx.value=b.sx,z.sy.value=b.sy,T.preset.pixel_eqs_wasm(T.runVertEQs,this.mesh_width,this.mesh_height,this.time,b.warpanimspeed,b.warpscale,this.aspectx,this.aspecty),p){const J=T.preset.pixel_eqs_get_array();let et=0,Y=0;for(let j=0;j<S;j++)for(let K=0;K<w;K++){const H=J[et],Z=J[et+1];let tt=this.blendPattern.vertInfoA[et/2]*this.blendProgress+this.blendPattern.vertInfoC[et/2];tt=Math.clamp(tt,0,1),this.warpUVs[et]=this.warpUVs[et]*tt+H*(1-tt),this.warpUVs[et+1]=this.warpUVs[et+1]*tt+Z*(1-tt),this.warpColor[Y+0]=1,this.warpColor[Y+1]=1,this.warpColor[Y+2]=1,this.warpColor[Y+3]=tt,et+=2,Y+=4}}else this.warpUVs=T.preset.pixel_eqs_get_array(),this.warpColor.fill(1)}else{let z=X.default.cloneVars(b),J=z.warp,et=z.zoom,Y=z.zoomexp,j=z.cx,K=z.cy,H=z.sx,Z=z.sy,tt=z.dx,it=z.dy,ot=z.rot;for(let $=0;$<S;$++)for(let ht=0;ht<w;ht++){const nt=ht/I*2-1,st=$/y*2-1,ct=Math.sqrt(nt*nt*Q*Q+st*st*q*q);if(T.runVertEQs){let At;At=$===y/2&&ht===I/2?0:X.default.atan2(st*q,nt*Q),z.x=.5*nt*Q+.5,z.y=-.5*st*q+.5,z.rad=ct,z.ang=At,z.zoom=b.zoom,z.zoomexp=b.zoomexp,z.rot=b.rot,z.warp=b.warp,z.cx=b.cx,z.cy=b.cy,z.dx=b.dx,z.dy=b.dy,z.sx=b.sx,z.sy=b.sy,z=T.runPixelEquations(z),J=z.warp,et=z.zoom,Y=z.zoomexp,j=z.cx,K=z.cy,H=z.sx,Z=z.sy,tt=z.dx,it=z.dy,ot=z.rot}const lt=1/et**Y**(2*ct-1);let rt=.5*nt*Q*lt+.5,at=.5*-st*q*lt+.5;rt=(rt-j)/H+j,at=(at-K)/Z+K,J!==0&&(rt+=.0035*J*Math.sin(.333*R+D*(nt*C-st*G)),at+=.0035*J*Math.cos(.375*R-D*(nt*F+st*O)),rt+=.0035*J*Math.cos(.753*R-D*(nt*O-st*F)),at+=.0035*J*Math.sin(.825*R+D*(nt*C+st*G)));const gt=rt-j,mt=at-K,ut=Math.cos(ot),dt=Math.sin(ot);if(rt=gt*ut-mt*dt+j,at=gt*dt+mt*ut+K,rt-=tt,at-=it,rt=(rt-.5)/Q+.5,at=(at-.5)/q+.5,rt+=B,at+=V,p){let At=this.blendPattern.vertInfoA[k/2]*this.blendProgress+this.blendPattern.vertInfoC[k/2];At=Math.clamp(At,0,1),this.warpUVs[k]=this.warpUVs[k]*At+rt*(1-At),this.warpUVs[k+1]=this.warpUVs[k+1]*At+at*(1-At),this.warpColor[N+0]=1,this.warpColor[N+1]=1,this.warpColor[N+2]=1,this.warpColor[N+3]=At}else this.warpUVs[k]=rt,this.warpUVs[k+1]=at,this.warpColor[N+0]=1,this.warpColor[N+1]=1,this.warpColor[N+2]=1,this.warpColor[N+3]=1;k+=2,N+=4}this.mdVSVertex=z}}static mixFrameEquations(T,b,v){const p=.5-.5*Math.cos(T*Math.PI),I=1-p,y=.5,w=X.default.cloneVars(b);return w.decay=p*b.decay+I*v.decay,w.wave_a=p*b.wave_a+I*v.wave_a,w.wave_r=p*b.wave_r+I*v.wave_r,w.wave_g=p*b.wave_g+I*v.wave_g,w.wave_b=p*b.wave_b+I*v.wave_b,w.wave_x=p*b.wave_x+I*v.wave_x,w.wave_y=p*b.wave_y+I*v.wave_y,w.wave_mystery=p*b.wave_mystery+I*v.wave_mystery,w.ob_size=p*b.ob_size+I*v.ob_size,w.ob_r=p*b.ob_r+I*v.ob_r,w.ob_g=p*b.ob_g+I*v.ob_g,w.ob_b=p*b.ob_b+I*v.ob_b,w.ob_a=p*b.ob_a+I*v.ob_a,w.ib_size=p*b.ib_size+I*v.ib_size,w.ib_r=p*b.ib_r+I*v.ib_r,w.ib_g=p*b.ib_g+I*v.ib_g,w.ib_b=p*b.ib_b+I*v.ib_b,w.ib_a=p*b.ib_a+I*v.ib_a,w.mv_x=p*b.mv_x+I*v.mv_x,w.mv_y=p*b.mv_y+I*v.mv_y,w.mv_dx=p*b.mv_dx+I*v.mv_dx,w.mv_dy=p*b.mv_dy+I*v.mv_dy,w.mv_l=p*b.mv_l+I*v.mv_l,w.mv_r=p*b.mv_r+I*v.mv_r,w.mv_g=p*b.mv_g+I*v.mv_g,w.mv_b=p*b.mv_b+I*v.mv_b,w.mv_a=p*b.mv_a+I*v.mv_a,w.echo_zoom=p*b.echo_zoom+I*v.echo_zoom,w.echo_alpha=p*b.echo_alpha+I*v.echo_alpha,w.echo_orient=p*b.echo_orient+I*v.echo_orient,w.wave_dots=p<y?v.wave_dots:b.wave_dots,w.wave_thick=p<y?v.wave_thick:b.wave_thick,w.additivewave=p<y?v.additivewave:b.additivewave,w.wave_brighten=p<y?v.wave_brighten:b.wave_brighten,w.darken_center=p<y?v.darken_center:b.darken_center,w.gammaadj=p<y?v.gammaadj:b.gammaadj,w.wrap=p<y?v.wrap:b.wrap,w.invert=p<y?v.invert:b.invert,w.brighten=p<y?v.brighten:b.brighten,w.darken=p<y?v.darken:b.darken,w.solarize=p<y?v.brighten:b.solarize,w.b1n=p*b.b1n+I*v.b1n,w.b2n=p*b.b2n+I*v.b2n,w.b3n=p*b.b3n+I*v.b3n,w.b1x=p*b.b1x+I*v.b1x,w.b2x=p*b.b2x+I*v.b2x,w.b3x=p*b.b3x+I*v.b3x,w.b1ed=p*b.b1ed+I*v.b1ed,w}static getBlurValues(T){let b=T.b1n,v=T.b2n,p=T.b3n,I=T.b1x,y=T.b2x,w=T.b3x;const S=.1;if(I-b<S){const R=.5*(b+I);b=R-.05,I=R-.05}if(y=Math.min(I,y),v=Math.max(b,v),y-v<S){const R=.5*(v+y);v=R-.05,y=R-.05}if(w=Math.min(y,w),p=Math.max(v,p),w-p<S){const R=.5*(p+w);p=R-.05,w=R-.05}return{blurMins:[b,v,p],blurMaxs:[I,y,w]}}bindFrambufferAndSetViewport(T,b,v){this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,T),this.gl.viewport(0,0,b,v)}bindFrameBufferTexture(T,b){if(this.gl.bindTexture(this.gl.TEXTURE_2D,b),this.gl.pixelStorei(this.gl.UNPACK_ALIGNMENT,1),this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl.RGBA,this.texsizeX,this.texsizeY,0,this.gl.RGBA,this.gl.UNSIGNED_BYTE,new Uint8Array(this.texsizeX*this.texsizeY*4)),this.gl.generateMipmap(this.gl.TEXTURE_2D),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_S,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_T,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MIN_FILTER,this.gl.LINEAR_MIPMAP_LINEAR),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MAG_FILTER,this.gl.LINEAR),this.anisoExt){const v=this.gl.getParameter(this.anisoExt.MAX_TEXTURE_MAX_ANISOTROPY_EXT);this.gl.texParameterf(this.gl.TEXTURE_2D,this.anisoExt.TEXTURE_MAX_ANISOTROPY_EXT,v)}this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,T),this.gl.framebufferTexture2D(this.gl.FRAMEBUFFER,this.gl.COLOR_ATTACHMENT0,this.gl.TEXTURE_2D,b,0)}render({audioLevels:T,elapsedTime:b}={}){this.calcTimeAndFPS(b),this.frameNum+=1,T?this.audio.updateAudio(T.timeByteArray,T.timeByteArrayL,T.timeByteArrayR):this.audio.sampleAudio(),this.audioLevels.updateAudioLevels(this.fps,this.frameNum);const v={frame:this.frameNum,time:this.time,fps:this.fps,bass:this.audioLevels.bass,bass_att:this.audioLevels.bass_att,mid:this.audioLevels.mid,mid_att:this.audioLevels.mid_att,treb:this.audioLevels.treb,treb_att:this.audioLevels.treb_att,meshx:this.mesh_width,meshy:this.mesh_height,aspectx:this.invAspectx,aspecty:this.invAspecty,pixelsx:this.texsizeX,pixelsy:this.texsizeY},p=Object.assign({},v);this.prevPreset.useWASM||(p.gmegabuf=this.prevPresetEquationRunner.gmegabuf),this.preset.useWASM||(v.gmegabuf=this.presetEquationRunner.gmegabuf,Object.assign(v,this.regVars));const I=this.presetEquationRunner.runFrameEquations(v);let y;this.runPixelEquations(this.presetEquationRunner,I,v,!1),this.preset.useWASM||(Object.assign(this.regVars,X.default.pick(this.mdVSVertex,this.regs)),Object.assign(v,this.regVars)),this.blending?(this.prevMDVSFrame=this.prevPresetEquationRunner.runFrameEquations(p),this.runPixelEquations(this.prevPresetEquationRunner,this.prevMDVSFrame,p,!0),y=U.mixFrameEquations(this.blendProgress,I,this.prevMDVSFrame)):y=I;const w=this.targetTexture;this.targetTexture=this.prevTexture,this.prevTexture=w;const S=this.targetFrameBuffer;this.targetFrameBuffer=this.prevFrameBuffer,this.prevFrameBuffer=S,this.gl.bindTexture(this.gl.TEXTURE_2D,this.prevTexture),this.gl.generateMipmap(this.gl.TEXTURE_2D),this.bindFrambufferAndSetViewport(this.targetFrameBuffer,this.texsizeX,this.texsizeY),this.gl.clear(this.gl.COLOR_BUFFER_BIT),this.gl.enable(this.gl.BLEND),this.gl.blendEquation(this.gl.FUNC_ADD),this.gl.blendFunc(this.gl.SRC_ALPHA,this.gl.ONE_MINUS_SRC_ALPHA);const{blurMins:R,blurMaxs:D}=U.getBlurValues(y);this.blending?(this.prevWarpShader.renderQuadTexture(!1,this.prevTexture,this.blurTexture1,this.blurTexture2,this.blurTexture3,R,D,this.prevMDVSFrame,this.prevPresetEquationRunner.mdVSQAfterFrame,this.warpUVs,this.warpColor),this.warpShader.renderQuadTexture(!0,this.prevTexture,this.blurTexture1,this.blurTexture2,this.blurTexture3,R,D,y,this.presetEquationRunner.mdVSQAfterFrame,this.warpUVs,this.warpColor)):this.warpShader.renderQuadTexture(!1,this.prevTexture,this.blurTexture1,this.blurTexture2,this.blurTexture3,R,D,I,this.presetEquationRunner.mdVSQAfterFrame,this.warpUVs,this.warpColor),this.numBlurPasses>0&&(this.blurShader1.renderBlurTexture(this.targetTexture,I,R,D),this.numBlurPasses>1&&(this.blurShader2.renderBlurTexture(this.blurTexture1,I,R,D),this.numBlurPasses>2&&this.blurShader3.renderBlurTexture(this.blurTexture2,I,R,D)),this.bindFrambufferAndSetViewport(this.targetFrameBuffer,this.texsizeX,this.texsizeY)),this.motionVectors.drawMotionVectors(y,this.warpUVs),this.preset.shapes&&this.preset.shapes.length>0&&this.customShapes.forEach((F,G)=>{F.drawCustomShape(this.blending?this.blendProgress:1,v,this.presetEquationRunner,this.preset.shapes[G],this.prevTexture)}),this.preset.waves&&this.preset.waves.length>0&&this.customWaveforms.forEach((F,G)=>{F.drawCustomWaveform(this.blending?this.blendProgress:1,this.audio.timeArrayL,this.audio.timeArrayR,this.audio.freqArrayL,this.audio.freqArrayR,v,this.presetEquationRunner,this.preset.waves[G])}),this.blending&&(this.prevPreset.shapes&&this.prevPreset.shapes.length>0&&this.prevCustomShapes.forEach((F,G)=>{F.drawCustomShape(1-this.blendProgress,p,this.prevPresetEquationRunner,this.prevPreset.shapes[G],this.prevTexture)}),this.prevPreset.waves&&this.prevPreset.waves.length>0&&this.prevCustomWaveforms.forEach((F,G)=>{F.drawCustomWaveform(1-this.blendProgress,this.audio.timeArrayL,this.audio.timeArrayR,this.audio.freqArrayL,this.audio.freqArrayR,p,this.prevPresetEquationRunner,this.prevPreset.waves[G])})),this.basicWaveform.drawBasicWaveform(this.blending,this.blendProgress,this.audio.timeArrayL,this.audio.timeArrayR,y),this.darkenCenter.drawDarkenCenter(y);const C=[y.ob_r,y.ob_g,y.ob_b,y.ob_a];this.outerBorder.drawBorder(C,y.ob_size,0);const O=[y.ib_r,y.ib_g,y.ib_b,y.ib_a];if(this.innerBorder.drawBorder(O,y.ib_size,y.ob_size),this.supertext.startTime>=0){const F=(this.time-this.supertext.startTime)/this.supertext.duration;F>=1&&this.titleText.renderTitle(F,!0,v)}this.globalVars=v,this.mdVSFrame=I,this.mdVSFrameMixed=y,this.renderToScreen()}renderToScreen(){this.outputFXAA?this.bindFrambufferAndSetViewport(this.compFrameBuffer,this.texsizeX,this.texsizeY):this.bindFrambufferAndSetViewport(null,this.width,this.height),this.gl.clear(this.gl.COLOR_BUFFER_BIT),this.gl.enable(this.gl.BLEND),this.gl.blendEquation(this.gl.FUNC_ADD),this.gl.blendFunc(this.gl.SRC_ALPHA,this.gl.ONE_MINUS_SRC_ALPHA);const{blurMins:T,blurMaxs:b}=U.getBlurValues(this.mdVSFrameMixed);if(this.blending?(this.prevCompShader.renderQuadTexture(!1,this.targetTexture,this.blurTexture1,this.blurTexture2,this.blurTexture3,T,b,this.prevMDVSFrame,this.prevPresetEquationRunner.mdVSQAfterFrame,this.warpColor),this.compShader.renderQuadTexture(!0,this.targetTexture,this.blurTexture1,this.blurTexture2,this.blurTexture3,T,b,this.mdVSFrameMixed,this.presetEquationRunner.mdVSQAfterFrame,this.warpColor)):this.compShader.renderQuadTexture(!1,this.targetTexture,this.blurTexture1,this.blurTexture2,this.blurTexture3,T,b,this.mdVSFrame,this.presetEquationRunner.mdVSQAfterFrame,this.warpColor),this.supertext.startTime>=0){const v=(this.time-this.supertext.startTime)/this.supertext.duration;this.titleText.renderTitle(v,!1,this.globalVars),v>=1&&(this.supertext.startTime=-1)}this.outputFXAA&&(this.gl.bindTexture(this.gl.TEXTURE_2D,this.compTexture),this.gl.generateMipmap(this.gl.TEXTURE_2D),this.bindFrambufferAndSetViewport(null,this.width,this.height),this.outputShader.renderQuadTexture(this.compTexture))}launchSongTitleAnim(T){this.supertext={startTime:this.time,duration:1.7},this.titleText.generateTitleTexture(T)}toDataURL(){const T=new Uint8Array(this.texsizeX*this.texsizeY*4),b=this.gl.createFramebuffer(),v=this.gl.createTexture();this.bindFrameBufferTexture(b,v);const{blurMins:p,blurMaxs:I}=U.getBlurValues(this.mdVSFrameMixed);this.compShader.renderQuadTexture(!1,this.targetTexture,this.blurTexture1,this.blurTexture2,this.blurTexture3,p,I,this.mdVSFrame,this.presetEquationRunner.mdVSQAfterFrame,this.warpColor),this.gl.readPixels(0,0,this.texsizeX,this.texsizeY,this.gl.RGBA,this.gl.UNSIGNED_BYTE,T),Array.from({length:this.texsizeY},(R,D)=>T.slice(D*this.texsizeX*4,(D+1)*this.texsizeX*4)).forEach((R,D)=>T.set(R,(this.texsizeY-D-1)*this.texsizeX*4));const y=document.createElement("canvas");y.width=this.texsizeX,y.height=this.texsizeY;const w=y.getContext("2d"),S=w.createImageData(this.texsizeX,this.texsizeY);return S.data.set(T),w.putImageData(S,0,0),this.gl.deleteTexture(v),this.gl.deleteFramebuffer(b),y.toDataURL()}warpBufferToDataURL(){const T=new Uint8Array(this.texsizeX*this.texsizeY*4);this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,this.targetFrameBuffer),this.gl.readPixels(0,0,this.texsizeX,this.texsizeY,this.gl.RGBA,this.gl.UNSIGNED_BYTE,T);const b=document.createElement("canvas");b.width=this.texsizeX,b.height=this.texsizeY;const v=b.getContext("2d"),p=v.createImageData(this.texsizeX,this.texsizeY);return p.data.set(T),v.putImageData(p,0,0),b.toDataURL()}}},"./src/rendering/shaders/blur/blur.js":function(W,f,u){u.r(f),u.d(f,"default",function(){return c});var o=u("./src/rendering/shaders/blur/blurVertical.js"),a=u("./src/rendering/shaders/blur/blurHorizontal.js");class c{constructor(e,i,s,l={}){this.blurLevel=e,this.blurRatios=i,this.gl=s,this.texsizeX=l.texsizeX,this.texsizeY=l.texsizeY,this.anisoExt=this.gl.getExtension("EXT_texture_filter_anisotropic")||this.gl.getExtension("MOZ_EXT_texture_filter_anisotropic")||this.gl.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.blurHorizontalFrameBuffer=this.gl.createFramebuffer(),this.blurVerticalFrameBuffer=this.gl.createFramebuffer(),this.blurHorizontalTexture=this.gl.createTexture(),this.blurVerticalTexture=this.gl.createTexture(),this.setupFrameBufferTextures(),this.blurHorizontal=new a.default(s,this.blurLevel,l),this.blurVertical=new o.default(s,this.blurLevel,l)}updateGlobals(e){this.texsizeX=e.texsizeX,this.texsizeY=e.texsizeY,this.setupFrameBufferTextures()}getTextureSize(e){let i=Math.max(this.texsizeX*e,16);i=16*Math.floor((i+3)/16);let s=Math.max(this.texsizeY*e,16);return s=4*Math.floor((s+3)/4),[i,s]}setupFrameBufferTextures(){const e=this.blurLevel>0?this.blurRatios[this.blurLevel-1]:[1,1],i=this.blurRatios[this.blurLevel],s=this.getTextureSize(e[1]),l=this.getTextureSize(i[0]);this.bindFrameBufferTexture(this.blurHorizontalFrameBuffer,this.blurHorizontalTexture,l);const h=l,A=this.getTextureSize(i[1]);this.bindFrameBufferTexture(this.blurVerticalFrameBuffer,this.blurVerticalTexture,A),this.horizontalTexsizes=[s,l],this.verticalTexsizes=[h,A]}bindFrambufferAndSetViewport(e,i){this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,e),this.gl.viewport(0,0,i[0],i[1])}bindFrameBufferTexture(e,i,s){if(this.gl.bindTexture(this.gl.TEXTURE_2D,i),this.gl.pixelStorei(this.gl.UNPACK_ALIGNMENT,1),this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl.RGBA,s[0],s[1],0,this.gl.RGBA,this.gl.UNSIGNED_BYTE,new Uint8Array(s[0]*s[1]*4)),this.gl.generateMipmap(this.gl.TEXTURE_2D),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_S,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_T,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MIN_FILTER,this.gl.LINEAR_MIPMAP_LINEAR),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MAG_FILTER,this.gl.LINEAR),this.anisoExt){const l=this.gl.getParameter(this.anisoExt.MAX_TEXTURE_MAX_ANISOTROPY_EXT);this.gl.texParameterf(this.gl.TEXTURE_2D,this.anisoExt.TEXTURE_MAX_ANISOTROPY_EXT,l)}this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,e),this.gl.framebufferTexture2D(this.gl.FRAMEBUFFER,this.gl.COLOR_ATTACHMENT0,this.gl.TEXTURE_2D,i,0)}renderBlurTexture(e,i,s,l){this.bindFrambufferAndSetViewport(this.blurHorizontalFrameBuffer,this.horizontalTexsizes[1]),this.blurHorizontal.renderQuadTexture(e,i,s,l,this.horizontalTexsizes[0]),this.gl.bindTexture(this.gl.TEXTURE_2D,this.blurHorizontalTexture),this.gl.generateMipmap(this.gl.TEXTURE_2D),this.bindFrambufferAndSetViewport(this.blurVerticalFrameBuffer,this.verticalTexsizes[1]),this.blurVertical.renderQuadTexture(this.blurHorizontalTexture,i,this.verticalTexsizes[0]),this.gl.bindTexture(this.gl.TEXTURE_2D,this.blurVerticalTexture),this.gl.generateMipmap(this.gl.TEXTURE_2D)}}},"./src/rendering/shaders/blur/blurHorizontal.js":function(W,f,u){u.r(f),u.d(f,"default",function(){return a});var o=u("./src/rendering/shaders/shaderUtils.js");class a{constructor(t,e){this.gl=t,this.blurLevel=e;const i=[4,3.8,3.5,2.9,1.9,1.2,.7,.3],s=i[0]+i[1],l=i[2]+i[3],h=i[4]+i[5],A=i[6]+i[7],r=0+2*i[1]/s,n=2+2*i[3]/l,d=4+2*i[5]/h,g=6+2*i[7]/A;this.ws=new Float32Array([s,l,h,A]),this.ds=new Float32Array([r,n,d,g]),this.wDiv=.5/(s+l+h+A),this.positions=new Float32Array([-1,-1,1,-1,-1,1,1,1]),this.vertexBuf=this.gl.createBuffer(),this.floatPrecision=o.default.getFragmentFloatPrecision(this.gl),this.createShader()}createShader(){this.shaderProgram=this.gl.createProgram();const t=this.gl.createShader(this.gl.VERTEX_SHADER);this.gl.shaderSource(t,`
      #version 300 es
      const vec2 halfmad = vec2(0.5);
      in vec2 aPos;
      out vec2 uv;
      void main(void) {
        gl_Position = vec4(aPos, 0.0, 1.0);
        uv = aPos * halfmad + halfmad;
      }
      `.trim()),this.gl.compileShader(t);const e=this.gl.createShader(this.gl.FRAGMENT_SHADER);this.gl.shaderSource(e,`#version 300 es
       precision ${this.floatPrecision} float;
       precision highp int;
       precision mediump sampler2D;

       in vec2 uv;
       out vec4 fragColor;
       uniform sampler2D uTexture;
       uniform vec4 texsize;
       uniform float scale;
       uniform float bias;
       uniform vec4 ws;
       uniform vec4 ds;
       uniform float wdiv;

       void main(void) {
         float w1 = ws[0];
         float w2 = ws[1];
         float w3 = ws[2];
         float w4 = ws[3];
         float d1 = ds[0];
         float d2 = ds[1];
         float d3 = ds[2];
         float d4 = ds[3];

         vec2 uv2 = uv.xy;

         vec3 blur =
           ( texture(uTexture, uv2 + vec2( d1 * texsize.z,0.0) ).xyz
           + texture(uTexture, uv2 + vec2(-d1 * texsize.z,0.0) ).xyz) * w1 +
           ( texture(uTexture, uv2 + vec2( d2 * texsize.z,0.0) ).xyz
           + texture(uTexture, uv2 + vec2(-d2 * texsize.z,0.0) ).xyz) * w2 +
           ( texture(uTexture, uv2 + vec2( d3 * texsize.z,0.0) ).xyz
           + texture(uTexture, uv2 + vec2(-d3 * texsize.z,0.0) ).xyz) * w3 +
           ( texture(uTexture, uv2 + vec2( d4 * texsize.z,0.0) ).xyz
           + texture(uTexture, uv2 + vec2(-d4 * texsize.z,0.0) ).xyz) * w4;

         blur.xyz *= wdiv;
         blur.xyz = blur.xyz * scale + bias;

         fragColor = vec4(blur, 1.0);
       }`),this.gl.compileShader(e),this.gl.attachShader(this.shaderProgram,t),this.gl.attachShader(this.shaderProgram,e),this.gl.linkProgram(this.shaderProgram),this.positionLocation=this.gl.getAttribLocation(this.shaderProgram,"aPos"),this.textureLoc=this.gl.getUniformLocation(this.shaderProgram,"uTexture"),this.texsizeLocation=this.gl.getUniformLocation(this.shaderProgram,"texsize"),this.scaleLoc=this.gl.getUniformLocation(this.shaderProgram,"scale"),this.biasLoc=this.gl.getUniformLocation(this.shaderProgram,"bias"),this.wsLoc=this.gl.getUniformLocation(this.shaderProgram,"ws"),this.dsLocation=this.gl.getUniformLocation(this.shaderProgram,"ds"),this.wdivLoc=this.gl.getUniformLocation(this.shaderProgram,"wdiv")}getScaleAndBias(t,e){const i=[1,1,1],s=[0,0,0];let l,h;return i[0]=1/(e[0]-t[0]),s[0]=-t[0]*i[0],l=(t[1]-t[0])/(e[0]-t[0]),h=(e[1]-t[0])/(e[0]-t[0]),i[1]=1/(h-l),s[1]=-l*i[1],l=(t[2]-t[1])/(e[1]-t[1]),h=(e[2]-t[1])/(e[1]-t[1]),i[2]=1/(h-l),s[2]=-l*i[2],{scale:i[this.blurLevel],bias:s[this.blurLevel]}}renderQuadTexture(t,e,i,s,l){this.gl.useProgram(this.shaderProgram),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.vertexBuf),this.gl.bufferData(this.gl.ARRAY_BUFFER,this.positions,this.gl.STATIC_DRAW),this.gl.vertexAttribPointer(this.positionLocation,2,this.gl.FLOAT,!1,0,0),this.gl.enableVertexAttribArray(this.positionLocation),this.gl.activeTexture(this.gl.TEXTURE0),this.gl.bindTexture(this.gl.TEXTURE_2D,t),this.gl.uniform1i(this.textureLoc,0);const{scale:h,bias:A}=this.getScaleAndBias(i,s);this.gl.uniform4fv(this.texsizeLocation,[l[0],l[1],1/l[0],1/l[1]]),this.gl.uniform1f(this.scaleLoc,h),this.gl.uniform1f(this.biasLoc,A),this.gl.uniform4fv(this.wsLoc,this.ws),this.gl.uniform4fv(this.dsLocation,this.ds),this.gl.uniform1f(this.wdivLoc,this.wDiv),this.gl.blendFunc(this.gl.SRC_ALPHA,this.gl.ONE_MINUS_SRC_ALPHA),this.gl.drawArrays(this.gl.TRIANGLE_STRIP,0,4)}}},"./src/rendering/shaders/blur/blurVertical.js":function(W,f,u){u.r(f),u.d(f,"default",function(){return a});var o=u("./src/rendering/shaders/shaderUtils.js");class a{constructor(t,e){this.gl=t,this.blurLevel=e;const i=[4,3.8,3.5,2.9,1.9,1.2,.7,.3],s=i[0]+i[1]+i[2]+i[3],l=i[4]+i[5]+i[6]+i[7],h=0+(i[2]+i[3])/s*2,A=2+(i[6]+i[7])/l*2;this.wds=new Float32Array([s,l,h,A]),this.wDiv=1/(2*(s+l)),this.positions=new Float32Array([-1,-1,1,-1,-1,1,1,1]),this.vertexBuf=this.gl.createBuffer(),this.floatPrecision=o.default.getFragmentFloatPrecision(this.gl),this.createShader()}createShader(){this.shaderProgram=this.gl.createProgram();const t=this.gl.createShader(this.gl.VERTEX_SHADER);this.gl.shaderSource(t,`
      #version 300 es
      const vec2 halfmad = vec2(0.5);
      in vec2 aPos;
      out vec2 uv;
      void main(void) {
        gl_Position = vec4(aPos, 0.0, 1.0);
        uv = aPos * halfmad + halfmad;
      }
      `.trim()),this.gl.compileShader(t);const e=this.gl.createShader(this.gl.FRAGMENT_SHADER);this.gl.shaderSource(e,`#version 300 es
       precision ${this.floatPrecision} float;
       precision highp int;
       precision mediump sampler2D;

       in vec2 uv;
       out vec4 fragColor;
       uniform sampler2D uTexture;
       uniform vec4 texsize;
       uniform float ed1;
       uniform float ed2;
       uniform float ed3;
       uniform vec4 wds;
       uniform float wdiv;

       void main(void) {
         float w1 = wds[0];
         float w2 = wds[1];
         float d1 = wds[2];
         float d2 = wds[3];

         vec2 uv2 = uv.xy;

         vec3 blur =
           ( texture(uTexture, uv2 + vec2(0.0, d1 * texsize.w) ).xyz
           + texture(uTexture, uv2 + vec2(0.0,-d1 * texsize.w) ).xyz) * w1 +
           ( texture(uTexture, uv2 + vec2(0.0, d2 * texsize.w) ).xyz
           + texture(uTexture, uv2 + vec2(0.0,-d2 * texsize.w) ).xyz) * w2;

         blur.xyz *= wdiv;

         float t = min(min(uv.x, uv.y), 1.0 - max(uv.x, uv.y));
         t = sqrt(t);
         t = ed1 + ed2 * clamp(t * ed3, 0.0, 1.0);
         blur.xyz *= t;

         fragColor = vec4(blur, 1.0);
       }`),this.gl.compileShader(e),this.gl.attachShader(this.shaderProgram,t),this.gl.attachShader(this.shaderProgram,e),this.gl.linkProgram(this.shaderProgram),this.positionLocation=this.gl.getAttribLocation(this.shaderProgram,"aPos"),this.textureLoc=this.gl.getUniformLocation(this.shaderProgram,"uTexture"),this.texsizeLocation=this.gl.getUniformLocation(this.shaderProgram,"texsize"),this.ed1Loc=this.gl.getUniformLocation(this.shaderProgram,"ed1"),this.ed2Loc=this.gl.getUniformLocation(this.shaderProgram,"ed2"),this.ed3Loc=this.gl.getUniformLocation(this.shaderProgram,"ed3"),this.wdsLocation=this.gl.getUniformLocation(this.shaderProgram,"wds"),this.wdivLoc=this.gl.getUniformLocation(this.shaderProgram,"wdiv")}renderQuadTexture(t,e,i){this.gl.useProgram(this.shaderProgram),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.vertexBuf),this.gl.bufferData(this.gl.ARRAY_BUFFER,this.positions,this.gl.STATIC_DRAW),this.gl.vertexAttribPointer(this.positionLocation,2,this.gl.FLOAT,!1,0,0),this.gl.enableVertexAttribArray(this.positionLocation),this.gl.activeTexture(this.gl.TEXTURE0),this.gl.bindTexture(this.gl.TEXTURE_2D,t),this.gl.uniform1i(this.textureLoc,0);const s=this.blurLevel===0?e.b1ed:0;this.gl.uniform4fv(this.texsizeLocation,[i[0],i[1],1/i[0],1/i[1]]),this.gl.uniform1f(this.ed1Loc,1-s),this.gl.uniform1f(this.ed2Loc,s),this.gl.uniform1f(this.ed3Loc,5),this.gl.uniform4fv(this.wdsLocation,this.wds),this.gl.uniform1f(this.wdivLoc,this.wDiv),this.gl.blendFunc(this.gl.SRC_ALPHA,this.gl.ONE_MINUS_SRC_ALPHA),this.gl.drawArrays(this.gl.TRIANGLE_STRIP,0,4)}}},"./src/rendering/shaders/comp.js":function(W,f,u){u.r(f),u.d(f,"default",function(){return a});var o=u("./src/rendering/shaders/shaderUtils.js");class a{constructor(t,e,i,s={}){this.gl=t,this.noise=e,this.image=i,this.mesh_width=s.mesh_width,this.mesh_height=s.mesh_height,this.texsizeX=s.texsizeX,this.texsizeY=s.texsizeY,this.aspectx=s.aspectx,this.aspecty=s.aspecty,this.invAspectx=1/this.aspectx,this.invAspecty=1/this.aspecty,this.compWidth=32,this.compHeight=24,this.buildPositions(),this.indexBuf=t.createBuffer(),this.positionVertexBuf=this.gl.createBuffer(),this.compColorVertexBuf=this.gl.createBuffer(),this.floatPrecision=o.default.getFragmentFloatPrecision(this.gl),this.createShader(),this.mainSampler=this.gl.createSampler(),this.mainSamplerFW=this.gl.createSampler(),this.mainSamplerFC=this.gl.createSampler(),this.mainSamplerPW=this.gl.createSampler(),this.mainSamplerPC=this.gl.createSampler(),t.samplerParameteri(this.mainSampler,t.TEXTURE_MIN_FILTER,t.LINEAR_MIPMAP_LINEAR),t.samplerParameteri(this.mainSampler,t.TEXTURE_MAG_FILTER,t.LINEAR),t.samplerParameteri(this.mainSampler,t.TEXTURE_WRAP_S,t.REPEAT),t.samplerParameteri(this.mainSampler,t.TEXTURE_WRAP_T,t.REPEAT),t.samplerParameteri(this.mainSamplerFW,t.TEXTURE_MIN_FILTER,t.LINEAR_MIPMAP_LINEAR),t.samplerParameteri(this.mainSamplerFW,t.TEXTURE_MAG_FILTER,t.LINEAR),t.samplerParameteri(this.mainSamplerFW,t.TEXTURE_WRAP_S,t.REPEAT),t.samplerParameteri(this.mainSamplerFW,t.TEXTURE_WRAP_T,t.REPEAT),t.samplerParameteri(this.mainSamplerFC,t.TEXTURE_MIN_FILTER,t.LINEAR_MIPMAP_LINEAR),t.samplerParameteri(this.mainSamplerFC,t.TEXTURE_MAG_FILTER,t.LINEAR),t.samplerParameteri(this.mainSamplerFC,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.samplerParameteri(this.mainSamplerFC,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),t.samplerParameteri(this.mainSamplerPW,t.TEXTURE_MIN_FILTER,t.NEAREST_MIPMAP_NEAREST),t.samplerParameteri(this.mainSamplerPW,t.TEXTURE_MAG_FILTER,t.NEAREST),t.samplerParameteri(this.mainSamplerPW,t.TEXTURE_WRAP_S,t.REPEAT),t.samplerParameteri(this.mainSamplerPW,t.TEXTURE_WRAP_T,t.REPEAT),t.samplerParameteri(this.mainSamplerPC,t.TEXTURE_MIN_FILTER,t.NEAREST_MIPMAP_NEAREST),t.samplerParameteri(this.mainSamplerPC,t.TEXTURE_MAG_FILTER,t.NEAREST),t.samplerParameteri(this.mainSamplerPC,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.samplerParameteri(this.mainSamplerPC,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE)}buildPositions(){const t=this.compWidth,e=this.compHeight,i=t+1,s=e+1,l=2/t,h=2/e,A=[];for(let n=0;n<s;n++){const d=n*h-1;for(let g=0;g<i;g++){const _=g*l-1;A.push(_,-d,0)}}const r=[];for(let n=0;n<e;n++)for(let d=0;d<t;d++){const g=d+i*n,_=d+i*(n+1),m=d+1+i*(n+1),x=d+1+i*n;r.push(g,_,x),r.push(_,m,x)}this.vertices=new Float32Array(A),this.indices=new Uint16Array(r)}updateGlobals(t){this.mesh_width=t.mesh_width,this.mesh_height=t.mesh_height,this.texsizeX=t.texsizeX,this.texsizeY=t.texsizeY,this.aspectx=t.aspectx,this.aspecty=t.aspecty,this.invAspectx=1/this.aspectx,this.invAspecty=1/this.aspecty,this.buildPositions()}createShader(t=""){let e,i;if(t.length===0)e=`float orient_horiz = mod(echo_orientation, 2.0);
                        float orient_x = (orient_horiz != 0.0) ? -1.0 : 1.0;
                        float orient_y = (echo_orientation >= 2.0) ? -1.0 : 1.0;
                        vec2 uv_echo = ((uv - 0.5) *
                                        (1.0 / echo_zoom) *
                                        vec2(orient_x, orient_y)) + 0.5;

                        ret = mix(texture(sampler_main, uv).rgb,
                                  texture(sampler_main, uv_echo).rgb,
                                  echo_alpha);

                        ret *= gammaAdj;

                        if(fShader >= 1.0) {
                          ret *= hue_shader;
                        } else if(fShader > 0.001) {
                          ret *= (1.0 - fShader) + (fShader * hue_shader);
                        }

                        if(brighten != 0) ret = sqrt(ret);
                        if(darken != 0) ret = ret*ret;
                        if(solarize != 0) ret = ret * (1.0 - ret) * 4.0;
                        if(invert != 0) ret = 1.0 - ret;`,i="";else{const h=o.default.getShaderParts(t);i=h[0],e=h[1]}e=e.replace(/texture2D/g,"texture"),e=e.replace(/texture3D/g,"texture"),this.userTextures=o.default.getUserSamplers(i),this.shaderProgram=this.gl.createProgram();const s=this.gl.createShader(this.gl.VERTEX_SHADER);this.gl.shaderSource(s,`
      #version 300 es
      const vec2 halfmad = vec2(0.5);
      in vec2 aPos;
      in vec4 aCompColor;
      out vec2 vUv;
      out vec4 vColor;
      void main(void) {
        gl_Position = vec4(aPos, 0.0, 1.0);
        vUv = aPos * halfmad + halfmad;
        vColor = aCompColor;
      }
      `.trim()),this.gl.compileShader(s);const l=this.gl.createShader(this.gl.FRAGMENT_SHADER);this.gl.shaderSource(l,`
      #version 300 es
      precision ${this.floatPrecision} float;
      precision highp int;
      precision mediump sampler2D;
      precision mediump sampler3D;

      vec3 lum(vec3 v){
          return vec3(dot(v, vec3(0.32,0.49,0.29)));
      }

      in vec2 vUv;
      in vec4 vColor;
      out vec4 fragColor;
      uniform sampler2D sampler_main;
      uniform sampler2D sampler_fw_main;
      uniform sampler2D sampler_fc_main;
      uniform sampler2D sampler_pw_main;
      uniform sampler2D sampler_pc_main;
      uniform sampler2D sampler_blur1;
      uniform sampler2D sampler_blur2;
      uniform sampler2D sampler_blur3;
      uniform sampler2D sampler_noise_lq;
      uniform sampler2D sampler_noise_lq_lite;
      uniform sampler2D sampler_noise_mq;
      uniform sampler2D sampler_noise_hq;
      uniform sampler2D sampler_pw_noise_lq;
      uniform sampler3D sampler_noisevol_lq;
      uniform sampler3D sampler_noisevol_hq;

      uniform float time;
      uniform float gammaAdj;
      uniform float echo_zoom;
      uniform float echo_alpha;
      uniform float echo_orientation;
      uniform int invert;
      uniform int brighten;
      uniform int darken;
      uniform int solarize;
      uniform vec2 resolution;
      uniform vec4 aspect;
      uniform vec4 texsize;
      uniform vec4 texsize_noise_lq;
      uniform vec4 texsize_noise_mq;
      uniform vec4 texsize_noise_hq;
      uniform vec4 texsize_noise_lq_lite;
      uniform vec4 texsize_noisevol_lq;
      uniform vec4 texsize_noisevol_hq;

      uniform float bass;
      uniform float mid;
      uniform float treb;
      uniform float vol;
      uniform float bass_att;
      uniform float mid_att;
      uniform float treb_att;
      uniform float vol_att;

      uniform float frame;
      uniform float fps;

      uniform vec4 _qa;
      uniform vec4 _qb;
      uniform vec4 _qc;
      uniform vec4 _qd;
      uniform vec4 _qe;
      uniform vec4 _qf;
      uniform vec4 _qg;
      uniform vec4 _qh;

      #define q1 _qa.x
      #define q2 _qa.y
      #define q3 _qa.z
      #define q4 _qa.w
      #define q5 _qb.x
      #define q6 _qb.y
      #define q7 _qb.z
      #define q8 _qb.w
      #define q9 _qc.x
      #define q10 _qc.y
      #define q11 _qc.z
      #define q12 _qc.w
      #define q13 _qd.x
      #define q14 _qd.y
      #define q15 _qd.z
      #define q16 _qd.w
      #define q17 _qe.x
      #define q18 _qe.y
      #define q19 _qe.z
      #define q20 _qe.w
      #define q21 _qf.x
      #define q22 _qf.y
      #define q23 _qf.z
      #define q24 _qf.w
      #define q25 _qg.x
      #define q26 _qg.y
      #define q27 _qg.z
      #define q28 _qg.w
      #define q29 _qh.x
      #define q30 _qh.y
      #define q31 _qh.z
      #define q32 _qh.w

      uniform vec4 slow_roam_cos;
      uniform vec4 roam_cos;
      uniform vec4 slow_roam_sin;
      uniform vec4 roam_sin;

      uniform float blur1_min;
      uniform float blur1_max;
      uniform float blur2_min;
      uniform float blur2_max;
      uniform float blur3_min;
      uniform float blur3_max;

      uniform float scale1;
      uniform float scale2;
      uniform float scale3;
      uniform float bias1;
      uniform float bias2;
      uniform float bias3;

      uniform vec4 rand_frame;
      uniform vec4 rand_preset;

      uniform float fShader;

      float PI = ${Math.PI};

      ${i}

      void main(void) {
        vec3 ret;
        vec2 uv = vUv;
        vec2 uv_orig = vUv;
        uv.y = 1.0 - uv.y;
        uv_orig.y = 1.0 - uv_orig.y;
        float rad = length(uv - 0.5);
        float ang = atan(uv.x - 0.5, uv.y - 0.5);
        vec3 hue_shader = vColor.rgb;

        ${e}

        fragColor = vec4(ret, vColor.a);
      }
      `.trim()),this.gl.compileShader(l),this.gl.attachShader(this.shaderProgram,s),this.gl.attachShader(this.shaderProgram,l),this.gl.linkProgram(this.shaderProgram),this.positionLocation=this.gl.getAttribLocation(this.shaderProgram,"aPos"),this.compColorLocation=this.gl.getAttribLocation(this.shaderProgram,"aCompColor"),this.textureLoc=this.gl.getUniformLocation(this.shaderProgram,"sampler_main"),this.textureFWLoc=this.gl.getUniformLocation(this.shaderProgram,"sampler_fw_main"),this.textureFCLoc=this.gl.getUniformLocation(this.shaderProgram,"sampler_fc_main"),this.texturePWLoc=this.gl.getUniformLocation(this.shaderProgram,"sampler_pw_main"),this.texturePCLoc=this.gl.getUniformLocation(this.shaderProgram,"sampler_pc_main"),this.blurTexture1Loc=this.gl.getUniformLocation(this.shaderProgram,"sampler_blur1"),this.blurTexture2Loc=this.gl.getUniformLocation(this.shaderProgram,"sampler_blur2"),this.blurTexture3Loc=this.gl.getUniformLocation(this.shaderProgram,"sampler_blur3"),this.noiseLQLoc=this.gl.getUniformLocation(this.shaderProgram,"sampler_noise_lq"),this.noiseMQLoc=this.gl.getUniformLocation(this.shaderProgram,"sampler_noise_mq"),this.noiseHQLoc=this.gl.getUniformLocation(this.shaderProgram,"sampler_noise_hq"),this.noiseLQLiteLoc=this.gl.getUniformLocation(this.shaderProgram,"sampler_noise_lq_lite"),this.noisePointLQLoc=this.gl.getUniformLocation(this.shaderProgram,"sampler_pw_noise_lq"),this.noiseVolLQLoc=this.gl.getUniformLocation(this.shaderProgram,"sampler_noisevol_lq"),this.noiseVolHQLoc=this.gl.getUniformLocation(this.shaderProgram,"sampler_noisevol_hq"),this.timeLoc=this.gl.getUniformLocation(this.shaderProgram,"time"),this.gammaAdjLoc=this.gl.getUniformLocation(this.shaderProgram,"gammaAdj"),this.echoZoomLoc=this.gl.getUniformLocation(this.shaderProgram,"echo_zoom"),this.echoAlphaLoc=this.gl.getUniformLocation(this.shaderProgram,"echo_alpha"),this.echoOrientationLoc=this.gl.getUniformLocation(this.shaderProgram,"echo_orientation"),this.invertLoc=this.gl.getUniformLocation(this.shaderProgram,"invert"),this.brightenLoc=this.gl.getUniformLocation(this.shaderProgram,"brighten"),this.darkenLoc=this.gl.getUniformLocation(this.shaderProgram,"darken"),this.solarizeLoc=this.gl.getUniformLocation(this.shaderProgram,"solarize"),this.texsizeLoc=this.gl.getUniformLocation(this.shaderProgram,"texsize"),this.texsizeNoiseLQLoc=this.gl.getUniformLocation(this.shaderProgram,"texsize_noise_lq"),this.texsizeNoiseMQLoc=this.gl.getUniformLocation(this.shaderProgram,"texsize_noise_mq"),this.texsizeNoiseHQLoc=this.gl.getUniformLocation(this.shaderProgram,"texsize_noise_hq"),this.texsizeNoiseLQLiteLoc=this.gl.getUniformLocation(this.shaderProgram,"texsize_noise_lq_lite"),this.texsizeNoiseVolLQLoc=this.gl.getUniformLocation(this.shaderProgram,"texsize_noisevol_lq"),this.texsizeNoiseVolHQLoc=this.gl.getUniformLocation(this.shaderProgram,"texsize_noisevol_hq"),this.resolutionLoc=this.gl.getUniformLocation(this.shaderProgram,"resolution"),this.aspectLoc=this.gl.getUniformLocation(this.shaderProgram,"aspect"),this.bassLoc=this.gl.getUniformLocation(this.shaderProgram,"bass"),this.midLoc=this.gl.getUniformLocation(this.shaderProgram,"mid"),this.trebLoc=this.gl.getUniformLocation(this.shaderProgram,"treb"),this.volLoc=this.gl.getUniformLocation(this.shaderProgram,"vol"),this.bassAttLoc=this.gl.getUniformLocation(this.shaderProgram,"bass_att"),this.midAttLoc=this.gl.getUniformLocation(this.shaderProgram,"mid_att"),this.trebAttLoc=this.gl.getUniformLocation(this.shaderProgram,"treb_att"),this.volAttLoc=this.gl.getUniformLocation(this.shaderProgram,"vol_att"),this.frameLoc=this.gl.getUniformLocation(this.shaderProgram,"frame"),this.fpsLoc=this.gl.getUniformLocation(this.shaderProgram,"fps"),this.blur1MinLoc=this.gl.getUniformLocation(this.shaderProgram,"blur1_min"),this.blur1MaxLoc=this.gl.getUniformLocation(this.shaderProgram,"blur1_max"),this.blur2MinLoc=this.gl.getUniformLocation(this.shaderProgram,"blur2_min"),this.blur2MaxLoc=this.gl.getUniformLocation(this.shaderProgram,"blur2_max"),this.blur3MinLoc=this.gl.getUniformLocation(this.shaderProgram,"blur3_min"),this.blur3MaxLoc=this.gl.getUniformLocation(this.shaderProgram,"blur3_max"),this.scale1Loc=this.gl.getUniformLocation(this.shaderProgram,"scale1"),this.scale2Loc=this.gl.getUniformLocation(this.shaderProgram,"scale2"),this.scale3Loc=this.gl.getUniformLocation(this.shaderProgram,"scale3"),this.bias1Loc=this.gl.getUniformLocation(this.shaderProgram,"bias1"),this.bias2Loc=this.gl.getUniformLocation(this.shaderProgram,"bias2"),this.bias3Loc=this.gl.getUniformLocation(this.shaderProgram,"bias3"),this.randPresetLoc=this.gl.getUniformLocation(this.shaderProgram,"rand_preset"),this.randFrameLoc=this.gl.getUniformLocation(this.shaderProgram,"rand_frame"),this.fShaderLoc=this.gl.getUniformLocation(this.shaderProgram,"fShader"),this.qaLoc=this.gl.getUniformLocation(this.shaderProgram,"_qa"),this.qbLoc=this.gl.getUniformLocation(this.shaderProgram,"_qb"),this.qcLoc=this.gl.getUniformLocation(this.shaderProgram,"_qc"),this.qdLoc=this.gl.getUniformLocation(this.shaderProgram,"_qd"),this.qeLoc=this.gl.getUniformLocation(this.shaderProgram,"_qe"),this.qfLoc=this.gl.getUniformLocation(this.shaderProgram,"_qf"),this.qgLoc=this.gl.getUniformLocation(this.shaderProgram,"_qg"),this.qhLoc=this.gl.getUniformLocation(this.shaderProgram,"_qh"),this.slowRoamCosLoc=this.gl.getUniformLocation(this.shaderProgram,"slow_roam_cos"),this.roamCosLoc=this.gl.getUniformLocation(this.shaderProgram,"roam_cos"),this.slowRoamSinLoc=this.gl.getUniformLocation(this.shaderProgram,"slow_roam_sin"),this.roamSinLoc=this.gl.getUniformLocation(this.shaderProgram,"roam_sin");for(let h=0;h<this.userTextures.length;h++){const A=this.userTextures[h];A.textureLoc=this.gl.getUniformLocation(this.shaderProgram,`sampler_${A.sampler}`)}}updateShader(t){this.createShader(t)}bindBlurVals(t,e){const i=t[0],s=t[1],l=t[2],h=e[0],A=e[1],r=e[2],n=h-i,d=i,g=A-s,_=s,m=r-l,x=l;this.gl.uniform1f(this.blur1MinLoc,i),this.gl.uniform1f(this.blur1MaxLoc,h),this.gl.uniform1f(this.blur2MinLoc,s),this.gl.uniform1f(this.blur2MaxLoc,A),this.gl.uniform1f(this.blur3MinLoc,l),this.gl.uniform1f(this.blur3MaxLoc,r),this.gl.uniform1f(this.scale1Loc,n),this.gl.uniform1f(this.scale2Loc,g),this.gl.uniform1f(this.scale3Loc,m),this.gl.uniform1f(this.bias1Loc,d),this.gl.uniform1f(this.bias2Loc,_),this.gl.uniform1f(this.bias3Loc,x)}static generateHueBase(t){const e=new Float32Array([1,1,1,1,1,1,1,1,1,1,1,1]);for(let i=0;i<4;i++){e[3*i+0]=.6+.3*Math.sin(30*t.time*.0143+3+21*i+t.rand_start[3]),e[3*i+1]=.6+.3*Math.sin(30*t.time*.0107+1+13*i+t.rand_start[1]),e[3*i+2]=.6+.3*Math.sin(30*t.time*.0129+6+9*i+t.rand_start[2]);const s=Math.max(e[3*i],e[3*i+1],e[3*i+2]);for(let l=0;l<3;l++)e[3*i+l]=e[3*i+l]/s,e[3*i+l]=.5+.5*e[3*i+l]}return e}generateCompColors(t,e,i){const s=a.generateHueBase(e),l=this.compWidth+1,h=this.compHeight+1,A=new Float32Array(l*h*4);let r=0;for(let n=0;n<h;n++)for(let d=0;d<l;d++){let g=d/this.compWidth,_=n/this.compHeight;const m=[1,1,1];for(let E=0;E<3;E++)m[E]=s[0+E]*g*_+s[3+E]*(1-g)*_+s[6+E]*g*(1-_)+s[9+E]*(1-g)*(1-_);let x=1;if(t){g*=this.mesh_width+1,_*=this.mesh_height+1,g=Math.clamp(g,0,this.mesh_width-1),_=Math.clamp(_,0,this.mesh_height-1);const E=Math.floor(g),P=Math.floor(_),M=g-E,X=_-P;x=i[4*(P*(this.mesh_width+1)+E)+3]*(1-M)*(1-X)+i[4*(P*(this.mesh_width+1)+(E+1))+3]*M*(1-X)+i[4*((P+1)*(this.mesh_width+1)+E)+3]*(1-M)*X+i[4*((P+1)*(this.mesh_width+1)+(E+1))+3]*M*X}A[r+0]=m[0],A[r+1]=m[1],A[r+2]=m[2],A[r+3]=x,r+=4}return A}renderQuadTexture(t,e,i,s,l,h,A,r,n,d){const g=this.generateCompColors(t,r,d);this.gl.useProgram(this.shaderProgram),this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER,this.indexBuf),this.gl.bufferData(this.gl.ELEMENT_ARRAY_BUFFER,this.indices,this.gl.STATIC_DRAW),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.positionVertexBuf),this.gl.bufferData(this.gl.ARRAY_BUFFER,this.vertices,this.gl.STATIC_DRAW),this.gl.vertexAttribPointer(this.positionLocation,3,this.gl.FLOAT,!1,0,0),this.gl.enableVertexAttribArray(this.positionLocation),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.compColorVertexBuf),this.gl.bufferData(this.gl.ARRAY_BUFFER,g,this.gl.STATIC_DRAW),this.gl.vertexAttribPointer(this.compColorLocation,4,this.gl.FLOAT,!1,0,0),this.gl.enableVertexAttribArray(this.compColorLocation);const _=r.wrap!==0?this.gl.REPEAT:this.gl.CLAMP_TO_EDGE;this.gl.samplerParameteri(this.mainSampler,this.gl.TEXTURE_WRAP_S,_),this.gl.samplerParameteri(this.mainSampler,this.gl.TEXTURE_WRAP_T,_),this.gl.activeTexture(this.gl.TEXTURE0),this.gl.bindTexture(this.gl.TEXTURE_2D,e),this.gl.bindSampler(0,this.mainSampler),this.gl.uniform1i(this.textureLoc,0),this.gl.activeTexture(this.gl.TEXTURE1),this.gl.bindTexture(this.gl.TEXTURE_2D,e),this.gl.bindSampler(1,this.mainSamplerFW),this.gl.uniform1i(this.textureFWLoc,1),this.gl.activeTexture(this.gl.TEXTURE2),this.gl.bindTexture(this.gl.TEXTURE_2D,e),this.gl.bindSampler(2,this.mainSamplerFC),this.gl.uniform1i(this.textureFCLoc,2),this.gl.activeTexture(this.gl.TEXTURE3),this.gl.bindTexture(this.gl.TEXTURE_2D,e),this.gl.bindSampler(3,this.mainSamplerPW),this.gl.uniform1i(this.texturePWLoc,3),this.gl.activeTexture(this.gl.TEXTURE4),this.gl.bindTexture(this.gl.TEXTURE_2D,e),this.gl.bindSampler(4,this.mainSamplerPC),this.gl.uniform1i(this.texturePCLoc,4),this.gl.activeTexture(this.gl.TEXTURE5),this.gl.bindTexture(this.gl.TEXTURE_2D,i),this.gl.uniform1i(this.blurTexture1Loc,5),this.gl.activeTexture(this.gl.TEXTURE6),this.gl.bindTexture(this.gl.TEXTURE_2D,s),this.gl.uniform1i(this.blurTexture2Loc,6),this.gl.activeTexture(this.gl.TEXTURE7),this.gl.bindTexture(this.gl.TEXTURE_2D,l),this.gl.uniform1i(this.blurTexture3Loc,7),this.gl.activeTexture(this.gl.TEXTURE8),this.gl.bindTexture(this.gl.TEXTURE_2D,this.noise.noiseTexLQ),this.gl.uniform1i(this.noiseLQLoc,8),this.gl.activeTexture(this.gl.TEXTURE9),this.gl.bindTexture(this.gl.TEXTURE_2D,this.noise.noiseTexMQ),this.gl.uniform1i(this.noiseMQLoc,9),this.gl.activeTexture(this.gl.TEXTURE10),this.gl.bindTexture(this.gl.TEXTURE_2D,this.noise.noiseTexHQ),this.gl.uniform1i(this.noiseHQLoc,10),this.gl.activeTexture(this.gl.TEXTURE11),this.gl.bindTexture(this.gl.TEXTURE_2D,this.noise.noiseTexLQLite),this.gl.uniform1i(this.noiseLQLiteLoc,11),this.gl.activeTexture(this.gl.TEXTURE12),this.gl.bindTexture(this.gl.TEXTURE_2D,this.noise.noiseTexLQ),this.gl.bindSampler(12,this.noise.noiseTexPointLQ),this.gl.uniform1i(this.noisePointLQLoc,12),this.gl.activeTexture(this.gl.TEXTURE13),this.gl.bindTexture(this.gl.TEXTURE_3D,this.noise.noiseTexVolLQ),this.gl.uniform1i(this.noiseVolLQLoc,13),this.gl.activeTexture(this.gl.TEXTURE14),this.gl.bindTexture(this.gl.TEXTURE_3D,this.noise.noiseTexVolHQ),this.gl.uniform1i(this.noiseVolHQLoc,14);for(let m=0;m<this.userTextures.length;m++){const x=this.userTextures[m];this.gl.activeTexture(this.gl.TEXTURE15+m),this.gl.bindTexture(this.gl.TEXTURE_2D,this.image.getTexture(x.sampler)),this.gl.uniform1i(x.textureLoc,15+m)}this.gl.uniform1f(this.timeLoc,r.time),this.gl.uniform1f(this.gammaAdjLoc,r.gammaadj),this.gl.uniform1f(this.echoZoomLoc,r.echo_zoom),this.gl.uniform1f(this.echoAlphaLoc,r.echo_alpha),this.gl.uniform1f(this.echoOrientationLoc,r.echo_orient),this.gl.uniform1i(this.invertLoc,r.invert),this.gl.uniform1i(this.brightenLoc,r.brighten),this.gl.uniform1i(this.darkenLoc,r.darken),this.gl.uniform1i(this.solarizeLoc,r.solarize),this.gl.uniform2fv(this.resolutionLoc,[this.texsizeX,this.texsizeY]),this.gl.uniform4fv(this.aspectLoc,[this.aspectx,this.aspecty,this.invAspectx,this.invAspecty]),this.gl.uniform4fv(this.texsizeLoc,new Float32Array([this.texsizeX,this.texsizeY,1/this.texsizeX,1/this.texsizeY])),this.gl.uniform4fv(this.texsizeNoiseLQLoc,[256,256,1/256,1/256]),this.gl.uniform4fv(this.texsizeNoiseMQLoc,[256,256,1/256,1/256]),this.gl.uniform4fv(this.texsizeNoiseHQLoc,[256,256,1/256,1/256]),this.gl.uniform4fv(this.texsizeNoiseLQLiteLoc,[32,32,1/32,1/32]),this.gl.uniform4fv(this.texsizeNoiseVolLQLoc,[32,32,1/32,1/32]),this.gl.uniform4fv(this.texsizeNoiseVolHQLoc,[32,32,1/32,1/32]),this.gl.uniform1f(this.bassLoc,r.bass),this.gl.uniform1f(this.midLoc,r.mid),this.gl.uniform1f(this.trebLoc,r.treb),this.gl.uniform1f(this.volLoc,(r.bass+r.mid+r.treb)/3),this.gl.uniform1f(this.bassAttLoc,r.bass_att),this.gl.uniform1f(this.midAttLoc,r.mid_att),this.gl.uniform1f(this.trebAttLoc,r.treb_att),this.gl.uniform1f(this.volAttLoc,(r.bass_att+r.mid_att+r.treb_att)/3),this.gl.uniform1f(this.frameLoc,r.frame),this.gl.uniform1f(this.fpsLoc,r.fps),this.gl.uniform4fv(this.randPresetLoc,r.rand_preset),this.gl.uniform4fv(this.randFrameLoc,new Float32Array([Math.random(),Math.random(),Math.random(),Math.random()])),this.gl.uniform1f(this.fShaderLoc,r.fshader),this.gl.uniform4fv(this.qaLoc,new Float32Array([n.q1||0,n.q2||0,n.q3||0,n.q4||0])),this.gl.uniform4fv(this.qbLoc,new Float32Array([n.q5||0,n.q6||0,n.q7||0,n.q8||0])),this.gl.uniform4fv(this.qcLoc,new Float32Array([n.q9||0,n.q10||0,n.q11||0,n.q12||0])),this.gl.uniform4fv(this.qdLoc,new Float32Array([n.q13||0,n.q14||0,n.q15||0,n.q16||0])),this.gl.uniform4fv(this.qeLoc,new Float32Array([n.q17||0,n.q18||0,n.q19||0,n.q20||0])),this.gl.uniform4fv(this.qfLoc,new Float32Array([n.q21||0,n.q22||0,n.q23||0,n.q24||0])),this.gl.uniform4fv(this.qgLoc,new Float32Array([n.q25||0,n.q26||0,n.q27||0,n.q28||0])),this.gl.uniform4fv(this.qhLoc,new Float32Array([n.q29||0,n.q30||0,n.q31||0,n.q32||0])),this.gl.uniform4fv(this.slowRoamCosLoc,[.5+.5*Math.cos(.005*r.time),.5+.5*Math.cos(.008*r.time),.5+.5*Math.cos(.013*r.time),.5+.5*Math.cos(.022*r.time)]),this.gl.uniform4fv(this.roamCosLoc,[.5+.5*Math.cos(.3*r.time),.5+.5*Math.cos(1.3*r.time),.5+.5*Math.cos(5*r.time),.5+.5*Math.cos(20*r.time)]),this.gl.uniform4fv(this.slowRoamSinLoc,[.5+.5*Math.sin(.005*r.time),.5+.5*Math.sin(.008*r.time),.5+.5*Math.sin(.013*r.time),.5+.5*Math.sin(.022*r.time)]),this.gl.uniform4fv(this.roamSinLoc,[.5+.5*Math.sin(.3*r.time),.5+.5*Math.sin(1.3*r.time),.5+.5*Math.sin(5*r.time),.5+.5*Math.sin(20*r.time)]),this.bindBlurVals(h,A),t?this.gl.blendFunc(this.gl.SRC_ALPHA,this.gl.ONE_MINUS_SRC_ALPHA):this.gl.disable(this.gl.BLEND),this.gl.drawElements(this.gl.TRIANGLES,this.indices.length,this.gl.UNSIGNED_SHORT,0),t||this.gl.enable(this.gl.BLEND)}}},"./src/rendering/shaders/output.js":function(W,f,u){u.r(f),u.d(f,"default",function(){return a});var o=u("./src/rendering/shaders/shaderUtils.js");class a{constructor(t,e){this.gl=t,this.textureRatio=e.textureRatio,this.texsizeX=e.texsizeX,this.texsizeY=e.texsizeY,this.positions=new Float32Array([-1,-1,1,-1,-1,1,1,1]),this.vertexBuf=this.gl.createBuffer(),this.floatPrecision=o.default.getFragmentFloatPrecision(this.gl),this.useFXAA()?this.createFXAAShader():this.createShader()}useFXAA(){return this.textureRatio<=1}updateGlobals(t){this.textureRatio=t.textureRatio,this.texsizeX=t.texsizeX,this.texsizeY=t.texsizeY,this.gl.deleteProgram(this.shaderProgram),this.useFXAA()?this.createFXAAShader():this.createShader()}createFXAAShader(){this.shaderProgram=this.gl.createProgram();const t=this.gl.createShader(this.gl.VERTEX_SHADER);this.gl.shaderSource(t,`#version 300 es
       const vec2 halfmad = vec2(0.5);
       in vec2 aPos;
       out vec2 v_rgbM;
       out vec2 v_rgbNW;
       out vec2 v_rgbNE;
       out vec2 v_rgbSW;
       out vec2 v_rgbSE;
       uniform vec4 texsize;
       void main(void) {
         gl_Position = vec4(aPos, 0.0, 1.0);

         v_rgbM = aPos * halfmad + halfmad;
         v_rgbNW = v_rgbM + (vec2(-1.0, -1.0) * texsize.zx);
         v_rgbNE = v_rgbM + (vec2(1.0, -1.0) * texsize.zx);
         v_rgbSW = v_rgbM + (vec2(-1.0, 1.0) * texsize.zx);
         v_rgbSE = v_rgbM + (vec2(1.0, 1.0) * texsize.zx);
       }`),this.gl.compileShader(t);const e=this.gl.createShader(this.gl.FRAGMENT_SHADER);this.gl.shaderSource(e,`#version 300 es
       precision ${this.floatPrecision} float;
       precision highp int;
       precision mediump sampler2D;

       in vec2 v_rgbM;
       in vec2 v_rgbNW;
       in vec2 v_rgbNE;
       in vec2 v_rgbSW;
       in vec2 v_rgbSE;
       out vec4 fragColor;
       uniform vec4 texsize;
       uniform sampler2D uTexture;

       #ifndef FXAA_REDUCE_MIN
         #define FXAA_REDUCE_MIN   (1.0/ 128.0)
       #endif
       #ifndef FXAA_REDUCE_MUL
         #define FXAA_REDUCE_MUL   (1.0 / 8.0)
       #endif
       #ifndef FXAA_SPAN_MAX
         #define FXAA_SPAN_MAX     8.0
       #endif

       void main(void) {
         vec4 color;
         vec3 rgbNW = textureLod(uTexture, v_rgbNW, 0.0).xyz;
         vec3 rgbNE = textureLod(uTexture, v_rgbNE, 0.0).xyz;
         vec3 rgbSW = textureLod(uTexture, v_rgbSW, 0.0).xyz;
         vec3 rgbSE = textureLod(uTexture, v_rgbSE, 0.0).xyz;
         vec3 rgbM  = textureLod(uTexture, v_rgbM, 0.0).xyz;
         vec3 luma = vec3(0.299, 0.587, 0.114);
         float lumaNW = dot(rgbNW, luma);
         float lumaNE = dot(rgbNE, luma);
         float lumaSW = dot(rgbSW, luma);
         float lumaSE = dot(rgbSE, luma);
         float lumaM  = dot(rgbM,  luma);
         float lumaMin = min(lumaM, min(min(lumaNW, lumaNE), min(lumaSW, lumaSE)));
         float lumaMax = max(lumaM, max(max(lumaNW, lumaNE), max(lumaSW, lumaSE)));

         mediump vec2 dir;
         dir.x = -((lumaNW + lumaNE) - (lumaSW + lumaSE));
         dir.y =  ((lumaNW + lumaSW) - (lumaNE + lumaSE));

         float dirReduce = max((lumaNW + lumaNE + lumaSW + lumaSE) *
                               (0.25 * FXAA_REDUCE_MUL), FXAA_REDUCE_MIN);

         float rcpDirMin = 1.0 / (min(abs(dir.x), abs(dir.y)) + dirReduce);
         dir = min(vec2(FXAA_SPAN_MAX, FXAA_SPAN_MAX),
                   max(vec2(-FXAA_SPAN_MAX, -FXAA_SPAN_MAX),
                   dir * rcpDirMin)) * texsize.zw;

         vec3 rgbA = 0.5 * (
             textureLod(uTexture, v_rgbM + dir * (1.0 / 3.0 - 0.5), 0.0).xyz +
             textureLod(uTexture, v_rgbM + dir * (2.0 / 3.0 - 0.5), 0.0).xyz);
         vec3 rgbB = rgbA * 0.5 + 0.25 * (
             textureLod(uTexture, v_rgbM + dir * -0.5, 0.0).xyz +
             textureLod(uTexture, v_rgbM + dir * 0.5, 0.0).xyz);

         float lumaB = dot(rgbB, luma);
         if ((lumaB < lumaMin) || (lumaB > lumaMax))
           color = vec4(rgbA, 1.0);
         else
           color = vec4(rgbB, 1.0);

         fragColor = color;
       }`),this.gl.compileShader(e),this.gl.attachShader(this.shaderProgram,t),this.gl.attachShader(this.shaderProgram,e),this.gl.linkProgram(this.shaderProgram),this.positionLocation=this.gl.getAttribLocation(this.shaderProgram,"aPos"),this.textureLoc=this.gl.getUniformLocation(this.shaderProgram,"uTexture"),this.texsizeLoc=this.gl.getUniformLocation(this.shaderProgram,"texsize")}createShader(){this.shaderProgram=this.gl.createProgram();const t=this.gl.createShader(this.gl.VERTEX_SHADER);this.gl.shaderSource(t,`#version 300 es
       const vec2 halfmad = vec2(0.5);
       in vec2 aPos;
       out vec2 uv;
       void main(void) {
         gl_Position = vec4(aPos, 0.0, 1.0);
         uv = aPos * halfmad + halfmad;
       }`),this.gl.compileShader(t);const e=this.gl.createShader(this.gl.FRAGMENT_SHADER);this.gl.shaderSource(e,`#version 300 es
       precision ${this.floatPrecision} float;
       precision highp int;
       precision mediump sampler2D;

       in vec2 uv;
       out vec4 fragColor;
       uniform sampler2D uTexture;

       void main(void) {
         fragColor = vec4(texture(uTexture, uv).rgb, 1.0);
       }`),this.gl.compileShader(e),this.gl.attachShader(this.shaderProgram,t),this.gl.attachShader(this.shaderProgram,e),this.gl.linkProgram(this.shaderProgram),this.positionLocation=this.gl.getAttribLocation(this.shaderProgram,"aPos"),this.textureLoc=this.gl.getUniformLocation(this.shaderProgram,"uTexture")}renderQuadTexture(t){this.gl.useProgram(this.shaderProgram),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.vertexBuf),this.gl.bufferData(this.gl.ARRAY_BUFFER,this.positions,this.gl.STATIC_DRAW),this.gl.vertexAttribPointer(this.positionLocation,2,this.gl.FLOAT,!1,0,0),this.gl.enableVertexAttribArray(this.positionLocation),this.gl.activeTexture(this.gl.TEXTURE0),this.gl.bindTexture(this.gl.TEXTURE_2D,t),this.gl.uniform1i(this.textureLoc,0),this.useFXAA()&&this.gl.uniform4fv(this.texsizeLoc,new Float32Array([this.texsizeX,this.texsizeY,1/this.texsizeX,1/this.texsizeY])),this.gl.blendFunc(this.gl.SRC_ALPHA,this.gl.ONE_MINUS_SRC_ALPHA),this.gl.drawArrays(this.gl.TRIANGLE_STRIP,0,4)}}},"./src/rendering/shaders/resample.js":function(W,f,u){u.r(f),u.d(f,"default",function(){return a});var o=u("./src/rendering/shaders/shaderUtils.js");class a{constructor(t){this.gl=t,this.positions=new Float32Array([-1,-1,1,-1,-1,1,1,1]),this.vertexBuf=this.gl.createBuffer(),this.floatPrecision=o.default.getFragmentFloatPrecision(this.gl),this.createShader()}createShader(){this.shaderProgram=this.gl.createProgram();const t=this.gl.createShader(this.gl.VERTEX_SHADER);this.gl.shaderSource(t,`#version 300 es
       const vec2 halfmad = vec2(0.5);
       in vec2 aPos;
       out vec2 uv;
       void main(void) {
         gl_Position = vec4(aPos, 0.0, 1.0);
         uv = aPos * halfmad + halfmad;
       }`),this.gl.compileShader(t);const e=this.gl.createShader(this.gl.FRAGMENT_SHADER);this.gl.shaderSource(e,`#version 300 es
       precision ${this.floatPrecision} float;
       precision highp int;
       precision mediump sampler2D;

       in vec2 uv;
       out vec4 fragColor;
       uniform sampler2D uTexture;

       void main(void) {
         fragColor = vec4(texture(uTexture, uv).rgb, 1.0);
       }`),this.gl.compileShader(e),this.gl.attachShader(this.shaderProgram,t),this.gl.attachShader(this.shaderProgram,e),this.gl.linkProgram(this.shaderProgram),this.positionLocation=this.gl.getAttribLocation(this.shaderProgram,"aPos"),this.textureLoc=this.gl.getUniformLocation(this.shaderProgram,"uTexture")}renderQuadTexture(t){this.gl.useProgram(this.shaderProgram),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.vertexBuf),this.gl.bufferData(this.gl.ARRAY_BUFFER,this.positions,this.gl.STATIC_DRAW),this.gl.vertexAttribPointer(this.positionLocation,2,this.gl.FLOAT,!1,0,0),this.gl.enableVertexAttribArray(this.positionLocation),this.gl.activeTexture(this.gl.TEXTURE0),this.gl.bindTexture(this.gl.TEXTURE_2D,t),this.gl.generateMipmap(this.gl.TEXTURE_2D),this.gl.uniform1i(this.textureLoc,0),this.gl.blendFunc(this.gl.SRC_ALPHA,this.gl.ONE_MINUS_SRC_ALPHA),this.gl.drawArrays(this.gl.TRIANGLE_STRIP,0,4)}}},"./src/rendering/shaders/shaderUtils.js":function(W,f,u){u.r(f),u.d(f,"default",function(){return c});const o=/uniform sampler2D sampler_(?:.+?);/g,a=/uniform sampler2D sampler_(.+?);/;class c{static getShaderParts(e){const i=e.indexOf("shader_body");if(e&&i>-1){const s=e.substring(0,i),l=e.substring(i),h=l.indexOf("{"),A=l.lastIndexOf("}");return[s,l.substring(h+1,A)]}return["",e]}static getFragmentFloatPrecision(e){return e.getShaderPrecisionFormat(e.FRAGMENT_SHADER,e.HIGH_FLOAT).precision>0?"highp":e.getShaderPrecisionFormat(e.FRAGMENT_SHADER,e.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}static getUserSamplers(e){const i=[],s=e.match(o);if(s&&s.length>0)for(let l=0;l<s.length;l++){const h=s[l].match(a);if(h&&h.length>0){const A=h[1];i.push({sampler:A})}}return i}}},"./src/rendering/shaders/warp.js":function(W,f,u){u.r(f),u.d(f,"default",function(){return a});var o=u("./src/rendering/shaders/shaderUtils.js");class a{constructor(t,e,i,s={}){this.gl=t,this.noise=e,this.image=i,this.texsizeX=s.texsizeX,this.texsizeY=s.texsizeY,this.mesh_width=s.mesh_width,this.mesh_height=s.mesh_height,this.aspectx=s.aspectx,this.aspecty=s.aspecty,this.invAspectx=1/this.aspectx,this.invAspecty=1/this.aspecty,this.buildPositions(),this.indexBuf=t.createBuffer(),this.positionVertexBuf=this.gl.createBuffer(),this.warpUvVertexBuf=this.gl.createBuffer(),this.warpColorVertexBuf=this.gl.createBuffer(),this.floatPrecision=o.default.getFragmentFloatPrecision(this.gl),this.createShader(),this.mainSampler=this.gl.createSampler(),this.mainSamplerFW=this.gl.createSampler(),this.mainSamplerFC=this.gl.createSampler(),this.mainSamplerPW=this.gl.createSampler(),this.mainSamplerPC=this.gl.createSampler(),t.samplerParameteri(this.mainSampler,t.TEXTURE_MIN_FILTER,t.LINEAR_MIPMAP_LINEAR),t.samplerParameteri(this.mainSampler,t.TEXTURE_MAG_FILTER,t.LINEAR),t.samplerParameteri(this.mainSampler,t.TEXTURE_WRAP_S,t.REPEAT),t.samplerParameteri(this.mainSampler,t.TEXTURE_WRAP_T,t.REPEAT),t.samplerParameteri(this.mainSamplerFW,t.TEXTURE_MIN_FILTER,t.LINEAR_MIPMAP_LINEAR),t.samplerParameteri(this.mainSamplerFW,t.TEXTURE_MAG_FILTER,t.LINEAR),t.samplerParameteri(this.mainSamplerFW,t.TEXTURE_WRAP_S,t.REPEAT),t.samplerParameteri(this.mainSamplerFW,t.TEXTURE_WRAP_T,t.REPEAT),t.samplerParameteri(this.mainSamplerFC,t.TEXTURE_MIN_FILTER,t.LINEAR_MIPMAP_LINEAR),t.samplerParameteri(this.mainSamplerFC,t.TEXTURE_MAG_FILTER,t.LINEAR),t.samplerParameteri(this.mainSamplerFC,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.samplerParameteri(this.mainSamplerFC,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),t.samplerParameteri(this.mainSamplerPW,t.TEXTURE_MIN_FILTER,t.NEAREST_MIPMAP_NEAREST),t.samplerParameteri(this.mainSamplerPW,t.TEXTURE_MAG_FILTER,t.NEAREST),t.samplerParameteri(this.mainSamplerPW,t.TEXTURE_WRAP_S,t.REPEAT),t.samplerParameteri(this.mainSamplerPW,t.TEXTURE_WRAP_T,t.REPEAT),t.samplerParameteri(this.mainSamplerPC,t.TEXTURE_MIN_FILTER,t.NEAREST_MIPMAP_NEAREST),t.samplerParameteri(this.mainSamplerPC,t.TEXTURE_MAG_FILTER,t.NEAREST),t.samplerParameteri(this.mainSamplerPC,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.samplerParameteri(this.mainSamplerPC,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE)}buildPositions(){const t=this.mesh_width,e=this.mesh_height,i=t+1,s=e+1,l=2/t,h=2/e,A=[];for(let n=0;n<s;n++){const d=n*h-1;for(let g=0;g<i;g++){const _=g*l-1;A.push(_,-d,0)}}const r=[];for(let n=0;n<e;n++)for(let d=0;d<t;d++){const g=d+i*n,_=d+i*(n+1),m=d+1+i*(n+1),x=d+1+i*n;r.push(g,_,x),r.push(_,m,x)}this.vertices=new Float32Array(A),this.indices=new Uint16Array(r)}updateGlobals(t){this.texsizeX=t.texsizeX,this.texsizeY=t.texsizeY,this.mesh_width=t.mesh_width,this.mesh_height=t.mesh_height,this.aspectx=t.aspectx,this.aspecty=t.aspecty,this.invAspectx=1/this.aspectx,this.invAspecty=1/this.aspecty,this.buildPositions()}createShader(t=""){let e,i;if(t.length===0)e="ret = texture(sampler_main, uv).rgb * decay;",i="";else{const h=o.default.getShaderParts(t);i=h[0],e=h[1]}e=e.replace(/texture2D/g,"texture"),e=e.replace(/texture3D/g,"texture"),this.userTextures=o.default.getUserSamplers(i),this.shaderProgram=this.gl.createProgram();const s=this.gl.createShader(this.gl.VERTEX_SHADER);this.gl.shaderSource(s,`
      #version 300 es
      precision ${this.floatPrecision} float;
      const vec2 halfmad = vec2(0.5);
      in vec2 aPos;
      in vec2 aWarpUv;
      in vec4 aWarpColor;
      out vec2 uv;
      out vec2 uv_orig;
      out vec4 vColor;
      void main(void) {
        gl_Position = vec4(aPos, 0.0, 1.0);
        uv_orig = aPos * halfmad + halfmad;
        uv = aWarpUv;
        vColor = aWarpColor;
      }
      `.trim()),this.gl.compileShader(s);const l=this.gl.createShader(this.gl.FRAGMENT_SHADER);this.gl.shaderSource(l,`
      #version 300 es
      precision ${this.floatPrecision} float;
      precision highp int;
      precision mediump sampler2D;
      precision mediump sampler3D;

      in vec2 uv;
      in vec2 uv_orig;
      in vec4 vColor;
      out vec4 fragColor;
      uniform sampler2D sampler_main;
      uniform sampler2D sampler_fw_main;
      uniform sampler2D sampler_fc_main;
      uniform sampler2D sampler_pw_main;
      uniform sampler2D sampler_pc_main;
      uniform sampler2D sampler_blur1;
      uniform sampler2D sampler_blur2;
      uniform sampler2D sampler_blur3;
      uniform sampler2D sampler_noise_lq;
      uniform sampler2D sampler_noise_lq_lite;
      uniform sampler2D sampler_noise_mq;
      uniform sampler2D sampler_noise_hq;
      uniform sampler2D sampler_pw_noise_lq;
      uniform sampler3D sampler_noisevol_lq;
      uniform sampler3D sampler_noisevol_hq;
      uniform float time;
      uniform float decay;
      uniform vec2 resolution;
      uniform vec4 aspect;
      uniform vec4 texsize;
      uniform vec4 texsize_noise_lq;
      uniform vec4 texsize_noise_mq;
      uniform vec4 texsize_noise_hq;
      uniform vec4 texsize_noise_lq_lite;
      uniform vec4 texsize_noisevol_lq;
      uniform vec4 texsize_noisevol_hq;

      uniform float bass;
      uniform float mid;
      uniform float treb;
      uniform float vol;
      uniform float bass_att;
      uniform float mid_att;
      uniform float treb_att;
      uniform float vol_att;

      uniform float frame;
      uniform float fps;

      uniform vec4 _qa;
      uniform vec4 _qb;
      uniform vec4 _qc;
      uniform vec4 _qd;
      uniform vec4 _qe;
      uniform vec4 _qf;
      uniform vec4 _qg;
      uniform vec4 _qh;

      #define q1 _qa.x
      #define q2 _qa.y
      #define q3 _qa.z
      #define q4 _qa.w
      #define q5 _qb.x
      #define q6 _qb.y
      #define q7 _qb.z
      #define q8 _qb.w
      #define q9 _qc.x
      #define q10 _qc.y
      #define q11 _qc.z
      #define q12 _qc.w
      #define q13 _qd.x
      #define q14 _qd.y
      #define q15 _qd.z
      #define q16 _qd.w
      #define q17 _qe.x
      #define q18 _qe.y
      #define q19 _qe.z
      #define q20 _qe.w
      #define q21 _qf.x
      #define q22 _qf.y
      #define q23 _qf.z
      #define q24 _qf.w
      #define q25 _qg.x
      #define q26 _qg.y
      #define q27 _qg.z
      #define q28 _qg.w
      #define q29 _qh.x
      #define q30 _qh.y
      #define q31 _qh.z
      #define q32 _qh.w

      uniform vec4 slow_roam_cos;
      uniform vec4 roam_cos;
      uniform vec4 slow_roam_sin;
      uniform vec4 roam_sin;

      uniform float blur1_min;
      uniform float blur1_max;
      uniform float blur2_min;
      uniform float blur2_max;
      uniform float blur3_min;
      uniform float blur3_max;

      uniform float scale1;
      uniform float scale2;
      uniform float scale3;
      uniform float bias1;
      uniform float bias2;
      uniform float bias3;

      uniform vec4 rand_frame;
      uniform vec4 rand_preset;

      float PI = ${Math.PI};

      ${i}

      void main(void) {
        vec3 ret;
        float rad = length(uv_orig - 0.5);
        float ang = atan(uv_orig.x - 0.5, uv_orig.y - 0.5);

        ${e}

        fragColor = vec4(ret, 1.0) * vColor;
      }
      `.trim()),this.gl.compileShader(l),this.gl.attachShader(this.shaderProgram,s),this.gl.attachShader(this.shaderProgram,l),this.gl.linkProgram(this.shaderProgram),this.positionLocation=this.gl.getAttribLocation(this.shaderProgram,"aPos"),this.warpUvLocation=this.gl.getAttribLocation(this.shaderProgram,"aWarpUv"),this.warpColorLocation=this.gl.getAttribLocation(this.shaderProgram,"aWarpColor"),this.textureLoc=this.gl.getUniformLocation(this.shaderProgram,"sampler_main"),this.textureFWLoc=this.gl.getUniformLocation(this.shaderProgram,"sampler_fw_main"),this.textureFCLoc=this.gl.getUniformLocation(this.shaderProgram,"sampler_fc_main"),this.texturePWLoc=this.gl.getUniformLocation(this.shaderProgram,"sampler_pw_main"),this.texturePCLoc=this.gl.getUniformLocation(this.shaderProgram,"sampler_pc_main"),this.blurTexture1Loc=this.gl.getUniformLocation(this.shaderProgram,"sampler_blur1"),this.blurTexture2Loc=this.gl.getUniformLocation(this.shaderProgram,"sampler_blur2"),this.blurTexture3Loc=this.gl.getUniformLocation(this.shaderProgram,"sampler_blur3"),this.noiseLQLoc=this.gl.getUniformLocation(this.shaderProgram,"sampler_noise_lq"),this.noiseMQLoc=this.gl.getUniformLocation(this.shaderProgram,"sampler_noise_mq"),this.noiseHQLoc=this.gl.getUniformLocation(this.shaderProgram,"sampler_noise_hq"),this.noiseLQLiteLoc=this.gl.getUniformLocation(this.shaderProgram,"sampler_noise_lq_lite"),this.noisePointLQLoc=this.gl.getUniformLocation(this.shaderProgram,"sampler_pw_noise_lq"),this.noiseVolLQLoc=this.gl.getUniformLocation(this.shaderProgram,"sampler_noisevol_lq"),this.noiseVolHQLoc=this.gl.getUniformLocation(this.shaderProgram,"sampler_noisevol_hq"),this.decayLoc=this.gl.getUniformLocation(this.shaderProgram,"decay"),this.texsizeLoc=this.gl.getUniformLocation(this.shaderProgram,"texsize"),this.texsizeNoiseLQLoc=this.gl.getUniformLocation(this.shaderProgram,"texsize_noise_lq"),this.texsizeNoiseMQLoc=this.gl.getUniformLocation(this.shaderProgram,"texsize_noise_mq"),this.texsizeNoiseHQLoc=this.gl.getUniformLocation(this.shaderProgram,"texsize_noise_hq"),this.texsizeNoiseLQLiteLoc=this.gl.getUniformLocation(this.shaderProgram,"texsize_noise_lq_lite"),this.texsizeNoiseVolLQLoc=this.gl.getUniformLocation(this.shaderProgram,"texsize_noisevol_lq"),this.texsizeNoiseVolHQLoc=this.gl.getUniformLocation(this.shaderProgram,"texsize_noisevol_hq"),this.resolutionLoc=this.gl.getUniformLocation(this.shaderProgram,"resolution"),this.aspectLoc=this.gl.getUniformLocation(this.shaderProgram,"aspect"),this.bassLoc=this.gl.getUniformLocation(this.shaderProgram,"bass"),this.midLoc=this.gl.getUniformLocation(this.shaderProgram,"mid"),this.trebLoc=this.gl.getUniformLocation(this.shaderProgram,"treb"),this.volLoc=this.gl.getUniformLocation(this.shaderProgram,"vol"),this.bassAttLoc=this.gl.getUniformLocation(this.shaderProgram,"bass_att"),this.midAttLoc=this.gl.getUniformLocation(this.shaderProgram,"mid_att"),this.trebAttLoc=this.gl.getUniformLocation(this.shaderProgram,"treb_att"),this.volAttLoc=this.gl.getUniformLocation(this.shaderProgram,"vol_att"),this.timeLoc=this.gl.getUniformLocation(this.shaderProgram,"time"),this.frameLoc=this.gl.getUniformLocation(this.shaderProgram,"frame"),this.fpsLoc=this.gl.getUniformLocation(this.shaderProgram,"fps"),this.blur1MinLoc=this.gl.getUniformLocation(this.shaderProgram,"blur1_min"),this.blur1MaxLoc=this.gl.getUniformLocation(this.shaderProgram,"blur1_max"),this.blur2MinLoc=this.gl.getUniformLocation(this.shaderProgram,"blur2_min"),this.blur2MaxLoc=this.gl.getUniformLocation(this.shaderProgram,"blur2_max"),this.blur3MinLoc=this.gl.getUniformLocation(this.shaderProgram,"blur3_min"),this.blur3MaxLoc=this.gl.getUniformLocation(this.shaderProgram,"blur3_max"),this.scale1Loc=this.gl.getUniformLocation(this.shaderProgram,"scale1"),this.scale2Loc=this.gl.getUniformLocation(this.shaderProgram,"scale2"),this.scale3Loc=this.gl.getUniformLocation(this.shaderProgram,"scale3"),this.bias1Loc=this.gl.getUniformLocation(this.shaderProgram,"bias1"),this.bias2Loc=this.gl.getUniformLocation(this.shaderProgram,"bias2"),this.bias3Loc=this.gl.getUniformLocation(this.shaderProgram,"bias3"),this.randPresetLoc=this.gl.getUniformLocation(this.shaderProgram,"rand_preset"),this.randFrameLoc=this.gl.getUniformLocation(this.shaderProgram,"rand_frame"),this.qaLoc=this.gl.getUniformLocation(this.shaderProgram,"_qa"),this.qbLoc=this.gl.getUniformLocation(this.shaderProgram,"_qb"),this.qcLoc=this.gl.getUniformLocation(this.shaderProgram,"_qc"),this.qdLoc=this.gl.getUniformLocation(this.shaderProgram,"_qd"),this.qeLoc=this.gl.getUniformLocation(this.shaderProgram,"_qe"),this.qfLoc=this.gl.getUniformLocation(this.shaderProgram,"_qf"),this.qgLoc=this.gl.getUniformLocation(this.shaderProgram,"_qg"),this.qhLoc=this.gl.getUniformLocation(this.shaderProgram,"_qh"),this.slowRoamCosLoc=this.gl.getUniformLocation(this.shaderProgram,"slow_roam_cos"),this.roamCosLoc=this.gl.getUniformLocation(this.shaderProgram,"roam_cos"),this.slowRoamSinLoc=this.gl.getUniformLocation(this.shaderProgram,"slow_roam_sin"),this.roamSinLoc=this.gl.getUniformLocation(this.shaderProgram,"roam_sin");for(let h=0;h<this.userTextures.length;h++){const A=this.userTextures[h];A.textureLoc=this.gl.getUniformLocation(this.shaderProgram,`sampler_${A.sampler}`)}}updateShader(t){this.createShader(t)}bindBlurVals(t,e){const i=t[0],s=t[1],l=t[2],h=e[0],A=e[1],r=e[2],n=h-i,d=i,g=A-s,_=s,m=r-l,x=l;this.gl.uniform1f(this.blur1MinLoc,i),this.gl.uniform1f(this.blur1MaxLoc,h),this.gl.uniform1f(this.blur2MinLoc,s),this.gl.uniform1f(this.blur2MaxLoc,A),this.gl.uniform1f(this.blur3MinLoc,l),this.gl.uniform1f(this.blur3MaxLoc,r),this.gl.uniform1f(this.scale1Loc,n),this.gl.uniform1f(this.scale2Loc,g),this.gl.uniform1f(this.scale3Loc,m),this.gl.uniform1f(this.bias1Loc,d),this.gl.uniform1f(this.bias2Loc,_),this.gl.uniform1f(this.bias3Loc,x)}renderQuadTexture(t,e,i,s,l,h,A,r,n,d,g){this.gl.useProgram(this.shaderProgram),this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER,this.indexBuf),this.gl.bufferData(this.gl.ELEMENT_ARRAY_BUFFER,this.indices,this.gl.STATIC_DRAW),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.positionVertexBuf),this.gl.bufferData(this.gl.ARRAY_BUFFER,this.vertices,this.gl.STATIC_DRAW),this.gl.vertexAttribPointer(this.positionLocation,3,this.gl.FLOAT,!1,0,0),this.gl.enableVertexAttribArray(this.positionLocation),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.warpUvVertexBuf),this.gl.bufferData(this.gl.ARRAY_BUFFER,d,this.gl.STATIC_DRAW),this.gl.vertexAttribPointer(this.warpUvLocation,2,this.gl.FLOAT,!1,0,0),this.gl.enableVertexAttribArray(this.warpUvLocation),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.warpColorVertexBuf),this.gl.bufferData(this.gl.ARRAY_BUFFER,g,this.gl.STATIC_DRAW),this.gl.vertexAttribPointer(this.warpColorLocation,4,this.gl.FLOAT,!1,0,0),this.gl.enableVertexAttribArray(this.warpColorLocation);const _=r.wrap!==0?this.gl.REPEAT:this.gl.CLAMP_TO_EDGE;this.gl.samplerParameteri(this.mainSampler,this.gl.TEXTURE_WRAP_S,_),this.gl.samplerParameteri(this.mainSampler,this.gl.TEXTURE_WRAP_T,_),this.gl.activeTexture(this.gl.TEXTURE0),this.gl.bindTexture(this.gl.TEXTURE_2D,e),this.gl.bindSampler(0,this.mainSampler),this.gl.uniform1i(this.textureLoc,0),this.gl.activeTexture(this.gl.TEXTURE1),this.gl.bindTexture(this.gl.TEXTURE_2D,e),this.gl.bindSampler(1,this.mainSamplerFW),this.gl.uniform1i(this.textureFWLoc,1),this.gl.activeTexture(this.gl.TEXTURE2),this.gl.bindTexture(this.gl.TEXTURE_2D,e),this.gl.bindSampler(2,this.mainSamplerFC),this.gl.uniform1i(this.textureFCLoc,2),this.gl.activeTexture(this.gl.TEXTURE3),this.gl.bindTexture(this.gl.TEXTURE_2D,e),this.gl.bindSampler(3,this.mainSamplerPW),this.gl.uniform1i(this.texturePWLoc,3),this.gl.activeTexture(this.gl.TEXTURE4),this.gl.bindTexture(this.gl.TEXTURE_2D,e),this.gl.bindSampler(4,this.mainSamplerPC),this.gl.uniform1i(this.texturePCLoc,4),this.gl.activeTexture(this.gl.TEXTURE5),this.gl.bindTexture(this.gl.TEXTURE_2D,i),this.gl.uniform1i(this.blurTexture1Loc,5),this.gl.activeTexture(this.gl.TEXTURE6),this.gl.bindTexture(this.gl.TEXTURE_2D,s),this.gl.uniform1i(this.blurTexture2Loc,6),this.gl.activeTexture(this.gl.TEXTURE7),this.gl.bindTexture(this.gl.TEXTURE_2D,l),this.gl.uniform1i(this.blurTexture3Loc,7),this.gl.activeTexture(this.gl.TEXTURE8),this.gl.bindTexture(this.gl.TEXTURE_2D,this.noise.noiseTexLQ),this.gl.uniform1i(this.noiseLQLoc,8),this.gl.activeTexture(this.gl.TEXTURE9),this.gl.bindTexture(this.gl.TEXTURE_2D,this.noise.noiseTexMQ),this.gl.uniform1i(this.noiseMQLoc,9),this.gl.activeTexture(this.gl.TEXTURE10),this.gl.bindTexture(this.gl.TEXTURE_2D,this.noise.noiseTexHQ),this.gl.uniform1i(this.noiseHQLoc,10),this.gl.activeTexture(this.gl.TEXTURE11),this.gl.bindTexture(this.gl.TEXTURE_2D,this.noise.noiseTexLQLite),this.gl.uniform1i(this.noiseLQLiteLoc,11),this.gl.activeTexture(this.gl.TEXTURE12),this.gl.bindTexture(this.gl.TEXTURE_2D,this.noise.noiseTexLQ),this.gl.bindSampler(12,this.noise.noiseTexPointLQ),this.gl.uniform1i(this.noisePointLQLoc,12),this.gl.activeTexture(this.gl.TEXTURE13),this.gl.bindTexture(this.gl.TEXTURE_3D,this.noise.noiseTexVolLQ),this.gl.uniform1i(this.noiseVolLQLoc,13),this.gl.activeTexture(this.gl.TEXTURE14),this.gl.bindTexture(this.gl.TEXTURE_3D,this.noise.noiseTexVolHQ),this.gl.uniform1i(this.noiseVolHQLoc,14);for(let m=0;m<this.userTextures.length;m++){const x=this.userTextures[m];this.gl.activeTexture(this.gl.TEXTURE15+m),this.gl.bindTexture(this.gl.TEXTURE_2D,this.image.getTexture(x.sampler)),this.gl.uniform1i(x.textureLoc,15+m)}this.gl.uniform1f(this.decayLoc,r.decay),this.gl.uniform2fv(this.resolutionLoc,[this.texsizeX,this.texsizeY]),this.gl.uniform4fv(this.aspectLoc,[this.aspectx,this.aspecty,this.invAspectx,this.invAspecty]),this.gl.uniform4fv(this.texsizeLoc,[this.texsizeX,this.texsizeY,1/this.texsizeX,1/this.texsizeY]),this.gl.uniform4fv(this.texsizeNoiseLQLoc,[256,256,1/256,1/256]),this.gl.uniform4fv(this.texsizeNoiseMQLoc,[256,256,1/256,1/256]),this.gl.uniform4fv(this.texsizeNoiseHQLoc,[256,256,1/256,1/256]),this.gl.uniform4fv(this.texsizeNoiseLQLiteLoc,[32,32,1/32,1/32]),this.gl.uniform4fv(this.texsizeNoiseVolLQLoc,[32,32,1/32,1/32]),this.gl.uniform4fv(this.texsizeNoiseVolHQLoc,[32,32,1/32,1/32]),this.gl.uniform1f(this.bassLoc,r.bass),this.gl.uniform1f(this.midLoc,r.mid),this.gl.uniform1f(this.trebLoc,r.treb),this.gl.uniform1f(this.volLoc,(r.bass+r.mid+r.treb)/3),this.gl.uniform1f(this.bassAttLoc,r.bass_att),this.gl.uniform1f(this.midAttLoc,r.mid_att),this.gl.uniform1f(this.trebAttLoc,r.treb_att),this.gl.uniform1f(this.volAttLoc,(r.bass_att+r.mid_att+r.treb_att)/3),this.gl.uniform1f(this.timeLoc,r.time),this.gl.uniform1f(this.frameLoc,r.frame),this.gl.uniform1f(this.fpsLoc,r.fps),this.gl.uniform4fv(this.randPresetLoc,r.rand_preset),this.gl.uniform4fv(this.randFrameLoc,new Float32Array([Math.random(),Math.random(),Math.random(),Math.random()])),this.gl.uniform4fv(this.qaLoc,new Float32Array([n.q1||0,n.q2||0,n.q3||0,n.q4||0])),this.gl.uniform4fv(this.qbLoc,new Float32Array([n.q5||0,n.q6||0,n.q7||0,n.q8||0])),this.gl.uniform4fv(this.qcLoc,new Float32Array([n.q9||0,n.q10||0,n.q11||0,n.q12||0])),this.gl.uniform4fv(this.qdLoc,new Float32Array([n.q13||0,n.q14||0,n.q15||0,n.q16||0])),this.gl.uniform4fv(this.qeLoc,new Float32Array([n.q17||0,n.q18||0,n.q19||0,n.q20||0])),this.gl.uniform4fv(this.qfLoc,new Float32Array([n.q21||0,n.q22||0,n.q23||0,n.q24||0])),this.gl.uniform4fv(this.qgLoc,new Float32Array([n.q25||0,n.q26||0,n.q27||0,n.q28||0])),this.gl.uniform4fv(this.qhLoc,new Float32Array([n.q29||0,n.q30||0,n.q31||0,n.q32||0])),this.gl.uniform4fv(this.slowRoamCosLoc,[.5+.5*Math.cos(.005*r.time),.5+.5*Math.cos(.008*r.time),.5+.5*Math.cos(.013*r.time),.5+.5*Math.cos(.022*r.time)]),this.gl.uniform4fv(this.roamCosLoc,[.5+.5*Math.cos(.3*r.time),.5+.5*Math.cos(1.3*r.time),.5+.5*Math.cos(5*r.time),.5+.5*Math.cos(20*r.time)]),this.gl.uniform4fv(this.slowRoamSinLoc,[.5+.5*Math.sin(.005*r.time),.5+.5*Math.sin(.008*r.time),.5+.5*Math.sin(.013*r.time),.5+.5*Math.sin(.022*r.time)]),this.gl.uniform4fv(this.roamSinLoc,[.5+.5*Math.sin(.3*r.time),.5+.5*Math.sin(1.3*r.time),.5+.5*Math.sin(5*r.time),.5+.5*Math.sin(20*r.time)]),this.bindBlurVals(h,A),t?this.gl.blendFunc(this.gl.SRC_ALPHA,this.gl.ONE_MINUS_SRC_ALPHA):this.gl.disable(this.gl.BLEND),this.gl.drawElements(this.gl.TRIANGLES,this.indices.length,this.gl.UNSIGNED_SHORT,0),t||this.gl.enable(this.gl.BLEND)}}},"./src/rendering/shapes/customShape.js":function(W,f,u){u.r(f),u.d(f,"default",function(){return c});var o=u("./src/utils.js"),a=u("./src/rendering/shaders/shaderUtils.js");class c{constructor(e,i,s){this.index=e,this.gl=i,this.positions=new Float32Array(309),this.colors=new Float32Array(412),this.uvs=new Float32Array(206),this.borderPositions=new Float32Array(306),this.texsizeX=s.texsizeX,this.texsizeY=s.texsizeY,this.mesh_width=s.mesh_width,this.mesh_height=s.mesh_height,this.aspectx=s.aspectx,this.aspecty=s.aspecty,this.invAspectx=1/this.aspectx,this.invAspecty=1/this.aspecty,this.positionVertexBuf=this.gl.createBuffer(),this.colorVertexBuf=this.gl.createBuffer(),this.uvVertexBuf=this.gl.createBuffer(),this.borderPositionVertexBuf=this.gl.createBuffer(),this.floatPrecision=a.default.getFragmentFloatPrecision(this.gl),this.createShader(),this.createBorderShader(),this.mainSampler=this.gl.createSampler(),i.samplerParameteri(this.mainSampler,i.TEXTURE_MIN_FILTER,i.LINEAR_MIPMAP_LINEAR),i.samplerParameteri(this.mainSampler,i.TEXTURE_MAG_FILTER,i.LINEAR),i.samplerParameteri(this.mainSampler,i.TEXTURE_WRAP_S,i.REPEAT),i.samplerParameteri(this.mainSampler,i.TEXTURE_WRAP_T,i.REPEAT)}updateGlobals(e){this.texsizeX=e.texsizeX,this.texsizeY=e.texsizeY,this.mesh_width=e.mesh_width,this.mesh_height=e.mesh_height,this.aspectx=e.aspectx,this.aspecty=e.aspecty,this.invAspectx=1/this.aspectx,this.invAspecty=1/this.aspecty}createShader(){this.shaderProgram=this.gl.createProgram();const e=this.gl.createShader(this.gl.VERTEX_SHADER);this.gl.shaderSource(e,`
      #version 300 es
      in vec3 aPos;
      in vec4 aColor;
      in vec2 aUv;
      out vec4 vColor;
      out vec2 vUv;
      void main(void) {
        vColor = aColor;
        vUv = aUv;
        gl_Position = vec4(aPos, 1.0);
      }
      `.trim()),this.gl.compileShader(e);const i=this.gl.createShader(this.gl.FRAGMENT_SHADER);this.gl.shaderSource(i,`
      #version 300 es
      precision ${this.floatPrecision} float;
      precision highp int;
      precision mediump sampler2D;
      uniform sampler2D uTexture;
      uniform float uTextured;
      in vec4 vColor;
      in vec2 vUv;
      out vec4 fragColor;
      void main(void) {
        if (uTextured != 0.0) {
          fragColor = texture(uTexture, vUv) * vColor;
        } else {
          fragColor = vColor;
        }
      }
      `.trim()),this.gl.compileShader(i),this.gl.attachShader(this.shaderProgram,e),this.gl.attachShader(this.shaderProgram,i),this.gl.linkProgram(this.shaderProgram),this.aPosLocation=this.gl.getAttribLocation(this.shaderProgram,"aPos"),this.aColorLocation=this.gl.getAttribLocation(this.shaderProgram,"aColor"),this.aUvLocation=this.gl.getAttribLocation(this.shaderProgram,"aUv"),this.texturedLoc=this.gl.getUniformLocation(this.shaderProgram,"uTextured"),this.textureLoc=this.gl.getUniformLocation(this.shaderProgram,"uTexture")}createBorderShader(){this.borderShaderProgram=this.gl.createProgram();const e=this.gl.createShader(this.gl.VERTEX_SHADER);this.gl.shaderSource(e,`
      #version 300 es
      in vec3 aBorderPos;
      uniform vec2 thickOffset;
      void main(void) {
        gl_Position = vec4(aBorderPos +
                            vec3(thickOffset, 0.0), 1.0);
      }
      `.trim()),this.gl.compileShader(e);const i=this.gl.createShader(this.gl.FRAGMENT_SHADER);this.gl.shaderSource(i,`
      #version 300 es
      precision ${this.floatPrecision} float;
      precision highp int;
      precision mediump sampler2D;
      out vec4 fragColor;
      uniform vec4 uBorderColor;
      void main(void) {
        fragColor = uBorderColor;
      }
      `.trim()),this.gl.compileShader(i),this.gl.attachShader(this.borderShaderProgram,e),this.gl.attachShader(this.borderShaderProgram,i),this.gl.linkProgram(this.borderShaderProgram),this.aBorderPosLoc=this.gl.getAttribLocation(this.borderShaderProgram,"aBorderPos"),this.uBorderColorLoc=this.gl.getUniformLocation(this.borderShaderProgram,"uBorderColor"),this.thickOffsetLoc=this.gl.getUniformLocation(this.shaderProgram,"thickOffset")}drawCustomShape(e,i,s,l,h){if(l.baseVals.enabled!==0)if(s.preset.useWASM){this.setupShapeBuffers(s.preset.globalPools.perFrame.wrap.value);const A=s.preset.shapes[this.index].baseVals,r=s.preset.globalPools[`shapePerFrame${this.index}`];o.default.setWasm(r,i,s.globalKeys),s.preset.shapes[this.index].frame_eqs||s.preset.restore_qs(),o.default.setWasm(r,s.mdVSTShapeInits[this.index],s.ts),s.preset.save_ts(),r.x.value=A.x,r.y.value=A.y,r.rad.value=A.rad,r.ang.value=A.ang,r.r.value=A.r,r.g.value=A.g,r.b.value=A.b,r.a.value=A.a,r.r2.value=A.r2,r.g2.value=A.g2,r.b2.value=A.b2,r.a2.value=A.a2,r.border_r.value=A.border_r,r.border_g.value=A.border_g,r.border_b.value=A.border_b,r.border_a.value=A.border_a,r.thickoutline.value=A.thickoutline,r.textured.value=A.textured,r.tex_zoom.value=A.tex_zoom,r.tex_ang.value=A.tex_ang,r.additive.value=A.additive,s.preset.shapes[this.index].frame_eqs_save();const n=Math.clamp(A.num_inst,1,1024);for(let d=0;d<n;d++){r.instance.value=d,s.preset.shapes[this.index].frame_eqs&&(s.preset.shapes[this.index].frame_eqs_restore(),s.preset.restore_qs(),s.preset.restore_ts(),s.preset.shapes[this.index].frame_eqs());let g=r.sides.value;g=Math.clamp(g,3,100),g=Math.floor(g);const _=r.rad.value,m=r.ang.value,x=2*r.x.value-1,E=-2*r.y.value+1,P=r.r.value,M=r.g.value,X=r.b.value,U=r.a.value,L=r.r2.value,T=r.g2.value,b=r.b2.value,v=r.a2.value,p=r.border_r.value,I=r.border_g.value,y=r.border_b.value,w=r.border_a.value;this.borderColor=[p,I,y,w*e];const S=r.thickoutline.value,R=r.textured.value,D=r.tex_zoom.value,C=r.tex_ang.value,O=r.additive.value,F=this.borderColor[3]>0,G=Math.abs(R)>=1,B=Math.abs(S)>=1,V=Math.abs(O)>=1;this.positions[0]=x,this.positions[1]=E,this.positions[2]=0,this.colors[0]=P,this.colors[1]=M,this.colors[2]=X,this.colors[3]=U*e,G&&(this.uvs[0]=.5,this.uvs[1]=.5);const Q=.25*Math.PI;for(let q=1;q<=g+1;q++){const k=(q-1)/g*2*Math.PI,N=k+m+Q;if(this.positions[3*q+0]=x+_*Math.cos(N)*this.aspecty,this.positions[3*q+1]=E+_*Math.sin(N),this.positions[3*q+2]=0,this.colors[4*q+0]=L,this.colors[4*q+1]=T,this.colors[4*q+2]=b,this.colors[4*q+3]=v*e,G){const z=k+C+Q;this.uvs[2*q+0]=.5+.5*Math.cos(z)/D*this.aspecty,this.uvs[2*q+1]=.5+.5*Math.sin(z)/D}F&&(this.borderPositions[3*(q-1)+0]=this.positions[3*q+0],this.borderPositions[3*(q-1)+1]=this.positions[3*q+1],this.borderPositions[3*(q-1)+2]=this.positions[3*q+2])}this.drawCustomShapeInstance(h,g,G,F,B,V)}}else{this.setupShapeBuffers(s.mdVSFrame.wrap);let A=Object.assign({},s.mdVSShapes[this.index],s.mdVSFrameMapShapes[this.index],i);s.preset.shapes[this.index].frame_eqs_str===""&&(A=Object.assign(A,s.mdVSQAfterFrame,s.mdVSTShapeInits[this.index]));const r=s.preset.shapes[this.index].baseVals,n=Math.clamp(r.num_inst,1,1024);for(let _=0;_<n;_++){let m;A.instance=_,A.x=r.x,A.y=r.y,A.rad=r.rad,A.ang=r.ang,A.r=r.r,A.g=r.g,A.b=r.b,A.a=r.a,A.r2=r.r2,A.g2=r.g2,A.b2=r.b2,A.a2=r.a2,A.border_r=r.border_r,A.border_g=r.border_g,A.border_b=r.border_b,A.border_a=r.border_a,A.thickoutline=r.thickoutline,A.textured=r.textured,A.tex_zoom=r.tex_zoom,A.tex_ang=r.tex_ang,A.additive=r.additive,s.preset.shapes[this.index].frame_eqs_str!==""?(A=Object.assign(A,s.mdVSQAfterFrame,s.mdVSTShapeInits[this.index]),m=s.runShapeFrameEquations(this.index,A)):m=A;let x=m.sides;x=Math.clamp(x,3,100),x=Math.floor(x);const E=m.rad,P=m.ang,M=2*m.x-1,X=-2*m.y+1,U=m.r,L=m.g,T=m.b,b=m.a,v=m.r2,p=m.g2,I=m.b2,y=m.a2,w=m.border_r,S=m.border_g,R=m.border_b,D=m.border_a;this.borderColor=[w,S,R,D*e];const C=m.thickoutline,O=m.textured,F=m.tex_zoom,G=m.tex_ang,B=m.additive,V=this.borderColor[3]>0,Q=Math.abs(O)>=1,q=Math.abs(C)>=1,k=Math.abs(B)>=1;this.positions[0]=M,this.positions[1]=X,this.positions[2]=0,this.colors[0]=U,this.colors[1]=L,this.colors[2]=T,this.colors[3]=b*e,Q&&(this.uvs[0]=.5,this.uvs[1]=.5);const N=.25*Math.PI;for(let z=1;z<=x+1;z++){const J=(z-1)/x*2*Math.PI,et=J+P+N;if(this.positions[3*z+0]=M+E*Math.cos(et)*this.aspecty,this.positions[3*z+1]=X+E*Math.sin(et),this.positions[3*z+2]=0,this.colors[4*z+0]=v,this.colors[4*z+1]=p,this.colors[4*z+2]=I,this.colors[4*z+3]=y*e,Q){const Y=J+G+N;this.uvs[2*z+0]=.5+.5*Math.cos(Y)/F*this.aspecty,this.uvs[2*z+1]=.5+.5*Math.sin(Y)/F}V&&(this.borderPositions[3*(z-1)+0]=this.positions[3*z+0],this.borderPositions[3*(z-1)+1]=this.positions[3*z+1],this.borderPositions[3*(z-1)+2]=this.positions[3*z+2])}this.mdVSShapeFrame=m,this.drawCustomShapeInstance(h,x,Q,V,q,k)}const d=s.mdVSUserKeysShapes[this.index],g=o.default.pick(this.mdVSShapeFrame,d);s.mdVSFrameMapShapes[this.index]=g}}setupShapeBuffers(e){this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.positionVertexBuf),this.gl.bufferData(this.gl.ARRAY_BUFFER,this.positions,this.gl.DYNAMIC_DRAW),this.gl.vertexAttribPointer(this.aPosLocation,3,this.gl.FLOAT,!1,0,0),this.gl.enableVertexAttribArray(this.aPosLocation),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.colorVertexBuf),this.gl.bufferData(this.gl.ARRAY_BUFFER,this.colors,this.gl.DYNAMIC_DRAW),this.gl.vertexAttribPointer(this.aColorLocation,4,this.gl.FLOAT,!1,0,0),this.gl.enableVertexAttribArray(this.aColorLocation),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.uvVertexBuf),this.gl.bufferData(this.gl.ARRAY_BUFFER,this.uvs,this.gl.DYNAMIC_DRAW),this.gl.vertexAttribPointer(this.aUvLocation,2,this.gl.FLOAT,!1,0,0),this.gl.enableVertexAttribArray(this.aUvLocation),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.borderPositionVertexBuf),this.gl.bufferData(this.gl.ARRAY_BUFFER,this.borderPositions,this.gl.DYNAMIC_DRAW),this.gl.vertexAttribPointer(this.aBorderPosLoc,3,this.gl.FLOAT,!1,0,0),this.gl.enableVertexAttribArray(this.aBorderPosLoc);const i=e!==0?this.gl.REPEAT:this.gl.CLAMP_TO_EDGE;this.gl.samplerParameteri(this.mainSampler,this.gl.TEXTURE_WRAP_S,i),this.gl.samplerParameteri(this.mainSampler,this.gl.TEXTURE_WRAP_T,i)}drawCustomShapeInstance(e,i,s,l,h,A){if(this.gl.useProgram(this.shaderProgram),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.positionVertexBuf),this.gl.bufferSubData(this.gl.ARRAY_BUFFER,0,this.positions,0,3*(i+2)),this.gl.vertexAttribPointer(this.aPosLocation,3,this.gl.FLOAT,!1,0,0),this.gl.enableVertexAttribArray(this.aPosLocation),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.colorVertexBuf),this.gl.bufferSubData(this.gl.ARRAY_BUFFER,0,this.colors,0,4*(i+2)),this.gl.vertexAttribPointer(this.aColorLocation,4,this.gl.FLOAT,!1,0,0),this.gl.enableVertexAttribArray(this.aColorLocation),s&&(this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.uvVertexBuf),this.gl.bufferSubData(this.gl.ARRAY_BUFFER,0,this.uvs,0,2*(i+2)),this.gl.vertexAttribPointer(this.aUvLocation,2,this.gl.FLOAT,!1,0,0),this.gl.enableVertexAttribArray(this.aUvLocation)),this.gl.uniform1f(this.texturedLoc,s?1:0),this.gl.activeTexture(this.gl.TEXTURE0),this.gl.bindTexture(this.gl.TEXTURE_2D,e),this.gl.bindSampler(0,this.mainSampler),this.gl.uniform1i(this.textureLoc,0),A?this.gl.blendFunc(this.gl.SRC_ALPHA,this.gl.ONE):this.gl.blendFunc(this.gl.SRC_ALPHA,this.gl.ONE_MINUS_SRC_ALPHA),this.gl.drawArrays(this.gl.TRIANGLE_FAN,0,i+2),l){this.gl.useProgram(this.borderShaderProgram),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.borderPositionVertexBuf),this.gl.bufferSubData(this.gl.ARRAY_BUFFER,0,this.borderPositions,0,3*(i+1)),this.gl.vertexAttribPointer(this.aBorderPosLoc,3,this.gl.FLOAT,!1,0,0),this.gl.enableVertexAttribArray(this.aBorderPosLoc),this.gl.uniform4fv(this.uBorderColorLoc,this.borderColor);const r=h?4:1;for(let n=0;n<r;n++)n===0?this.gl.uniform2fv(this.thickOffsetLoc,[0,0]):n===1?this.gl.uniform2fv(this.thickOffsetLoc,[2/this.texsizeX,0]):n===2?this.gl.uniform2fv(this.thickOffsetLoc,[0,2/this.texsizeY]):n===3&&this.gl.uniform2fv(this.thickOffsetLoc,[2/this.texsizeX,2/this.texsizeY]),this.gl.drawArrays(this.gl.LINE_STRIP,0,i+1)}}}},"./src/rendering/sprites/border.js":function(W,f,u){u.r(f),u.d(f,"default",function(){return a});var o=u("./src/rendering/shaders/shaderUtils.js");class a{constructor(t,e={}){this.gl=t,this.positions=new Float32Array(72),this.aspectx=e.aspectx,this.aspecty=e.aspecty,this.invAspectx=1/this.aspectx,this.invAspecty=1/this.aspecty,this.floatPrecision=o.default.getFragmentFloatPrecision(this.gl),this.createShader(),this.vertexBuf=this.gl.createBuffer()}updateGlobals(t){this.aspectx=t.aspectx,this.aspecty=t.aspecty,this.invAspectx=1/this.aspectx,this.invAspecty=1/this.aspecty}createShader(){this.shaderProgram=this.gl.createProgram();const t=this.gl.createShader(this.gl.VERTEX_SHADER);this.gl.shaderSource(t,`
      #version 300 es
      in vec3 aPos;
      void main(void) {
        gl_Position = vec4(aPos, 1.0);
      }
      `.trim()),this.gl.compileShader(t);const e=this.gl.createShader(this.gl.FRAGMENT_SHADER);this.gl.shaderSource(e,`
      #version 300 es
      precision ${this.floatPrecision} float;
      precision highp int;
      precision mediump sampler2D;
      out vec4 fragColor;
      uniform vec4 u_color;
      void main(void) {
        fragColor = u_color;
      }
      `.trim()),this.gl.compileShader(e),this.gl.attachShader(this.shaderProgram,t),this.gl.attachShader(this.shaderProgram,e),this.gl.linkProgram(this.shaderProgram),this.aPosLoc=this.gl.getAttribLocation(this.shaderProgram,"aPos"),this.colorLoc=this.gl.getUniformLocation(this.shaderProgram,"u_color")}addTriangle(t,e,i,s){this.positions[t+0]=e[0],this.positions[t+1]=e[1],this.positions[t+2]=e[2],this.positions[t+3]=i[0],this.positions[t+4]=i[1],this.positions[t+5]=i[2],this.positions[t+6]=s[0],this.positions[t+7]=s[1],this.positions[t+8]=s[2]}generateBorder(t,e,i){if(e>0&&t[3]>0){const r=i/2,n=e/2+r,d=r*2,g=r*2,_=n*2,m=n*2;let x=[-1+d,-1+m,0],E=[-1+d,1-m,0],P=[-1+_,1-m,0],M=[-1+_,-1+m,0];return this.addTriangle(0,M,E,x),this.addTriangle(9,M,P,E),x=[1-d,-1+m,0],E=[1-d,1-m,0],P=[1-_,1-m,0],M=[1-_,-1+m,0],this.addTriangle(18,x,E,M),this.addTriangle(27,E,P,M),x=[-1+d,-1+g,0],E=[-1+d,m-1,0],P=[1-d,m-1,0],M=[1-d,-1+g,0],this.addTriangle(36,M,E,x),this.addTriangle(45,M,P,E),x=[-1+d,1-g,0],E=[-1+d,1-m,0],P=[1-d,1-m,0],M=[1-d,1-g,0],this.addTriangle(54,x,E,M),this.addTriangle(63,E,P,M),!0}return!1}drawBorder(t,e,i){this.generateBorder(t,e,i)&&(this.gl.useProgram(this.shaderProgram),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.vertexBuf),this.gl.bufferData(this.gl.ARRAY_BUFFER,this.positions,this.gl.STATIC_DRAW),this.gl.vertexAttribPointer(this.aPosLoc,3,this.gl.FLOAT,!1,0,0),this.gl.enableVertexAttribArray(this.aPosLoc),this.gl.uniform4fv(this.colorLoc,t),this.gl.blendFunc(this.gl.SRC_ALPHA,this.gl.ONE_MINUS_SRC_ALPHA),this.gl.drawArrays(this.gl.TRIANGLES,0,this.positions.length/3))}}},"./src/rendering/sprites/darkenCenter.js":function(W,f,u){u.r(f),u.d(f,"default",function(){return a});var o=u("./src/rendering/shaders/shaderUtils.js");class a{constructor(t,e){this.gl=t,this.aspectx=e.aspectx,this.aspecty=e.aspecty,this.invAspectx=1/this.aspectx,this.invAspecty=1/this.aspecty,this.generatePositions(),this.colors=new Float32Array([0,0,0,3/32,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),this.positionVertexBuf=this.gl.createBuffer(),this.colorVertexBuf=this.gl.createBuffer(),this.floatPrecision=o.default.getFragmentFloatPrecision(this.gl),this.createShader()}updateGlobals(t){this.aspectx=t.aspectx,this.aspecty=t.aspecty,this.invAspectx=1/this.aspectx,this.invAspecty=1/this.aspecty,this.generatePositions()}generatePositions(){this.positions=new Float32Array([0,0,0,-.05*this.aspecty,0,0,0,-.05,0,.05*this.aspecty,0,0,0,.05,0,-.05*this.aspecty,0,0])}createShader(){this.shaderProgram=this.gl.createProgram();const t=this.gl.createShader(this.gl.VERTEX_SHADER);this.gl.shaderSource(t,`
      #version 300 es
      in vec3 aPos;
      in vec4 aColor;
      out vec4 vColor;
      void main(void) {
        vColor = aColor;
        gl_Position = vec4(aPos, 1.0);
      }
      `.trim()),this.gl.compileShader(t);const e=this.gl.createShader(this.gl.FRAGMENT_SHADER);this.gl.shaderSource(e,`
      #version 300 es
      precision ${this.floatPrecision} float;
      precision highp int;
      precision mediump sampler2D;
      in vec4 vColor;
      out vec4 fragColor;
      void main(void) {
        fragColor = vColor;
      }
      `.trim()),this.gl.compileShader(e),this.gl.attachShader(this.shaderProgram,t),this.gl.attachShader(this.shaderProgram,e),this.gl.linkProgram(this.shaderProgram),this.aPosLocation=this.gl.getAttribLocation(this.shaderProgram,"aPos"),this.aColorLocation=this.gl.getAttribLocation(this.shaderProgram,"aColor")}drawDarkenCenter(t){t.darken_center!==0&&(this.gl.useProgram(this.shaderProgram),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.positionVertexBuf),this.gl.bufferData(this.gl.ARRAY_BUFFER,this.positions,this.gl.STATIC_DRAW),this.gl.vertexAttribPointer(this.aPosLocation,3,this.gl.FLOAT,!1,0,0),this.gl.enableVertexAttribArray(this.aPosLocation),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.colorVertexBuf),this.gl.bufferData(this.gl.ARRAY_BUFFER,this.colors,this.gl.STATIC_DRAW),this.gl.vertexAttribPointer(this.aColorLocation,4,this.gl.FLOAT,!1,0,0),this.gl.enableVertexAttribArray(this.aColorLocation),this.gl.blendFunc(this.gl.SRC_ALPHA,this.gl.ONE_MINUS_SRC_ALPHA),this.gl.drawArrays(this.gl.TRIANGLE_FAN,0,this.positions.length/3))}}},"./src/rendering/text/titleText.js":function(W,f,u){u.r(f),u.d(f,"default",function(){return a});var o=u("./src/rendering/shaders/shaderUtils.js");class a{constructor(t,e={}){this.gl=t,this.texsizeX=e.texsizeX,this.texsizeY=e.texsizeY,this.aspectx=e.aspectx,this.aspecty=e.aspecty,this.invAspectx=1/this.aspectx,this.invAspecty=1/this.aspecty,this.buildPositions(),this.textTexture=this.gl.createTexture(),this.indexBuf=t.createBuffer(),this.positionVertexBuf=this.gl.createBuffer(),this.vertexBuf=this.gl.createBuffer(),this.canvas=document.createElement("canvas"),this.canvas.width=this.texsizeX,this.canvas.height=this.texsizeY,this.context2D=this.canvas.getContext("2d"),this.floatPrecision=o.default.getFragmentFloatPrecision(this.gl),this.createShader()}generateTitleTexture(t){this.context2D.clearRect(0,0,this.texsizeX,this.texsizeY),this.fontSize=Math.floor(this.texsizeX/256*16),this.fontSize=Math.max(this.fontSize,6),this.context2D.font=`italic ${this.fontSize}px Times New Roman`;let e=t,i=this.context2D.measureText(e).width;if(i>this.texsizeX){const l=this.texsizeX/i*.91;e=`${e.substring(0,Math.floor(e.length*l))}...`,i=this.context2D.measureText(e).width}this.context2D.fillStyle="#FFFFFF",this.context2D.fillText(e,(this.texsizeX-i)/2,this.texsizeY/2);const s=new Uint8Array(this.context2D.getImageData(0,0,this.texsizeX,this.texsizeY).data.buffer);this.gl.pixelStorei(this.gl.UNPACK_FLIP_Y_WEBGL,!0),this.gl.bindTexture(this.gl.TEXTURE_2D,this.textTexture),this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl.RGBA,this.texsizeX,this.texsizeY,0,this.gl.RGBA,this.gl.UNSIGNED_BYTE,s),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MAG_FILTER,this.gl.LINEAR),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MIN_FILTER,this.gl.LINEAR_MIPMAP_LINEAR),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_S,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_T,this.gl.CLAMP_TO_EDGE),this.gl.generateMipmap(this.gl.TEXTURE_2D),this.gl.bindTexture(this.gl.TEXTURE_2D,null)}updateGlobals(t){this.texsizeX=t.texsizeX,this.texsizeY=t.texsizeY,this.aspectx=t.aspectx,this.aspecty=t.aspecty,this.invAspectx=1/this.aspectx,this.invAspecty=1/this.aspecty,this.canvas.width=this.texsizeX,this.canvas.height=this.texsizeY}buildPositions(){const t=.13333333333333333,e=2/7,i=[];for(let l=0;l<8;l++){const h=l*e-1;for(let A=0;A<16;A++){const r=A*t-1;i.push(r,-h,0)}}const s=[];for(let l=0;l<7;l++)for(let h=0;h<15;h++){const A=h+16*l,r=h+16*(l+1),n=h+1+16*(l+1),d=h+1+16*l;s.push(A,r,d),s.push(r,n,d)}this.vertices=new Float32Array(i),this.indices=new Uint16Array(s)}createShader(){this.shaderProgram=this.gl.createProgram();const t=this.gl.createShader(this.gl.VERTEX_SHADER);this.gl.shaderSource(t,`#version 300 es
       const vec2 halfmad = vec2(0.5);
       in vec2 aPos;
       in vec2 aUv;
       out vec2 uv_orig;
       out vec2 uv;
       void main(void) {
         gl_Position = vec4(aPos, 0.0, 1.0);
         uv_orig = aPos * halfmad + halfmad;
         uv = aUv;
       }`),this.gl.compileShader(t);const e=this.gl.createShader(this.gl.FRAGMENT_SHADER);this.gl.shaderSource(e,`#version 300 es
       precision ${this.floatPrecision} float;
       precision highp int;
       precision mediump sampler2D;

       in vec2 uv_orig;
       in vec2 uv;
       out vec4 fragColor;
       uniform sampler2D uTexture;
       uniform float textColor;

       void main(void) {
         fragColor = texture(uTexture, uv) * vec4(textColor);
       }`),this.gl.compileShader(e),this.gl.attachShader(this.shaderProgram,t),this.gl.attachShader(this.shaderProgram,e),this.gl.linkProgram(this.shaderProgram),this.positionLocation=this.gl.getAttribLocation(this.shaderProgram,"aPos"),this.uvLocation=this.gl.getAttribLocation(this.shaderProgram,"aUv"),this.textureLoc=this.gl.getUniformLocation(this.shaderProgram,"uTexture"),this.textColorLoc=this.gl.getUniformLocation(this.shaderProgram,"textColor")}generateUvs(t,e,i){const s=[];for(let A=0;A<8;A++)for(let r=0;r<16;r++){const n=r/15*2-1;let d=2*(.75*(A/7-.5)+.5)-1;t>=1&&(d+=1/this.texsizeY),s.push(n,e?d:-d)}const l=Math.max(0,1-1.5*t)**1.8*1.3;for(let A=0;A<8;A++)for(let r=0;r<16;r++){const n=16*A+r;s[n]+=.07*l*Math.sin(.31*i.time+.39*s[n]-1.94*s[n+1]),s[n]+=.044*l*Math.sin(.81*i.time-1.91*s[n]+.27*s[n+1]),s[n]+=.061*l*Math.sin(1.31*i.time+.61*s[n]+.74*s[n+1]),s[n+1]+=.061*l*Math.sin(.37*i.time+1.83*s[n]+.69*s[n+1]),s[n+1]+=.07*l*Math.sin(.67*i.time+.42*s[n]-1.39*s[n+1]),s[n+1]+=.087*l*Math.sin(1.07*i.time+3.55*s[n]+.89*s[n+1])}const h=1.01/(t**.21+.01);for(let A=0;A<s.length/2;A++)s[2*A]*=h,s[2*A+1]*=h*this.invAspecty,s[2*A]=(s[2*A]+1)/2,s[2*A+1]=(s[2*A+1]+1)/2;return new Float32Array(s)}renderTitle(t,e,i){this.gl.useProgram(this.shaderProgram);const s=this.generateUvs(t,e,i);this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER,this.indexBuf),this.gl.bufferData(this.gl.ELEMENT_ARRAY_BUFFER,this.indices,this.gl.STATIC_DRAW),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.positionVertexBuf),this.gl.bufferData(this.gl.ARRAY_BUFFER,this.vertices,this.gl.STATIC_DRAW),this.gl.vertexAttribPointer(this.positionLocation,3,this.gl.FLOAT,!1,0,0),this.gl.enableVertexAttribArray(this.positionLocation),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.vertexBuf),this.gl.bufferData(this.gl.ARRAY_BUFFER,s,this.gl.STATIC_DRAW),this.gl.vertexAttribPointer(this.uvLocation,2,this.gl.FLOAT,!1,0,0),this.gl.enableVertexAttribArray(this.uvLocation),this.gl.activeTexture(this.gl.TEXTURE0),this.gl.bindTexture(this.gl.TEXTURE_2D,this.textTexture),this.gl.uniform1i(this.textureLoc,0),this.gl.uniform1f(this.textColorLoc,t**.3),this.gl.blendFunc(this.gl.SRC_ALPHA,this.gl.ONE_MINUS_SRC_ALPHA),this.gl.drawElements(this.gl.TRIANGLES,this.indices.length,this.gl.UNSIGNED_SHORT,0)}}},"./src/rendering/waves/basicWaveform.js":function(W,f,u){u.r(f),u.d(f,"default",function(){return c});var o=u("./src/rendering/shaders/shaderUtils.js"),a=u("./src/rendering/waves/waveUtils.js");class c{constructor(e,i={}){this.gl=e,this.positions=new Float32Array(1536),this.positions2=new Float32Array(1536),this.oldPositions=new Float32Array(1536),this.oldPositions2=new Float32Array(1536),this.smoothedPositions=new Float32Array(3069),this.smoothedPositions2=new Float32Array(3069),this.color=[0,0,0,1],this.texsizeX=i.texsizeX,this.texsizeY=i.texsizeY,this.aspectx=i.aspectx,this.aspecty=i.aspecty,this.invAspectx=1/this.aspectx,this.invAspecty=1/this.aspecty,this.floatPrecision=o.default.getFragmentFloatPrecision(this.gl),this.createShader(),this.vertexBuf=this.gl.createBuffer()}updateGlobals(e){this.texsizeX=e.texsizeX,this.texsizeY=e.texsizeY,this.aspectx=e.aspectx,this.aspecty=e.aspecty,this.invAspectx=1/this.aspectx,this.invAspecty=1/this.aspecty}createShader(){this.shaderProgram=this.gl.createProgram();const e=this.gl.createShader(this.gl.VERTEX_SHADER);this.gl.shaderSource(e,`
      #version 300 es
      in vec3 aPos;
      uniform vec2 thickOffset;
      void main(void) {
        gl_Position = vec4(aPos + vec3(thickOffset, 0.0), 1.0);
      }
      `.trim()),this.gl.compileShader(e);const i=this.gl.createShader(this.gl.FRAGMENT_SHADER);this.gl.shaderSource(i,`
      #version 300 es
      precision ${this.floatPrecision} float;
      precision highp int;
      precision mediump sampler2D;
      out vec4 fragColor;
      uniform vec4 u_color;
      void main(void) {
        fragColor = u_color;
      }
      `.trim()),this.gl.compileShader(i),this.gl.attachShader(this.shaderProgram,e),this.gl.attachShader(this.shaderProgram,i),this.gl.linkProgram(this.shaderProgram),this.aPosLoc=this.gl.getAttribLocation(this.shaderProgram,"aPos"),this.colorLoc=this.gl.getUniformLocation(this.shaderProgram,"u_color"),this.thickOffsetLoc=this.gl.getUniformLocation(this.shaderProgram,"thickOffset")}static processWaveform(e,i){const s=[],l=i.wave_scale/128,h=i.wave_smoothing,A=l*(1-h);s.push(e[0]*l);for(let r=1;r<e.length;r++)s.push(e[r]*A+s[r-1]*h);return s}generateWaveform(e,i,s,l,h){let A=h.wave_a;const r=(h.bass+h.mid+h.treb)/3;if(r>-.01&&A>.001&&s.length>0){const n=c.processWaveform(s,h),d=c.processWaveform(l,h),g=Math.floor(h.wave_mode)%8,_=Math.floor(h.old_wave_mode)%8,m=2*h.wave_x-1,x=2*h.wave_y-1;this.numVert=0,this.oldNumVert=0;const E=e&&g!==_?2:1;for(let T=0;T<E;T++){const b=T===0?g:_;let v,p,I,y=h.wave_mystery;if(b!==0&&b!==1&&b!==4||!(y<-1||y>1)||(y=.5*y+.5,y-=Math.floor(y),y=Math.abs(y),y=2*y-1),T===0?(p=this.positions,I=this.positions2):(p=this.oldPositions,I=this.oldPositions2),A=h.wave_a,b===0){if(h.modwavealphabyvolume>0){const R=h.modwavealphaend-h.modwavealphastart;A*=(r-h.modwavealphastart)/R}A=Math.clamp(A,0,1),v=Math.floor(n.length/2)+1;const w=1/(v-1),S=Math.floor((n.length-v)/2);for(let R=0;R<v-1;R++){let D=.5+.4*d[R+S]+y;const C=R*w*2*Math.PI+.2*h.time;if(R<v/10){let O=R/(.1*v);O=.5-.5*Math.cos(O*Math.PI),D=(1-O)*(.5+.4*d[R+v+S]+y)+D*O}p[3*R+0]=D*Math.cos(C)*this.aspecty+m,p[3*R+1]=D*Math.sin(C)*this.aspectx+x,p[3*R+2]=0}p[3*(v-1)+0]=p[0],p[3*(v-1)+1]=p[1],p[3*(v-1)+2]=0}else if(b===1){if(A*=1.25,h.modwavealphabyvolume>0){const w=h.modwavealphaend-h.modwavealphastart;A*=(r-h.modwavealphastart)/w}A=Math.clamp(A,0,1),v=Math.floor(n.length/2);for(let w=0;w<v;w++){const S=.53+.43*d[w]+y,R=.5*n[w+32]*Math.PI+2.3*h.time;p[3*w+0]=S*Math.cos(R)*this.aspecty+m,p[3*w+1]=S*Math.sin(R)*this.aspectx+x,p[3*w+2]=0}}else if(b===2){if(this.texsizeX<1024?A*=.09:this.texsizeX>=1024&&this.texsizeX<2048?A*=.11:A*=.13,h.modwavealphabyvolume>0){const w=h.modwavealphaend-h.modwavealphastart;A*=(r-h.modwavealphastart)/w}A=Math.clamp(A,0,1),v=n.length;for(let w=0;w<n.length;w++)p[3*w+0]=d[w]*this.aspecty+m,p[3*w+1]=n[(w+32)%n.length]*this.aspectx+x,p[3*w+2]=0}else if(b===3){if(this.texsizeX<1024?A*=.15:this.texsizeX>=1024&&this.texsizeX<2048?A*=.22:A*=.33,A*=1.3,A*=h.treb*h.treb,h.modwavealphabyvolume>0){const w=h.modwavealphaend-h.modwavealphastart;A*=(r-h.modwavealphastart)/w}A=Math.clamp(A,0,1),v=n.length;for(let w=0;w<n.length;w++)p[3*w+0]=d[w]*this.aspecty+m,p[3*w+1]=n[(w+32)%n.length]*this.aspectx+x,p[3*w+2]=0}else if(b===4){if(h.modwavealphabyvolume>0){const C=h.modwavealphaend-h.modwavealphastart;A*=(r-h.modwavealphastart)/C}A=Math.clamp(A,0,1),v=n.length,v>this.texsizeX/3&&(v=Math.floor(this.texsizeX/3));const w=1/v,S=Math.floor((n.length-v)/2),R=.45+.5*(.5*y+.5),D=1-R;for(let C=0;C<v;C++){let O=2*C*w+(m-1)+.44*d[(C+25+S)%n.length],F=.47*n[C+S]+x;C>1&&(O=O*D+R*(2*p[3*(C-1)+0]-p[3*(C-2)+0]),F=F*D+R*(2*p[3*(C-1)+1]-p[3*(C-2)+1])),p[3*C+0]=O,p[3*C+1]=F,p[3*C+2]=0}}else if(b===5){if(this.texsizeX<1024?A*=.09:this.texsizeX>=1024&&this.texsizeX<2048?A*=.11:A*=.13,h.modwavealphabyvolume>0){const R=h.modwavealphaend-h.modwavealphastart;A*=(r-h.modwavealphastart)/R}A=Math.clamp(A,0,1);const w=Math.cos(.3*h.time),S=Math.sin(.3*h.time);v=n.length;for(let R=0;R<n.length;R++){const D=(R+32)%n.length,C=d[R]*n[D]+n[R]*d[D],O=d[R]*d[R]-n[D]*n[D];p[3*R+0]=(C*w-O*S)*(this.aspecty+m),p[3*R+1]=(C*S+O*w)*(this.aspectx+x),p[3*R+2]=0}}else if(b===6||b===7){if(h.modwavealphabyvolume>0){const V=h.modwavealphaend-h.modwavealphastart;A*=(r-h.modwavealphastart)/V}A=Math.clamp(A,0,1),v=Math.floor(n.length/2),v>this.texsizeX/3&&(v=Math.floor(this.texsizeX/3));const w=Math.floor((n.length-v)/2),S=.5*Math.PI*y;let R=Math.cos(S),D=Math.sin(S);const C=[m*Math.cos(S+.5*Math.PI)-3*R,m*Math.cos(S+.5*Math.PI)+3*R],O=[m*Math.sin(S+.5*Math.PI)-3*D,m*Math.sin(S+.5*Math.PI)+3*D];for(let V=0;V<2;V++)for(let Q=0;Q<4;Q++){let q,k=!1;switch(Q){case 0:C[V]>1.1&&(q=(1.1-C[1-V])/(C[V]-C[1-V]),k=!0);break;case 1:C[V]<-1.1&&(q=(-1.1-C[1-V])/(C[V]-C[1-V]),k=!0);break;case 2:O[V]>1.1&&(q=(1.1-O[1-V])/(O[V]-O[1-V]),k=!0);break;case 3:O[V]<-1.1&&(q=(-1.1-O[1-V])/(O[V]-O[1-V]),k=!0)}if(k){const N=C[V]-C[1-V],z=O[V]-O[1-V];C[V]=C[1-V]+N*q,O[V]=O[1-V]+z*q}}R=(C[1]-C[0])/v,D=(O[1]-O[0])/v;const F=Math.atan2(D,R),G=Math.cos(F+.5*Math.PI),B=Math.sin(F+.5*Math.PI);if(b===6)for(let V=0;V<v;V++){const Q=n[V+w];p[3*V+0]=C[0]+R*V+.25*G*Q,p[3*V+1]=O[0]+D*V+.25*B*Q,p[3*V+2]=0}else if(b===7){const V=(.5*x+.5)**2;for(let Q=0;Q<v;Q++){const q=n[Q+w];p[3*Q+0]=C[0]+R*Q+G*(.25*q+V),p[3*Q+1]=O[0]+D*Q+B*(.25*q+V),p[3*Q+2]=0}for(let Q=0;Q<v;Q++){const q=d[Q+w];I[3*Q+0]=C[0]+R*Q+G*(.25*q-V),I[3*Q+1]=O[0]+D*Q+B*(.25*q-V),I[3*Q+2]=0}}}T===0?(this.positions=p,this.positions2=I,this.numVert=v,this.alpha=A):(this.oldPositions=p,this.oldPositions2=I,this.oldNumVert=v,this.oldAlpha=A)}const P=.5-.5*Math.cos(i*Math.PI),M=1-P;this.oldNumVert>0&&(A=P*this.alpha+M*this.oldAlpha);let X=Math.clamp(h.wave_r,0,1),U=Math.clamp(h.wave_g,0,1),L=Math.clamp(h.wave_b,0,1);if(h.wave_brighten!==0){const T=Math.max(X,U,L);T>.01&&(X/=T,U/=T,L/=T)}if(this.color=[X,U,L,A],this.oldNumVert>0)if(g===7){const T=(this.oldNumVert-1)/(2*this.numVert);for(let b=0;b<this.numVert;b++){const v=b*T,p=Math.floor(v),I=v-p,y=this.oldPositions[3*p+0]*(1-I)+this.oldPositions[3*(p+1)+0]*I,w=this.oldPositions[3*p+1]*(1-I)+this.oldPositions[3*(p+1)+1]*I;this.positions[3*b+0]=this.positions[3*b+0]*P+y*M,this.positions[3*b+1]=this.positions[3*b+1]*P+w*M,this.positions[3*b+2]=0}for(let b=0;b<this.numVert;b++){const v=(b+this.numVert)*T,p=Math.floor(v),I=v-p,y=this.oldPositions[3*p+0]*(1-I)+this.oldPositions[3*(p+1)+0]*I,w=this.oldPositions[3*p+1]*(1-I)+this.oldPositions[3*(p+1)+1]*I;this.positions2[3*b+0]=this.positions2[3*b+0]*P+y*M,this.positions2[3*b+1]=this.positions2[3*b+1]*P+w*M,this.positions2[3*b+2]=0}}else if(_===7){const T=this.numVert/2,b=(this.oldNumVert-1)/T;for(let v=0;v<T;v++){const p=v*b,I=Math.floor(p),y=p-I,w=this.oldPositions[3*I+0]*(1-y)+this.oldPositions[3*(I+1)+0]*y,S=this.oldPositions[3*I+1]*(1-y)+this.oldPositions[3*(I+1)+1]*y;this.positions[3*v+0]=this.positions[3*v+0]*P+w*M,this.positions[3*v+1]=this.positions[3*v+1]*P+S*M,this.positions[3*v+2]=0}for(let v=0;v<T;v++){const p=v*b,I=Math.floor(p),y=p-I,w=this.oldPositions2[3*I+0]*(1-y)+this.oldPositions2[3*(I+1)+0]*y,S=this.oldPositions2[3*I+1]*(1-y)+this.oldPositions2[3*(I+1)+1]*y;this.positions2[3*v+0]=this.positions[3*(v+T)+0]*P+w*M,this.positions2[3*v+1]=this.positions[3*(v+T)+1]*P+S*M,this.positions2[3*v+2]=0}}else{const T=(this.oldNumVert-1)/this.numVert;for(let b=0;b<this.numVert;b++){const v=b*T,p=Math.floor(v),I=v-p,y=this.oldPositions[3*p+0]*(1-I)+this.oldPositions[3*(p+1)+0]*I,w=this.oldPositions[3*p+1]*(1-I)+this.oldPositions[3*(p+1)+1]*I;this.positions[3*b+0]=this.positions[3*b+0]*P+y*M,this.positions[3*b+1]=this.positions[3*b+1]*P+w*M,this.positions[3*b+2]=0}}for(let T=0;T<this.numVert;T++)this.positions[3*T+1]=-this.positions[3*T+1];if(this.smoothedNumVert=2*this.numVert-1,a.default.smoothWave(this.positions,this.smoothedPositions,this.numVert),g===7||_===7){for(let T=0;T<this.numVert;T++)this.positions2[3*T+1]=-this.positions2[3*T+1];a.default.smoothWave(this.positions2,this.smoothedPositions2,this.numVert)}return!0}return!1}drawBasicWaveform(e,i,s,l,h){if(this.generateWaveform(e,i,s,l,h)){this.gl.useProgram(this.shaderProgram),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.vertexBuf),this.gl.bufferData(this.gl.ARRAY_BUFFER,this.smoothedPositions,this.gl.STATIC_DRAW),this.gl.vertexAttribPointer(this.aPosLoc,3,this.gl.FLOAT,!1,0,0),this.gl.enableVertexAttribArray(this.aPosLoc),this.gl.uniform4fv(this.colorLoc,this.color);let A=1;h.wave_thick===0&&h.wave_dots===0||(A=4),h.additivewave!==0?this.gl.blendFunc(this.gl.SRC_ALPHA,this.gl.ONE):this.gl.blendFunc(this.gl.SRC_ALPHA,this.gl.ONE_MINUS_SRC_ALPHA);const r=h.wave_dots!==0?this.gl.POINTS:this.gl.LINE_STRIP;for(let n=0;n<A;n++)n===0?this.gl.uniform2fv(this.thickOffsetLoc,[0,0]):n===1?this.gl.uniform2fv(this.thickOffsetLoc,[2/this.texsizeX,0]):n===2?this.gl.uniform2fv(this.thickOffsetLoc,[0,2/this.texsizeY]):n===3&&this.gl.uniform2fv(this.thickOffsetLoc,[2/this.texsizeX,2/this.texsizeY]),this.gl.drawArrays(r,0,this.smoothedNumVert);if(Math.floor(h.wave_mode)%8==7){this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.vertexBuf),this.gl.bufferData(this.gl.ARRAY_BUFFER,this.smoothedPositions2,this.gl.STATIC_DRAW),this.gl.vertexAttribPointer(this.aPosLoc,3,this.gl.FLOAT,!1,0,0),this.gl.enableVertexAttribArray(this.aPosLoc);for(let n=0;n<A;n++)n===0?this.gl.uniform2fv(this.thickOffsetLoc,[0,0]):n===1?this.gl.uniform2fv(this.thickOffsetLoc,[2/this.texsizeX,0]):n===2?this.gl.uniform2fv(this.thickOffsetLoc,[0,2/this.texsizeY]):n===3&&this.gl.uniform2fv(this.thickOffsetLoc,[2/this.texsizeX,2/this.texsizeY]),this.gl.drawArrays(r,0,this.smoothedNumVert)}}}}},"./src/rendering/waves/customWaveform.js":function(W,f,u){u.r(f),u.d(f,"default",function(){return t});var o=u("./src/utils.js"),a=u("./src/rendering/shaders/shaderUtils.js"),c=u("./src/rendering/waves/waveUtils.js");class t{constructor(i,s,l){this.index=i,this.gl=s;const h=512;this.pointsData=[new Float32Array(h),new Float32Array(h)],this.positions=new Float32Array(1536),this.colors=new Float32Array(2048),this.smoothedPositions=new Float32Array(3069),this.smoothedColors=new Float32Array(4092),this.texsizeX=l.texsizeX,this.texsizeY=l.texsizeY,this.mesh_width=l.mesh_width,this.mesh_height=l.mesh_height,this.aspectx=l.aspectx,this.aspecty=l.aspecty,this.invAspectx=1/this.aspectx,this.invAspecty=1/this.aspecty,this.positionVertexBuf=this.gl.createBuffer(),this.colorVertexBuf=this.gl.createBuffer(),this.floatPrecision=a.default.getFragmentFloatPrecision(this.gl),this.createShader()}updateGlobals(i){this.texsizeX=i.texsizeX,this.texsizeY=i.texsizeY,this.mesh_width=i.mesh_width,this.mesh_height=i.mesh_height,this.aspectx=i.aspectx,this.aspecty=i.aspecty,this.invAspectx=1/this.aspectx,this.invAspecty=1/this.aspecty}createShader(){this.shaderProgram=this.gl.createProgram();const i=this.gl.createShader(this.gl.VERTEX_SHADER);this.gl.shaderSource(i,`
      #version 300 es
      uniform float uSize;
      uniform vec2 thickOffset;
      in vec3 aPos;
      in vec4 aColor;
      out vec4 vColor;
      void main(void) {
        vColor = aColor;
        gl_PointSize = uSize;
        gl_Position = vec4(aPos + vec3(thickOffset, 0.0), 1.0);
      }
      `.trim()),this.gl.compileShader(i);const s=this.gl.createShader(this.gl.FRAGMENT_SHADER);this.gl.shaderSource(s,`
      #version 300 es
      precision ${this.floatPrecision} float;
      precision highp int;
      precision mediump sampler2D;
      in vec4 vColor;
      out vec4 fragColor;
      void main(void) {
        fragColor = vColor;
      }
      `.trim()),this.gl.compileShader(s),this.gl.attachShader(this.shaderProgram,i),this.gl.attachShader(this.shaderProgram,s),this.gl.linkProgram(this.shaderProgram),this.aPosLocation=this.gl.getAttribLocation(this.shaderProgram,"aPos"),this.aColorLocation=this.gl.getAttribLocation(this.shaderProgram,"aColor"),this.sizeLoc=this.gl.getUniformLocation(this.shaderProgram,"uSize"),this.thickOffsetLoc=this.gl.getUniformLocation(this.shaderProgram,"thickOffset")}generateWaveform(i,s,l,h,A,r,n,d){if(n.baseVals.enabled!==0&&i.length>0){let g;if(r.preset.useWASM)g=r.runWaveFrameEquations(this.index,A);else{const p=Object.assign({},r.mdVSWaves[this.index],r.mdVSFrameMapWaves[this.index],r.mdVSQAfterFrame,r.mdVSTWaveInits[this.index],A);g=r.runWaveFrameEquations(this.index,p)}const _=512;Object.prototype.hasOwnProperty.call(g,"samples")?this.samples=g.samples:this.samples=_,this.samples>_&&(this.samples=_),this.samples=Math.floor(this.samples);const m=r.preset.waves[this.index].baseVals,x=Math.floor(g.sep),E=g.scaling,P=g.spectrum,M=g.smoothing,X=m.usedots,U=g.r,L=g.g,T=g.b,b=g.a,v=r.preset.baseVals.wave_scale;if(this.samples-=x,this.samples>=2||X!==0&&this.samples>=1){const p=P!==0,I=(p?.15:.004)*E*v,y=p?l:i,w=p?h:s,S=p?0:Math.floor((_-this.samples)/2-x/2),R=p?0:Math.floor((_-this.samples)/2+x/2),D=p?(_-x)/this.samples:1,C=(.98*M)**.5,O=1-C;this.pointsData[0][0]=y[S],this.pointsData[1][0]=w[R];for(let F=1;F<this.samples;F++){const G=y[Math.floor(F*D+S)],B=w[Math.floor(F*D+R)];this.pointsData[0][F]=G*O+this.pointsData[0][F-1]*C,this.pointsData[1][F]=B*O+this.pointsData[1][F-1]*C}for(let F=this.samples-2;F>=0;F--)this.pointsData[0][F]=this.pointsData[0][F]*O+this.pointsData[0][F+1]*C,this.pointsData[1][F]=this.pointsData[1][F]*O+this.pointsData[1][F+1]*C;for(let F=0;F<this.samples;F++)this.pointsData[0][F]*=I,this.pointsData[1][F]*=I;if(r.preset.useWASM){const F=r.preset.globalPools[`wavePerFrame${this.index}`];for(let G=0;G<this.samples;G++){const B=this.pointsData[0][G],V=this.pointsData[1][G];F.sample.value=G/(this.samples-1),F.value1.value=B,F.value2.value=V,F.x.value=.5+B,F.y.value=.5+V,F.r.value=U,F.g.value=L,F.b.value=T,F.a.value=b,n.point_eqs&&r.preset.waves[this.index].point_eqs();const Q=(2*F.x.value-1)*this.invAspectx,q=(-2*F.y.value+1)*this.invAspecty,k=F.r.value,N=F.g.value,z=F.b.value,J=F.a.value;this.positions[3*G+0]=Q,this.positions[3*G+1]=q,this.positions[3*G+2]=0,this.colors[4*G+0]=k,this.colors[4*G+1]=N,this.colors[4*G+2]=z,this.colors[4*G+3]=J*d}}else for(let F=0;F<this.samples;F++){const G=this.pointsData[0][F],B=this.pointsData[1][F];g.sample=F/(this.samples-1),g.value1=G,g.value2=B,g.x=.5+G,g.y=.5+B,g.r=U,g.g=L,g.b=T,g.a=b,n.point_eqs!==""&&(g=r.runWavePointEquations(this.index,g));const V=(2*g.x-1)*this.invAspectx,Q=(-2*g.y+1)*this.invAspecty,q=g.r,k=g.g,N=g.b,z=g.a;this.positions[3*F+0]=V,this.positions[3*F+1]=Q,this.positions[3*F+2]=0,this.colors[4*F+0]=q,this.colors[4*F+1]=k,this.colors[4*F+2]=N,this.colors[4*F+3]=z*d}if(r.preset.useWASM)g.usedots=X,g.thick=m.thick,g.additive=m.additive;else{const F=r.mdVSUserKeysWaves[this.index],G=o.default.pick(g,F);r.mdVSFrameMapWaves[this.index]=G}return this.mdVSWaveFrame=g,X===0&&c.default.smoothWaveAndColor(this.positions,this.colors,this.smoothedPositions,this.smoothedColors,this.samples),!0}}return!1}drawCustomWaveform(i,s,l,h,A,r,n,d){if(d&&this.generateWaveform(s,l,h,A,r,n,d,i)){this.gl.useProgram(this.shaderProgram);const g=this.mdVSWaveFrame.usedots!==0,_=this.mdVSWaveFrame.thick!==0,m=this.mdVSWaveFrame.additive!==0;let x,E,P;g?(x=this.positions,E=this.colors,P=this.samples):(x=this.smoothedPositions,E=this.smoothedColors,P=2*this.samples-1),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.positionVertexBuf),this.gl.bufferData(this.gl.ARRAY_BUFFER,x,this.gl.STATIC_DRAW),this.gl.vertexAttribPointer(this.aPosLocation,3,this.gl.FLOAT,!1,0,0),this.gl.enableVertexAttribArray(this.aPosLocation),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.colorVertexBuf),this.gl.bufferData(this.gl.ARRAY_BUFFER,E,this.gl.STATIC_DRAW),this.gl.vertexAttribPointer(this.aColorLocation,4,this.gl.FLOAT,!1,0,0),this.gl.enableVertexAttribArray(this.aColorLocation);let M=1;g?_?this.gl.uniform1f(this.sizeLoc,2+(this.texsizeX>=1024?1:0)):this.gl.uniform1f(this.sizeLoc,1+(this.texsizeX>=1024?1:0)):(this.gl.uniform1f(this.sizeLoc,1),_&&(M=4)),m?this.gl.blendFunc(this.gl.SRC_ALPHA,this.gl.ONE):this.gl.blendFunc(this.gl.SRC_ALPHA,this.gl.ONE_MINUS_SRC_ALPHA);const X=g?this.gl.POINTS:this.gl.LINE_STRIP;for(let U=0;U<M;U++)U===0?this.gl.uniform2fv(this.thickOffsetLoc,[0,0]):U===1?this.gl.uniform2fv(this.thickOffsetLoc,[2/this.texsizeX,0]):U===2?this.gl.uniform2fv(this.thickOffsetLoc,[0,2/this.texsizeY]):U===3&&this.gl.uniform2fv(this.thickOffsetLoc,[2/this.texsizeX,2/this.texsizeY]),this.gl.drawArrays(X,0,P)}}}},"./src/rendering/waves/waveUtils.js":function(W,f,u){u.r(f),u.d(f,"default",function(){return o});class o{static smoothWave(c,t,e,i=!1){let r,n=0,d=0,g=1;for(let _=0;_<e-1;_++){r=g,g=Math.min(e-1,_+2);for(let m=0;m<3;m++)t[3*n+m]=c[3*_+m];if(i)for(let m=0;m<3;m++)t[3*(n+1)+m]=.5*(-.15*c[3*d+m]+1.15*c[3*_+m]+1.15*c[3*r+m]+-.15*c[3*g+m]);else{for(let m=0;m<2;m++)t[3*(n+1)+m]=.5*(-.15*c[3*d+m]+1.15*c[3*_+m]+1.15*c[3*r+m]+-.15*c[3*g+m]);t[3*(n+1)+2]=0}d=_,n+=2}for(let _=0;_<3;_++)t[3*n+_]=c[3*(e-1)+_]}static smoothWaveAndColor(c,t,e,i,s,l=!1){let d,g=0,_=0,m=1;for(let x=0;x<s-1;x++){d=m,m=Math.min(s-1,x+2);for(let E=0;E<3;E++)e[3*g+E]=c[3*x+E];if(l)for(let E=0;E<3;E++)e[3*(g+1)+E]=.5*(-.15*c[3*_+E]+1.15*c[3*x+E]+1.15*c[3*d+E]+-.15*c[3*m+E]);else{for(let E=0;E<2;E++)e[3*(g+1)+E]=.5*(-.15*c[3*_+E]+1.15*c[3*x+E]+1.15*c[3*d+E]+-.15*c[3*m+E]);e[3*(g+1)+2]=0}for(let E=0;E<4;E++)i[4*g+E]=t[4*x+E],i[4*(g+1)+E]=t[4*x+E];_=x,g+=2}for(let x=0;x<3;x++)e[3*g+x]=c[3*(s-1)+x];for(let x=0;x<4;x++)i[4*g+x]=t[4*(s-1)+x]}}},"./src/utils.js":function(W,f,u){u.r(f),u.d(f,"default",function(){return o});class o{static atan2(c,t){let e=Math.atan2(c,t);return e<0&&(e+=2*Math.PI),e}static cloneVars(c){return Object.assign({},c)}static range(c,t){return t===void 0?[...Array(c).keys()]:Array.from({length:t-c},(e,i)=>i+c)}static pick(c,t){const e={};for(let i=0;i<t.length;i++){const s=t[i];e[s]=c[s]||0}return e}static omit(c,t){const e=Object.assign({},c);for(let i=0;i<t.length;i++)delete e[t[i]];return e}static setWasm(c,t,e){for(let i=0;i<e.length;i++){const s=e[i];c[s].value=t[s]}}static pickWasm(c,t){const e={};for(let i=0;i<t.length;i++){const s=t[i];e[s]=c[s].value}return e}}},"./src/visualizer.js":function(W,f,u){u.r(f),u.d(f,"default",function(){return n});var o=u("./node_modules/@babel/runtime/helpers/defineProperty.js"),a=u.n(o),c=u("./node_modules/eel-wasm/dist/src/index.js"),t=u("./node_modules/@assemblyscript/loader/index.js"),e=u("./src/audio/audioProcessor.js"),i=u("./src/rendering/renderer.js"),s=u("./src/utils.js"),l=u("./src/assemblyscript/presetFunctions.ts"),h=u.n(l);function A(d,g){var _=Object.keys(d);if(Object.getOwnPropertySymbols){var m=Object.getOwnPropertySymbols(d);g&&(m=m.filter(function(x){return Object.getOwnPropertyDescriptor(d,x).enumerable})),_.push.apply(_,m)}return _}function r(d){for(var g=1;g<arguments.length;g++){var _=arguments[g]!=null?arguments[g]:{};g%2?A(Object(_),!0).forEach(function(m){a()(d,m,_[m])}):Object.getOwnPropertyDescriptors?Object.defineProperties(d,Object.getOwnPropertyDescriptors(_)):A(Object(_)).forEach(function(m){Object.defineProperty(d,m,Object.getOwnPropertyDescriptor(_,m))})}return d}class n{constructor(g,_,m){this.opts=m,this.audio=new e.default(g);const x=m.width||1200,E=m.height||900;this.internalCanvas=document.createElement("canvas"),this.internalCanvas.width=x,this.internalCanvas.height=E,this.gl=this.internalCanvas.getContext("webgl2",{alpha:!1,antialias:!1,depth:!1,stencil:!1,premultipliedAlpha:!1}),this.outputGl=_.getContext("2d"),this.baseValsDefaults={decay:.98,gammaadj:2,echo_zoom:2,echo_alpha:0,echo_orient:0,red_blue:0,brighten:0,darken:0,wrap:1,darken_center:0,solarize:0,invert:0,bmotionvectorson:1,fshader:0,b1n:0,b2n:0,b3n:0,b1x:1,b2x:1,b3x:1,b1ed:.25,wave_mode:0,additivewave:0,wave_dots:0,wave_thick:0,wave_a:.8,wave_scale:1,wave_smoothing:.75,wave_mystery:0,modwavealphabyvolume:0,modwavealphastart:.75,modwavealphaend:.95,wave_r:1,wave_g:1,wave_b:1,wave_x:.5,wave_y:.5,wave_brighten:1,mv_x:12,mv_y:9,mv_dx:0,mv_dy:0,mv_l:.9,mv_r:1,mv_g:1,mv_b:1,mv_a:1,warpanimspeed:1,warpscale:1,zoomexp:1,zoom:1,rot:0,cx:.5,cy:.5,dx:0,dy:0,warp:1,sx:1,sy:1,ob_size:.01,ob_r:0,ob_g:0,ob_b:0,ob_a:0,ib_size:.01,ib_r:.25,ib_g:.25,ib_b:.25,ib_a:0},this.shapeBaseValsDefaults={enabled:0,sides:4,additive:0,thickoutline:0,textured:0,num_inst:1,tex_zoom:1,tex_ang:0,x:.5,y:.5,rad:.1,ang:0,r:1,g:0,b:0,a:1,r2:0,g2:1,b2:0,a2:0,border_r:1,border_g:1,border_b:1,border_a:.1},this.waveBaseValsDefaults={enabled:0,samples:512,sep:0,scaling:1,smoothing:.5,r:1,g:1,b:1,a:1,spectrum:0,usedots:0,thick:0,additive:0},this.qs=s.default.range(1,33).map(P=>`q${P}`),this.ts=s.default.range(1,9).map(P=>`t${P}`),this.globalPerFrameVars=["old_wave_mode","frame","time","fps","bass","bass_att","mid","mid_att","treb","treb_att","meshx","meshy","aspectx","aspecty","pixelsx","pixelsy","rand_start","rand_preset"],this.globalPerPixelVars=["frame","time","fps","bass","bass_att","mid","mid_att","treb","treb_att","meshx","meshy","aspectx","aspecty","pixelsx","pixelsy","rand_start","rand_preset","x","y","rad","ang"],this.globalShapeVars=["frame","time","fps","bass","bass_att","mid","mid_att","treb","treb_att","meshx","meshy","aspectx","aspecty","pixelsx","pixelsy","rand_start","rand_preset","instance"],this.shapeBaseVars=["x","y","rad","ang","r","g","b","a","r2","g2","b2","a2","border_r","border_g","border_b","border_a","thickoutline","textured","tex_zoom","tex_ang","additive"],this.globalWaveVars=["frame","time","fps","bass","bass_att","mid","mid_att","treb","treb_att","meshx","meshy","aspectx","aspecty","pixelsx","pixelsy","rand_start","rand_preset","x","y","sample","value1","value2"],this.renderer=new i.default(this.gl,this.audio,m)}loseGLContext(){this.gl.getExtension("WEBGL_lose_context").loseContext(),this.outputGl=null}connectAudio(g){this.audioNode=g,this.audio.connectAudio(g)}disconnectAudio(g){this.audio.disconnectAudio(g)}static overrideDefaultVars(g,_){const m={};return Object.keys(g).forEach(x=>{Object.prototype.hasOwnProperty.call(_,x)?m[x]=_[x]:m[x]=g[x]}),m}createQVars(){const g={};return this.qs.forEach(_=>{g[_]=new WebAssembly.Global({value:"f64",mutable:!0},0)}),g}createTVars(){const g={};return this.ts.forEach(_=>{g[_]=new WebAssembly.Global({value:"f64",mutable:!0},0)}),g}createPerFramePool(g){const _={};return Object.keys(this.baseValsDefaults).forEach(m=>{_[m]=new WebAssembly.Global({value:"f64",mutable:!0},g[m])}),this.globalPerFrameVars.forEach(m=>{_[m]=new WebAssembly.Global({value:"f64",mutable:!0},0)}),_}createPerPixelPool(g){const _={};return Object.keys(this.baseValsDefaults).forEach(m=>{_[m]=new WebAssembly.Global({value:"f64",mutable:!0},g[m])}),this.globalPerPixelVars.forEach(m=>{_[m]=new WebAssembly.Global({value:"f64",mutable:!0},0)}),_}createCustomShapePerFramePool(g){const _={};return Object.keys(this.shapeBaseValsDefaults).forEach(m=>{_[m]=new WebAssembly.Global({value:"f64",mutable:!0},g[m])}),this.globalShapeVars.forEach(m=>{_[m]=new WebAssembly.Global({value:"f64",mutable:!0},0)}),_}createCustomWavePerFramePool(g){const _={};return Object.keys(this.waveBaseValsDefaults).forEach(m=>{_[m]=new WebAssembly.Global({value:"f64",mutable:!0},g[m])}),this.globalWaveVars.forEach(m=>{_[m]=new WebAssembly.Global({value:"f64",mutable:!0},0)}),_}static makeShapeResetPool(g,_,m){return _.reduce((x,E)=>r(r({},x),{},{[`${E}_${m}`]:g[E]}),{})}static base64ToArrayBuffer(g){for(var _=window.atob(g),m=_.length,x=new Uint8Array(m),E=0;E<m;E++)x[E]=_.charCodeAt(E);return x.buffer}async loadPreset(g,_=0){const m=JSON.parse(JSON.stringify(g));m.baseVals=n.overrideDefaultVars(this.baseValsDefaults,m.baseVals);for(let E=0;E<m.shapes.length;E++)m.shapes[E].baseVals=n.overrideDefaultVars(this.shapeBaseValsDefaults,m.shapes[E].baseVals);for(let E=0;E<m.waves.length;E++)m.waves[E].baseVals=n.overrideDefaultVars(this.waveBaseValsDefaults,m.waves[E].baseVals);const x=m.useJS&&!this.opts.onlyUseWASM;Object.prototype.hasOwnProperty.call(m,"init_eqs_eel")&&!x?(m.useWASM=!0,await this.loadWASMPreset(m,_)):this.opts.onlyUseWASM?console.warn("Tried to load a preset that doesn't support WASM with onlyUseWASM on"):Object.prototype.hasOwnProperty.call(m,"init_eqs_str")?this.loadJSPreset(m,_):console.warn("Tried to load a JS preset that doesn't have converted strings")}async loadWASMPreset(g,_){const m=this.createQVars(),x=this.createTVars(),E={perFrame:r(r({},m),this.createPerFramePool(g.baseVals)),perVertex:r(r({},m),this.createPerPixelPool(g.baseVals))},P={presetInit:{pool:"perFrame",code:g.init_eqs_eel},perFrame:{pool:"perFrame",code:g.frame_eqs_eel}};g.pixel_eqs_eel!==""&&(P.perPixel={pool:"perVertex",code:g.pixel_eqs_eel});for(let L=0;L<g.shapes.length;L++)E[`shapePerFrame${L}`]=r(r(r({},m),x),this.createCustomShapePerFramePool(g.shapes[L].baseVals)),g.shapes[L].baseVals.enabled!==0&&(P[`shapes_${L}_init_eqs`]={pool:`shapePerFrame${L}`,code:g.shapes[L].init_eqs_eel},P[`shapes_${L}_frame_eqs`]={pool:`shapePerFrame${L}`,code:g.shapes[L].frame_eqs_eel});for(let L=0;L<g.waves.length;L++)g.waves[L].baseVals.enabled!==0&&(E[`wavePerFrame${L}`]=r(r(r({},m),x),this.createCustomWavePerFramePool(g.waves[L].baseVals)),P[`waves_${L}_init_eqs`]={pool:`wavePerFrame${L}`,code:g.waves[L].init_eqs_eel},P[`waves_${L}_frame_eqs`]={pool:`wavePerFrame${L}`,code:g.waves[L].frame_eqs_eel},g.waves[L].point_eqs_eel&&g.waves[L].point_eqs_eel!==""&&(P[`waves_${L}_point_eqs`]={pool:`wavePerFrame${L}`,code:g.waves[L].point_eqs_eel}));const M=await Object(c.loadModule)({pools:E,functions:P,eelVersion:g.version||2}),X=L=>L||(()=>{}),U=await t.default.instantiate(n.base64ToArrayBuffer(h()()),{pixelEqs:{perPixelEqs:X(M.exports.perPixel)},pixelVarPool:{warp:E.perVertex.warp,zoom:E.perVertex.zoom,zoomexp:E.perVertex.zoomexp,cx:E.perVertex.cx,cy:E.perVertex.cy,sx:E.perVertex.sx,sy:E.perVertex.sy,dx:E.perVertex.dx,dy:E.perVertex.dy,rot:E.perVertex.rot,x:E.perVertex.x,y:E.perVertex.y,ang:E.perVertex.ang,rad:E.perVertex.rad},qVarPool:m,tVarPool:x,shapePool0:n.makeShapeResetPool(E.shapePerFrame0,this.shapeBaseVars,0),shapePool1:n.makeShapeResetPool(E.shapePerFrame1,this.shapeBaseVars,1),shapePool2:n.makeShapeResetPool(E.shapePerFrame2,this.shapeBaseVars,2),shapePool3:n.makeShapeResetPool(E.shapePerFrame3,this.shapeBaseVars,3),console:{logi:L=>{console.log("logi: "+L)},logf:L=>{console.log("logf: "+L)}},env:{abort:()=>{}}});g.globalPools=E,g.init_eqs=X(M.exports.presetInit),g.frame_eqs=X(M.exports.perFrame),g.save_qs=U.exports.saveQs,g.restore_qs=U.exports.restoreQs,g.save_ts=U.exports.saveTs,g.restore_ts=U.exports.restoreTs,M.exports.perPixel&&(g.pixel_eqs=M.exports.perPixel),g.pixel_eqs_initialize_array=(L,T)=>{const b=U.exports.createFloat32Array((L+1)*(T+1)*2);g.pixel_eqs_array=b},g.pixel_eqs_get_array=()=>U.exports.__getFloat32ArrayView(g.pixel_eqs_array),g.pixel_eqs_wasm=(...L)=>U.exports.runPixelEquations(g.pixel_eqs_array,...L);for(let L=0;L<g.shapes.length;L++)g.shapes[L].baseVals.enabled!==0&&(g.shapes[L].init_eqs=X(M.exports[`shapes_${L}_init_eqs`]),g.shapes[L].frame_eqs=M.exports[`shapes_${L}_frame_eqs`],g.shapes[L].frame_eqs_save=()=>U.exports[`shape${L}_save`](),g.shapes[L].frame_eqs_restore=()=>U.exports[`shape${L}_restore`]());for(let L=0;L<g.waves.length;L++)if(g.waves[L].baseVals.enabled!==0){const T={init_eqs:X(M.exports[`waves_${L}_init_eqs`]),frame_eqs:X(M.exports[`waves_${L}_frame_eqs`])};g.waves[L].point_eqs_eel&&g.waves[L].point_eqs_eel!==""?T.point_eqs=M.exports[`waves_${L}_point_eqs`]:T.point_eqs="",g.waves[L]=Object.assign({},g.waves[L],T)}this.renderer.loadPreset(g,_)}loadJSPreset(g,_){if(typeof g.init_eqs!="function"){g.init_eqs=new Function("a",`${g.init_eqs_str} return a;`),g.frame_eqs=new Function("a",`${g.frame_eqs_str} return a;`),g.pixel_eqs_str&&g.pixel_eqs_str!==""?g.pixel_eqs=new Function("a",`${g.pixel_eqs_str} return a;`):g.pixel_eqs="";for(let m=0;m<g.shapes.length;m++)g.shapes[m].baseVals.enabled!==0&&(g.shapes[m]=Object.assign({},g.shapes[m],{init_eqs:new Function("a",`${g.shapes[m].init_eqs_str} return a;`),frame_eqs:new Function("a",`${g.shapes[m].frame_eqs_str} return a;`)}));for(let m=0;m<g.waves.length;m++)if(g.waves[m].baseVals.enabled!==0){const x={init_eqs:new Function("a",`${g.waves[m].init_eqs_str} return a;`),frame_eqs:new Function("a",`${g.waves[m].frame_eqs_str} return a;`)};g.waves[m].point_eqs_str&&g.waves[m].point_eqs_str!==""?x.point_eqs=new Function("a",`${g.waves[m].point_eqs_str} return a;`):x.point_eqs="",g.waves[m]=Object.assign({},g.waves[m],x)}}this.renderer.loadPreset(g,_)}loadExtraImages(g){this.renderer.loadExtraImages(g)}setRendererSize(g,_,m={}){this.internalCanvas.width=g,this.internalCanvas.height=_,this.renderer.setRendererSize(g,_,m)}setInternalMeshSize(g,_){this.renderer.setInternalMeshSize(g,_)}setOutputAA(g){this.renderer.setOutputAA(g)}setCanvas(g){this.outputGl=g.getContext("2d")}render(g){const _=this.renderer.render(g);return this.outputGl&&this.outputGl.drawImage(this.internalCanvas,0,0),_}launchSongTitleAnim(g){this.renderer.launchSongTitleAnim(g)}toDataURL(){return this.renderer.toDataURL()}warpBufferToDataURL(){return this.renderer.warpBufferToDataURL()}}}})}();const xt=_t({__proto__:null,default:pt(ft)},[ft]);export{xt as b};
